(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Jo(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Ie={},Vn=[],Dt=()=>{},ff=()=>!1,ui=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Xo=t=>t.startsWith("onUpdate:"),tt=Object.assign,Zo=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},pf=Object.prototype.hasOwnProperty,Ce=(t,e)=>pf.call(t,e),re=Array.isArray,Gn=t=>di(t)==="[object Map]",ru=t=>di(t)==="[object Set]",oe=t=>typeof t=="function",$e=t=>typeof t=="string",bn=t=>typeof t=="symbol",Ne=t=>t!==null&&typeof t=="object",iu=t=>(Ne(t)||oe(t))&&oe(t.then)&&oe(t.catch),ou=Object.prototype.toString,di=t=>ou.call(t),mf=t=>di(t).slice(8,-1),lu=t=>di(t)==="[object Object]",el=t=>$e(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ws=Jo(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hi=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},gf=/-(\w)/g,pn=hi(t=>t.replace(gf,(e,n)=>n?n.toUpperCase():"")),_f=/\B([A-Z])/g,Cn=hi(t=>t.replace(_f,"-$1").toLowerCase()),au=hi(t=>t.charAt(0).toUpperCase()+t.slice(1)),$i=hi(t=>t?`on${au(t)}`:""),an=(t,e)=>!Object.is(t,e),Pr=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},mo=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},go=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let na;const fi=()=>na||(na=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function nr(t){if(re(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=$e(s)?Cf(s):nr(s);if(r)for(const i in r)e[i]=r[i]}return e}else if($e(t)||Ne(t))return t}const yf=/;(?![^(]*\))/g,vf=/:([^]+)/,bf=/\/\*[^]*?\*\//g;function Cf(t){const e={};return t.replace(bf,"").split(yf).forEach(n=>{if(n){const s=n.split(vf);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Qe(t){let e="";if($e(t))e=t;else if(re(t))for(let n=0;n<t.length;n++){const s=Qe(t[n]);s&&(e+=s+" ")}else if(Ne(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const wf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ef=Jo(wf);function cu(t){return!!t||t===""}const uu=t=>!!(t&&t.__v_isRef===!0),P=t=>$e(t)?t:t==null?"":re(t)||Ne(t)&&(t.toString===ou||!oe(t.toString))?uu(t)?P(t.value):JSON.stringify(t,du,2):String(t),du=(t,e)=>uu(e)?du(t,e.value):Gn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r],i)=>(n[Ui(s,i)+" =>"]=r,n),{})}:ru(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Ui(n))}:bn(e)?Ui(e):Ne(e)&&!re(e)&&!lu(e)?String(e):e,Ui=(t,e="")=>{var n;return bn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Xe;class hu{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Xe,!e&&Xe&&(this.index=(Xe.scopes||(Xe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Xe;try{return Xe=this,e()}finally{Xe=n}}}on(){++this._on===1&&(this.prevScope=Xe,Xe=this)}off(){this._on>0&&--this._on===0&&(Xe=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function fu(t){return new hu(t)}function pu(){return Xe}function Sf(t,e=!1){Xe&&Xe.cleanups.push(t)}let Pe;const Hi=new WeakSet;class mu{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Xe&&Xe.active&&Xe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Hi.has(this)&&(Hi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||_u(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,sa(this),yu(this);const e=Pe,n=Tt;Pe=this,Tt=!0;try{return this.fn()}finally{vu(this),Pe=e,Tt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)sl(e);this.deps=this.depsTail=void 0,sa(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Hi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_o(this)&&this.run()}get dirty(){return _o(this)}}let gu=0,Es,Ss;function _u(t,e=!1){if(t.flags|=8,e){t.next=Ss,Ss=t;return}t.next=Es,Es=t}function tl(){gu++}function nl(){if(--gu>0)return;if(Ss){let e=Ss;for(Ss=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Es;){let e=Es;for(Es=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function yu(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function vu(t){let e,n=t.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),sl(s),Tf(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=n}function _o(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(bu(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function bu(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===$s)||(t.globalVersion=$s,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!_o(t))))return;t.flags|=2;const e=t.dep,n=Pe,s=Tt;Pe=t,Tt=!0;try{yu(t);const r=t.fn(t._value);(e.version===0||an(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Pe=n,Tt=s,vu(t),t.flags&=-3}}function sl(t,e=!1){const{dep:n,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)sl(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Tf(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Tt=!0;const Cu=[];function zt(){Cu.push(Tt),Tt=!1}function Yt(){const t=Cu.pop();Tt=t===void 0?!0:t}function sa(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Pe;Pe=void 0;try{e()}finally{Pe=n}}}let $s=0;class If{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rl{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Pe||!Tt||Pe===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Pe)n=this.activeLink=new If(Pe,this),Pe.deps?(n.prevDep=Pe.depsTail,Pe.depsTail.nextDep=n,Pe.depsTail=n):Pe.deps=Pe.depsTail=n,wu(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=Pe.depsTail,n.nextDep=void 0,Pe.depsTail.nextDep=n,Pe.depsTail=n,Pe.deps===n&&(Pe.deps=s)}return n}trigger(e){this.version++,$s++,this.notify(e)}notify(e){tl();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{nl()}}}function wu(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)wu(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Dr=new WeakMap,kn=Symbol(""),yo=Symbol(""),Us=Symbol("");function Ze(t,e,n){if(Tt&&Pe){let s=Dr.get(t);s||Dr.set(t,s=new Map);let r=s.get(n);r||(s.set(n,r=new rl),r.map=s,r.key=n),r.track()}}function Vt(t,e,n,s,r,i){const o=Dr.get(t);if(!o){$s++;return}const l=a=>{a&&a.trigger()};if(tl(),e==="clear")o.forEach(l);else{const a=re(t),c=a&&el(n);if(a&&n==="length"){const d=Number(s);o.forEach((u,h)=>{(h==="length"||h===Us||!bn(h)&&h>=d)&&l(u)})}else switch((n!==void 0||o.has(void 0))&&l(o.get(n)),c&&l(o.get(Us)),e){case"add":a?c&&l(o.get("length")):(l(o.get(kn)),Gn(t)&&l(o.get(yo)));break;case"delete":a||(l(o.get(kn)),Gn(t)&&l(o.get(yo)));break;case"set":Gn(t)&&l(o.get(kn));break}}nl()}function Rf(t,e){const n=Dr.get(t);return n&&n.get(e)}function Dn(t){const e=_e(t);return e===t?e:(Ze(e,"iterate",Us),Ct(t)?e:e.map(ze))}function pi(t){return Ze(t=_e(t),"iterate",Us),t}const Pf={__proto__:null,[Symbol.iterator](){return Wi(this,Symbol.iterator,ze)},concat(...t){return Dn(this).concat(...t.map(e=>re(e)?Dn(e):e))},entries(){return Wi(this,"entries",t=>(t[1]=ze(t[1]),t))},every(t,e){return Ut(this,"every",t,e,void 0,arguments)},filter(t,e){return Ut(this,"filter",t,e,n=>n.map(ze),arguments)},find(t,e){return Ut(this,"find",t,e,ze,arguments)},findIndex(t,e){return Ut(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ut(this,"findLast",t,e,ze,arguments)},findLastIndex(t,e){return Ut(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ut(this,"forEach",t,e,void 0,arguments)},includes(...t){return Bi(this,"includes",t)},indexOf(...t){return Bi(this,"indexOf",t)},join(t){return Dn(this).join(t)},lastIndexOf(...t){return Bi(this,"lastIndexOf",t)},map(t,e){return Ut(this,"map",t,e,void 0,arguments)},pop(){return ds(this,"pop")},push(...t){return ds(this,"push",t)},reduce(t,...e){return ra(this,"reduce",t,e)},reduceRight(t,...e){return ra(this,"reduceRight",t,e)},shift(){return ds(this,"shift")},some(t,e){return Ut(this,"some",t,e,void 0,arguments)},splice(...t){return ds(this,"splice",t)},toReversed(){return Dn(this).toReversed()},toSorted(t){return Dn(this).toSorted(t)},toSpliced(...t){return Dn(this).toSpliced(...t)},unshift(...t){return ds(this,"unshift",t)},values(){return Wi(this,"values",ze)}};function Wi(t,e,n){const s=pi(t),r=s[e]();return s!==t&&!Ct(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=n(i.value)),i}),r}const kf=Array.prototype;function Ut(t,e,n,s,r,i){const o=pi(t),l=o!==t&&!Ct(t),a=o[e];if(a!==kf[e]){const u=a.apply(t,i);return l?ze(u):u}let c=n;o!==t&&(l?c=function(u,h){return n.call(this,ze(u),h,t)}:n.length>2&&(c=function(u,h){return n.call(this,u,h,t)}));const d=a.call(o,c,s);return l&&r?r(d):d}function ra(t,e,n,s){const r=pi(t);let i=n;return r!==t&&(Ct(t)?n.length>3&&(i=function(o,l,a){return n.call(this,o,l,a,t)}):i=function(o,l,a){return n.call(this,o,ze(l),a,t)}),r[e](i,...s)}function Bi(t,e,n){const s=_e(t);Ze(s,"iterate",Us);const r=s[e](...n);return(r===-1||r===!1)&&ll(n[0])?(n[0]=_e(n[0]),s[e](...n)):r}function ds(t,e,n=[]){zt(),tl();const s=_e(t)[e].apply(t,n);return nl(),Yt(),s}const xf=Jo("__proto__,__v_isRef,__isVue"),Eu=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(bn));function Af(t){bn(t)||(t=String(t));const e=_e(this);return Ze(e,"has",t),e.hasOwnProperty(t)}class Su{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(r?i?Wf:Pu:i?Ru:Iu).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=re(e);if(!r){let a;if(o&&(a=Pf[n]))return a;if(n==="hasOwnProperty")return Af}const l=Reflect.get(e,n,De(e)?e:s);return(bn(n)?Eu.has(n):xf(n))||(r||Ze(e,"get",n),i)?l:De(l)?o&&el(n)?l:l.value:Ne(l)?r?xu(l):sr(l):l}}class Tu extends Su{constructor(e=!1){super(!1,e)}set(e,n,s,r){let i=e[n];if(!this._isShallow){const a=mn(i);if(!Ct(s)&&!mn(s)&&(i=_e(i),s=_e(s)),!re(e)&&De(i)&&!De(s))return a?!1:(i.value=s,!0)}const o=re(e)&&el(n)?Number(n)<e.length:Ce(e,n),l=Reflect.set(e,n,s,De(e)?e:r);return e===_e(r)&&(o?an(s,i)&&Vt(e,"set",n,s):Vt(e,"add",n,s)),l}deleteProperty(e,n){const s=Ce(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&s&&Vt(e,"delete",n,void 0),r}has(e,n){const s=Reflect.has(e,n);return(!bn(n)||!Eu.has(n))&&Ze(e,"has",n),s}ownKeys(e){return Ze(e,"iterate",re(e)?"length":kn),Reflect.ownKeys(e)}}class Nf extends Su{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Lf=new Tu,Of=new Nf,Mf=new Tu(!0);const vo=t=>t,mr=t=>Reflect.getPrototypeOf(t);function Df(t,e,n){return function(...s){const r=this.__v_raw,i=_e(r),o=Gn(i),l=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,c=r[t](...s),d=n?vo:e?Fr:ze;return!e&&Ze(i,"iterate",a?yo:kn),{next(){const{value:u,done:h}=c.next();return h?{value:u,done:h}:{value:l?[d(u[0]),d(u[1])]:d(u),done:h}},[Symbol.iterator](){return this}}}}function gr(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Ff(t,e){const n={get(r){const i=this.__v_raw,o=_e(i),l=_e(r);t||(an(r,l)&&Ze(o,"get",r),Ze(o,"get",l));const{has:a}=mr(o),c=e?vo:t?Fr:ze;if(a.call(o,r))return c(i.get(r));if(a.call(o,l))return c(i.get(l));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&Ze(_e(r),"iterate",kn),Reflect.get(r,"size",r)},has(r){const i=this.__v_raw,o=_e(i),l=_e(r);return t||(an(r,l)&&Ze(o,"has",r),Ze(o,"has",l)),r===l?i.has(r):i.has(r)||i.has(l)},forEach(r,i){const o=this,l=o.__v_raw,a=_e(l),c=e?vo:t?Fr:ze;return!t&&Ze(a,"iterate",kn),l.forEach((d,u)=>r.call(i,c(d),c(u),o))}};return tt(n,t?{add:gr("add"),set:gr("set"),delete:gr("delete"),clear:gr("clear")}:{add(r){!e&&!Ct(r)&&!mn(r)&&(r=_e(r));const i=_e(this);return mr(i).has.call(i,r)||(i.add(r),Vt(i,"add",r,r)),this},set(r,i){!e&&!Ct(i)&&!mn(i)&&(i=_e(i));const o=_e(this),{has:l,get:a}=mr(o);let c=l.call(o,r);c||(r=_e(r),c=l.call(o,r));const d=a.call(o,r);return o.set(r,i),c?an(i,d)&&Vt(o,"set",r,i):Vt(o,"add",r,i),this},delete(r){const i=_e(this),{has:o,get:l}=mr(i);let a=o.call(i,r);a||(r=_e(r),a=o.call(i,r)),l&&l.call(i,r);const c=i.delete(r);return a&&Vt(i,"delete",r,void 0),c},clear(){const r=_e(this),i=r.size!==0,o=r.clear();return i&&Vt(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=Df(r,t,e)}),n}function il(t,e){const n=Ff(t,e);return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(Ce(n,r)&&r in s?n:s,r,i)}const $f={get:il(!1,!1)},Uf={get:il(!1,!0)},Hf={get:il(!0,!1)};const Iu=new WeakMap,Ru=new WeakMap,Pu=new WeakMap,Wf=new WeakMap;function Bf(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Vf(t){return t.__v_skip||!Object.isExtensible(t)?0:Bf(mf(t))}function sr(t){return mn(t)?t:ol(t,!1,Lf,$f,Iu)}function ku(t){return ol(t,!1,Mf,Uf,Ru)}function xu(t){return ol(t,!0,Of,Hf,Pu)}function ol(t,e,n,s,r){if(!Ne(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=Vf(t);if(i===0)return t;const o=r.get(t);if(o)return o;const l=new Proxy(t,i===2?s:n);return r.set(t,l),l}function cn(t){return mn(t)?cn(t.__v_raw):!!(t&&t.__v_isReactive)}function mn(t){return!!(t&&t.__v_isReadonly)}function Ct(t){return!!(t&&t.__v_isShallow)}function ll(t){return t?!!t.__v_raw:!1}function _e(t){const e=t&&t.__v_raw;return e?_e(e):t}function al(t){return!Ce(t,"__v_skip")&&Object.isExtensible(t)&&mo(t,"__v_skip",!0),t}const ze=t=>Ne(t)?sr(t):t,Fr=t=>Ne(t)?xu(t):t;function De(t){return t?t.__v_isRef===!0:!1}function V(t){return Au(t,!1)}function Gf(t){return Au(t,!0)}function Au(t,e){return De(t)?t:new jf(t,e)}class jf{constructor(e,n){this.dep=new rl,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:_e(e),this._value=n?e:ze(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||Ct(e)||mn(e);e=s?e:_e(e),an(e,n)&&(this._rawValue=e,this._value=s?e:ze(e),this.dep.trigger())}}function L(t){return De(t)?t.value:t}const qf={get:(t,e,n)=>e==="__v_raw"?t:L(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return De(r)&&!De(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function Nu(t){return cn(t)?t:new Proxy(t,qf)}function Kf(t){const e=re(t)?new Array(t.length):{};for(const n in t)e[n]=Yf(t,n);return e}class zf{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Rf(_e(this._object),this._key)}}function Yf(t,e,n){const s=t[e];return De(s)?s:new zf(t,e,n)}class Qf{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new rl(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$s-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Pe!==this)return _u(this,!0),!0}get value(){const e=this.dep.track();return bu(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Jf(t,e,n=!1){let s,r;return oe(t)?s=t:(s=t.get,r=t.set),new Qf(s,r,n)}const _r={},$r=new WeakMap;let Tn;function Xf(t,e=!1,n=Tn){if(n){let s=$r.get(n);s||$r.set(n,s=[]),s.push(t)}}function Zf(t,e,n=Ie){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:l,call:a}=n,c=T=>r?T:Ct(T)||r===!1||r===0?Gt(T,1):Gt(T);let d,u,h,f,_=!1,C=!1;if(De(t)?(u=()=>t.value,_=Ct(t)):cn(t)?(u=()=>c(t),_=!0):re(t)?(C=!0,_=t.some(T=>cn(T)||Ct(T)),u=()=>t.map(T=>{if(De(T))return T.value;if(cn(T))return c(T);if(oe(T))return a?a(T,2):T()})):oe(t)?e?u=a?()=>a(t,2):t:u=()=>{if(h){zt();try{h()}finally{Yt()}}const T=Tn;Tn=d;try{return a?a(t,3,[f]):t(f)}finally{Tn=T}}:u=Dt,e&&r){const T=u,U=r===!0?1/0:r;u=()=>Gt(T(),U)}const S=pu(),b=()=>{d.stop(),S&&S.active&&Zo(S.effects,d)};if(i&&e){const T=e;e=(...U)=>{T(...U),b()}}let E=C?new Array(t.length).fill(_r):_r;const I=T=>{if(!(!(d.flags&1)||!d.dirty&&!T))if(e){const U=d.run();if(r||_||(C?U.some((Z,te)=>an(Z,E[te])):an(U,E))){h&&h();const Z=Tn;Tn=d;try{const te=[U,E===_r?void 0:C&&E[0]===_r?[]:E,f];E=U,a?a(e,3,te):e(...te)}finally{Tn=Z}}}else d.run()};return l&&l(I),d=new mu(u),d.scheduler=o?()=>o(I,!1):I,f=T=>Xf(T,!1,d),h=d.onStop=()=>{const T=$r.get(d);if(T){if(a)a(T,4);else for(const U of T)U();$r.delete(d)}},e?s?I(!0):E=d.run():o?o(I.bind(null,!0),!0):d.run(),b.pause=d.pause.bind(d),b.resume=d.resume.bind(d),b.stop=b,b}function Gt(t,e=1/0,n){if(e<=0||!Ne(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,De(t))Gt(t.value,e,n);else if(re(t))for(let s=0;s<t.length;s++)Gt(t[s],e,n);else if(ru(t)||Gn(t))t.forEach(s=>{Gt(s,e,n)});else if(lu(t)){for(const s in t)Gt(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Gt(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function rr(t,e,n,s){try{return s?t(...s):t()}catch(r){mi(r,e,n)}}function Ft(t,e,n,s){if(oe(t)){const r=rr(t,e,n,s);return r&&iu(r)&&r.catch(i=>{mi(i,e,n)}),r}if(re(t)){const r=[];for(let i=0;i<t.length;i++)r.push(Ft(t[i],e,n,s));return r}}function mi(t,e,n,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ie;if(e){let l=e.parent;const a=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const d=l.ec;if(d){for(let u=0;u<d.length;u++)if(d[u](t,a,c)===!1)return}l=l.parent}if(i){zt(),rr(i,null,10,[t,a,c]),Yt();return}}ep(t,n,r,s,o)}function ep(t,e,n,s=!0,r=!1){if(r)throw t;console.error(t)}const st=[];let Ot=-1;const jn=[];let sn=null,Un=0;const Lu=Promise.resolve();let Ur=null;function gi(t){const e=Ur||Lu;return t?e.then(this?t.bind(this):t):e}function tp(t){let e=Ot+1,n=st.length;for(;e<n;){const s=e+n>>>1,r=st[s],i=Hs(r);i<t||i===t&&r.flags&2?e=s+1:n=s}return e}function cl(t){if(!(t.flags&1)){const e=Hs(t),n=st[st.length-1];!n||!(t.flags&2)&&e>=Hs(n)?st.push(t):st.splice(tp(e),0,t),t.flags|=1,Ou()}}function Ou(){Ur||(Ur=Lu.then(Du))}function np(t){re(t)?jn.push(...t):sn&&t.id===-1?sn.splice(Un+1,0,t):t.flags&1||(jn.push(t),t.flags|=1),Ou()}function ia(t,e,n=Ot+1){for(;n<st.length;n++){const s=st[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;st.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Mu(t){if(jn.length){const e=[...new Set(jn)].sort((n,s)=>Hs(n)-Hs(s));if(jn.length=0,sn){sn.push(...e);return}for(sn=e,Un=0;Un<sn.length;Un++){const n=sn[Un];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}sn=null,Un=0}}const Hs=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Du(t){try{for(Ot=0;Ot<st.length;Ot++){const e=st[Ot];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),rr(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ot<st.length;Ot++){const e=st[Ot];e&&(e.flags&=-2)}Ot=-1,st.length=0,Mu(),Ur=null,(st.length||jn.length)&&Du()}}let mt=null,Fu=null;function Hr(t){const e=mt;return mt=t,Fu=t&&t.type.__scopeId||null,e}function sp(t,e=mt,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&pa(-1);const i=Hr(e);let o;try{o=t(...r)}finally{Hr(i),s._d&&pa(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function yt(t,e){if(mt===null)return t;const n=bi(mt),s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,l,a=Ie]=e[r];i&&(oe(i)&&(i={mounted:i,updated:i}),i.deep&&Gt(o),s.push({dir:i,instance:n,value:o,oldValue:void 0,arg:l,modifiers:a}))}return t}function En(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const l=r[o];i&&(l.oldValue=i[o].value);let a=l.dir[s];a&&(zt(),Ft(a,n,8,[t.el,l,t,e]),Yt())}}const rp=Symbol("_vte"),ip=t=>t.__isTeleport;function ul(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ul(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function ut(t,e){return oe(t)?tt({name:t.name},e,{setup:t}):t}function $u(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Ts(t,e,n,s,r=!1){if(re(t)){t.forEach((_,C)=>Ts(_,e&&(re(e)?e[C]:e),n,s,r));return}if(Is(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Ts(t,e,n,s.component.subTree);return}const i=s.shapeFlag&4?bi(s.component):s.el,o=r?null:i,{i:l,r:a}=t,c=e&&e.r,d=l.refs===Ie?l.refs={}:l.refs,u=l.setupState,h=_e(u),f=u===Ie?()=>!1:_=>Ce(h,_);if(c!=null&&c!==a&&($e(c)?(d[c]=null,f(c)&&(u[c]=null)):De(c)&&(c.value=null)),oe(a))rr(a,l,12,[o,d]);else{const _=$e(a),C=De(a);if(_||C){const S=()=>{if(t.f){const b=_?f(a)?u[a]:d[a]:a.value;r?re(b)&&Zo(b,i):re(b)?b.includes(i)||b.push(i):_?(d[a]=[i],f(a)&&(u[a]=d[a])):(a.value=[i],t.k&&(d[t.k]=a.value))}else _?(d[a]=o,f(a)&&(u[a]=o)):C&&(a.value=o,t.k&&(d[t.k]=o))};o?(S.id=-1,ft(S,n)):S()}}}fi().requestIdleCallback;fi().cancelIdleCallback;const Is=t=>!!t.type.__asyncLoader,Uu=t=>t.type.__isKeepAlive;function Hu(t,e){Bu(t,"a",e)}function Wu(t,e){Bu(t,"da",e)}function Bu(t,e,n=et){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(_i(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Uu(r.parent.vnode)&&op(s,e,n,r),r=r.parent}}function op(t,e,n,s){const r=_i(e,t,s,!0);ir(()=>{Zo(s[e],r)},n)}function _i(t,e,n=et,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{zt();const l=or(n),a=Ft(e,n,t,o);return l(),Yt(),a});return s?r.unshift(i):r.push(i),i}}const Xt=t=>(e,n=et)=>{(!Bs||t==="sp")&&_i(t,(...s)=>e(...s),n)},lp=Xt("bm"),wn=Xt("m"),ap=Xt("bu"),cp=Xt("u"),Vu=Xt("bum"),ir=Xt("um"),up=Xt("sp"),dp=Xt("rtg"),hp=Xt("rtc");function fp(t,e=et){_i("ec",t,e)}const pp=Symbol.for("v-ndc");function It(t,e,n,s){let r;const i=n,o=re(t);if(o||$e(t)){const l=o&&cn(t);let a=!1,c=!1;l&&(a=!Ct(t),c=mn(t),t=pi(t)),r=new Array(t.length);for(let d=0,u=t.length;d<u;d++)r[d]=e(a?c?Fr(ze(t[d])):ze(t[d]):t[d],d,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let l=0;l<t;l++)r[l]=e(l+1,l,void 0,i)}else if(Ne(t))if(t[Symbol.iterator])r=Array.from(t,(l,a)=>e(l,a,void 0,i));else{const l=Object.keys(t);r=new Array(l.length);for(let a=0,c=l.length;a<c;a++){const d=l[a];r[a]=e(t[d],d,a,i)}}else r=[];return r}const bo=t=>t?ud(t)?bi(t):bo(t.parent):null,Rs=tt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>bo(t.parent),$root:t=>bo(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>ju(t),$forceUpdate:t=>t.f||(t.f=()=>{cl(t.update)}),$nextTick:t=>t.n||(t.n=gi.bind(t.proxy)),$watch:t=>Dp.bind(t)}),Vi=(t,e)=>t!==Ie&&!t.__isScriptSetup&&Ce(t,e),mp={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:l,appContext:a}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(Vi(s,e))return o[e]=1,s[e];if(r!==Ie&&Ce(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&Ce(c,e))return o[e]=3,i[e];if(n!==Ie&&Ce(n,e))return o[e]=4,n[e];Co&&(o[e]=0)}}const d=Rs[e];let u,h;if(d)return e==="$attrs"&&Ze(t.attrs,"get",""),d(t);if((u=l.__cssModules)&&(u=u[e]))return u;if(n!==Ie&&Ce(n,e))return o[e]=4,n[e];if(h=a.config.globalProperties,Ce(h,e))return h[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return Vi(r,e)?(r[e]=n,!0):s!==Ie&&Ce(s,e)?(s[e]=n,!0):Ce(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let l;return!!n[o]||t!==Ie&&Ce(t,o)||Vi(e,o)||(l=i[0])&&Ce(l,o)||Ce(s,o)||Ce(Rs,o)||Ce(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ce(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function oa(t){return re(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Co=!0;function gp(t){const e=ju(t),n=t.proxy,s=t.ctx;Co=!1,e.beforeCreate&&la(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:l,provide:a,inject:c,created:d,beforeMount:u,mounted:h,beforeUpdate:f,updated:_,activated:C,deactivated:S,beforeDestroy:b,beforeUnmount:E,destroyed:I,unmounted:T,render:U,renderTracked:Z,renderTriggered:te,errorCaptured:X,serverPrefetch:K,expose:he,inheritAttrs:ve,components:q,directives:j,filters:ae}=e;if(c&&_p(c,s,null),o)for(const se in o){const fe=o[se];oe(fe)&&(s[se]=fe.bind(n))}if(r){const se=r.call(n,n);Ne(se)&&(t.data=sr(se))}if(Co=!0,i)for(const se in i){const fe=i[se],ot=oe(fe)?fe.bind(n,n):oe(fe.get)?fe.get.bind(n,n):Dt,dt=!oe(fe)&&oe(fe.set)?fe.set.bind(n):Dt,Ke=ee({get:ot,set:dt});Object.defineProperty(s,se,{enumerable:!0,configurable:!0,get:()=>Ke.value,set:Le=>Ke.value=Le})}if(l)for(const se in l)Gu(l[se],s,n,se);if(a){const se=oe(a)?a.call(n):a;Reflect.ownKeys(se).forEach(fe=>{kr(fe,se[fe])})}d&&la(d,t,"c");function we(se,fe){re(fe)?fe.forEach(ot=>se(ot.bind(n))):fe&&se(fe.bind(n))}if(we(lp,u),we(wn,h),we(ap,f),we(cp,_),we(Hu,C),we(Wu,S),we(fp,X),we(hp,Z),we(dp,te),we(Vu,E),we(ir,T),we(up,K),re(he))if(he.length){const se=t.exposed||(t.exposed={});he.forEach(fe=>{Object.defineProperty(se,fe,{get:()=>n[fe],set:ot=>n[fe]=ot})})}else t.exposed||(t.exposed={});U&&t.render===Dt&&(t.render=U),ve!=null&&(t.inheritAttrs=ve),q&&(t.components=q),j&&(t.directives=j),K&&$u(t)}function _p(t,e,n=Dt){re(t)&&(t=wo(t));for(const s in t){const r=t[s];let i;Ne(r)?"default"in r?i=_t(r.from||s,r.default,!0):i=_t(r.from||s):i=_t(r),De(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function la(t,e,n){Ft(re(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function Gu(t,e,n,s){let r=s.includes(".")?rd(n,s):()=>n[s];if($e(t)){const i=e[t];oe(i)&&qt(r,i)}else if(oe(t))qt(r,t.bind(n));else if(Ne(t))if(re(t))t.forEach(i=>Gu(i,e,n,s));else{const i=oe(t.handler)?t.handler.bind(n):e[t.handler];oe(i)&&qt(r,i,t)}}function ju(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,l=i.get(e);let a;return l?a=l:!r.length&&!n&&!s?a=e:(a={},r.length&&r.forEach(c=>Wr(a,c,o,!0)),Wr(a,e,o)),Ne(e)&&i.set(e,a),a}function Wr(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Wr(t,i,n,!0),r&&r.forEach(o=>Wr(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const l=yp[o]||n&&n[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const yp={data:aa,props:ca,emits:ca,methods:bs,computed:bs,beforeCreate:nt,created:nt,beforeMount:nt,mounted:nt,beforeUpdate:nt,updated:nt,beforeDestroy:nt,beforeUnmount:nt,destroyed:nt,unmounted:nt,activated:nt,deactivated:nt,errorCaptured:nt,serverPrefetch:nt,components:bs,directives:bs,watch:bp,provide:aa,inject:vp};function aa(t,e){return e?t?function(){return tt(oe(t)?t.call(this,this):t,oe(e)?e.call(this,this):e)}:e:t}function vp(t,e){return bs(wo(t),wo(e))}function wo(t){if(re(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function nt(t,e){return t?[...new Set([].concat(t,e))]:e}function bs(t,e){return t?tt(Object.create(null),t,e):e}function ca(t,e){return t?re(t)&&re(e)?[...new Set([...t,...e])]:tt(Object.create(null),oa(t),oa(e??{})):e}function bp(t,e){if(!t)return e;if(!e)return t;const n=tt(Object.create(null),t);for(const s in e)n[s]=nt(t[s],e[s]);return n}function qu(){return{app:null,config:{isNativeTag:ff,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Cp=0;function wp(t,e){return function(s,r=null){oe(s)||(s=tt({},s)),r!=null&&!Ne(r)&&(r=null);const i=qu(),o=new WeakSet,l=[];let a=!1;const c=i.app={_uid:Cp++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:nm,get config(){return i.config},set config(d){},use(d,...u){return o.has(d)||(d&&oe(d.install)?(o.add(d),d.install(c,...u)):oe(d)&&(o.add(d),d(c,...u))),c},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),c},component(d,u){return u?(i.components[d]=u,c):i.components[d]},directive(d,u){return u?(i.directives[d]=u,c):i.directives[d]},mount(d,u,h){if(!a){const f=c._ceVNode||We(s,r);return f.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),t(f,d,h),a=!0,c._container=d,d.__vue_app__=c,bi(f.component)}},onUnmount(d){l.push(d)},unmount(){a&&(Ft(l,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(d,u){return i.provides[d]=u,c},runWithContext(d){const u=xn;xn=c;try{return d()}finally{xn=u}}};return c}}let xn=null;function kr(t,e){if(et){let n=et.provides;const s=et.parent&&et.parent.provides;s===n&&(n=et.provides=Object.create(s)),n[t]=e}}function _t(t,e,n=!1){const s=et||mt;if(s||xn){let r=xn?xn._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&oe(e)?e.call(s&&s.proxy):e}}function Ep(){return!!(et||mt||xn)}const Ku={},zu=()=>Object.create(Ku),Yu=t=>Object.getPrototypeOf(t)===Ku;function Sp(t,e,n,s=!1){const r={},i=zu();t.propsDefaults=Object.create(null),Qu(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:ku(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function Tp(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,l=_e(r),[a]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let u=0;u<d.length;u++){let h=d[u];if(yi(t.emitsOptions,h))continue;const f=e[h];if(a)if(Ce(i,h))f!==i[h]&&(i[h]=f,c=!0);else{const _=pn(h);r[_]=Eo(a,l,_,f,t,!1)}else f!==i[h]&&(i[h]=f,c=!0)}}}else{Qu(t,e,r,i)&&(c=!0);let d;for(const u in l)(!e||!Ce(e,u)&&((d=Cn(u))===u||!Ce(e,d)))&&(a?n&&(n[u]!==void 0||n[d]!==void 0)&&(r[u]=Eo(a,l,u,void 0,t,!0)):delete r[u]);if(i!==l)for(const u in i)(!e||!Ce(e,u))&&(delete i[u],c=!0)}c&&Vt(t.attrs,"set","")}function Qu(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,l;if(e)for(let a in e){if(ws(a))continue;const c=e[a];let d;r&&Ce(r,d=pn(a))?!i||!i.includes(d)?n[d]=c:(l||(l={}))[d]=c:yi(t.emitsOptions,a)||(!(a in s)||c!==s[a])&&(s[a]=c,o=!0)}if(i){const a=_e(n),c=l||Ie;for(let d=0;d<i.length;d++){const u=i[d];n[u]=Eo(r,a,u,c[u],t,!Ce(c,u))}}return o}function Eo(t,e,n,s,r,i){const o=t[n];if(o!=null){const l=Ce(o,"default");if(l&&s===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&oe(a)){const{propsDefaults:c}=r;if(n in c)s=c[n];else{const d=or(r);s=c[n]=a.call(null,e),d()}}else s=a;r.ce&&r.ce._setProp(n,s)}o[0]&&(i&&!l?s=!1:o[1]&&(s===""||s===Cn(n))&&(s=!0))}return s}const Ip=new WeakMap;function Ju(t,e,n=!1){const s=n?Ip:e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},l=[];let a=!1;if(!oe(t)){const d=u=>{a=!0;const[h,f]=Ju(u,e,!0);tt(o,h),f&&l.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!i&&!a)return Ne(t)&&s.set(t,Vn),Vn;if(re(i))for(let d=0;d<i.length;d++){const u=pn(i[d]);ua(u)&&(o[u]=Ie)}else if(i)for(const d in i){const u=pn(d);if(ua(u)){const h=i[d],f=o[u]=re(h)||oe(h)?{type:h}:tt({},h),_=f.type;let C=!1,S=!0;if(re(_))for(let b=0;b<_.length;++b){const E=_[b],I=oe(E)&&E.name;if(I==="Boolean"){C=!0;break}else I==="String"&&(S=!1)}else C=oe(_)&&_.name==="Boolean";f[0]=C,f[1]=S,(C||Ce(f,"default"))&&l.push(u)}}const c=[o,l];return Ne(t)&&s.set(t,c),c}function ua(t){return t[0]!=="$"&&!ws(t)}const dl=t=>t[0]==="_"||t==="$stable",hl=t=>re(t)?t.map(Mt):[Mt(t)],Rp=(t,e,n)=>{if(e._n)return e;const s=sp((...r)=>hl(e(...r)),n);return s._c=!1,s},Xu=(t,e,n)=>{const s=t._ctx;for(const r in t){if(dl(r))continue;const i=t[r];if(oe(i))e[r]=Rp(r,i,s);else if(i!=null){const o=hl(i);e[r]=()=>o}}},Zu=(t,e)=>{const n=hl(e);t.slots.default=()=>n},ed=(t,e,n)=>{for(const s in e)(n||!dl(s))&&(t[s]=e[s])},Pp=(t,e,n)=>{const s=t.slots=zu();if(t.vnode.shapeFlag&32){const r=e.__;r&&mo(s,"__",r,!0);const i=e._;i?(ed(s,e,n),n&&mo(s,"_",i,!0)):Xu(e,s)}else e&&Zu(t,e)},kp=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Ie;if(s.shapeFlag&32){const l=e._;l?n&&l===1?i=!1:ed(r,e,n):(i=!e.$stable,Xu(e,r)),o=e}else e&&(Zu(t,e),o={default:1});if(i)for(const l in r)!dl(l)&&o[l]==null&&delete r[l]},ft=Vp;function xp(t){return Ap(t)}function Ap(t,e){const n=fi();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:l,createComment:a,setText:c,setElementText:d,parentNode:u,nextSibling:h,setScopeId:f=Dt,insertStaticContent:_}=t,C=(m,g,v,R=null,M=null,A=null,B=void 0,W=null,H=!!g.dynamicChildren)=>{if(m===g)return;m&&!hs(m,g)&&(R=y(m),Le(m,M,A,!0),m=null),g.patchFlag===-2&&(H=!1,g.dynamicChildren=null);const{type:F,ref:J,shapeFlag:G}=g;switch(F){case vi:S(m,g,v,R);break;case gn:b(m,g,v,R);break;case xr:m==null&&E(g,v,R,B);break;case Fe:q(m,g,v,R,M,A,B,W,H);break;default:G&1?U(m,g,v,R,M,A,B,W,H):G&6?j(m,g,v,R,M,A,B,W,H):(G&64||G&128)&&F.process(m,g,v,R,M,A,B,W,H,x)}J!=null&&M?Ts(J,m&&m.ref,A,g||m,!g):J==null&&m&&m.ref!=null&&Ts(m.ref,null,A,m,!0)},S=(m,g,v,R)=>{if(m==null)s(g.el=l(g.children),v,R);else{const M=g.el=m.el;g.children!==m.children&&c(M,g.children)}},b=(m,g,v,R)=>{m==null?s(g.el=a(g.children||""),v,R):g.el=m.el},E=(m,g,v,R)=>{[m.el,m.anchor]=_(m.children,g,v,R,m.el,m.anchor)},I=({el:m,anchor:g},v,R)=>{let M;for(;m&&m!==g;)M=h(m),s(m,v,R),m=M;s(g,v,R)},T=({el:m,anchor:g})=>{let v;for(;m&&m!==g;)v=h(m),r(m),m=v;r(g)},U=(m,g,v,R,M,A,B,W,H)=>{g.type==="svg"?B="svg":g.type==="math"&&(B="mathml"),m==null?Z(g,v,R,M,A,B,W,H):K(m,g,M,A,B,W,H)},Z=(m,g,v,R,M,A,B,W)=>{let H,F;const{props:J,shapeFlag:G,transition:Q,dirs:ie}=m;if(H=m.el=o(m.type,A,J&&J.is,J),G&8?d(H,m.children):G&16&&X(m.children,H,null,R,M,Gi(m,A),B,W),ie&&En(m,null,R,"created"),te(H,m,m.scopeId,B,R),J){for(const Re in J)Re!=="value"&&!ws(Re)&&i(H,Re,null,J[Re],A,R);"value"in J&&i(H,"value",null,J.value,A),(F=J.onVnodeBeforeMount)&&Lt(F,R,m)}ie&&En(m,null,R,"beforeMount");const me=Np(M,Q);me&&Q.beforeEnter(H),s(H,g,v),((F=J&&J.onVnodeMounted)||me||ie)&&ft(()=>{F&&Lt(F,R,m),me&&Q.enter(H),ie&&En(m,null,R,"mounted")},M)},te=(m,g,v,R,M)=>{if(v&&f(m,v),R)for(let A=0;A<R.length;A++)f(m,R[A]);if(M){let A=M.subTree;if(g===A||od(A.type)&&(A.ssContent===g||A.ssFallback===g)){const B=M.vnode;te(m,B,B.scopeId,B.slotScopeIds,M.parent)}}},X=(m,g,v,R,M,A,B,W,H=0)=>{for(let F=H;F<m.length;F++){const J=m[F]=W?rn(m[F]):Mt(m[F]);C(null,J,g,v,R,M,A,B,W)}},K=(m,g,v,R,M,A,B)=>{const W=g.el=m.el;let{patchFlag:H,dynamicChildren:F,dirs:J}=g;H|=m.patchFlag&16;const G=m.props||Ie,Q=g.props||Ie;let ie;if(v&&Sn(v,!1),(ie=Q.onVnodeBeforeUpdate)&&Lt(ie,v,g,m),J&&En(g,m,v,"beforeUpdate"),v&&Sn(v,!0),(G.innerHTML&&Q.innerHTML==null||G.textContent&&Q.textContent==null)&&d(W,""),F?he(m.dynamicChildren,F,W,v,R,Gi(g,M),A):B||fe(m,g,W,null,v,R,Gi(g,M),A,!1),H>0){if(H&16)ve(W,G,Q,v,M);else if(H&2&&G.class!==Q.class&&i(W,"class",null,Q.class,M),H&4&&i(W,"style",G.style,Q.style,M),H&8){const me=g.dynamicProps;for(let Re=0;Re<me.length;Re++){const Ee=me[Re],lt=G[Ee],at=Q[Ee];(at!==lt||Ee==="value")&&i(W,Ee,lt,at,M,v)}}H&1&&m.children!==g.children&&d(W,g.children)}else!B&&F==null&&ve(W,G,Q,v,M);((ie=Q.onVnodeUpdated)||J)&&ft(()=>{ie&&Lt(ie,v,g,m),J&&En(g,m,v,"updated")},R)},he=(m,g,v,R,M,A,B)=>{for(let W=0;W<g.length;W++){const H=m[W],F=g[W],J=H.el&&(H.type===Fe||!hs(H,F)||H.shapeFlag&198)?u(H.el):v;C(H,F,J,null,R,M,A,B,!0)}},ve=(m,g,v,R,M)=>{if(g!==v){if(g!==Ie)for(const A in g)!ws(A)&&!(A in v)&&i(m,A,g[A],null,M,R);for(const A in v){if(ws(A))continue;const B=v[A],W=g[A];B!==W&&A!=="value"&&i(m,A,W,B,M,R)}"value"in v&&i(m,"value",g.value,v.value,M)}},q=(m,g,v,R,M,A,B,W,H)=>{const F=g.el=m?m.el:l(""),J=g.anchor=m?m.anchor:l("");let{patchFlag:G,dynamicChildren:Q,slotScopeIds:ie}=g;ie&&(W=W?W.concat(ie):ie),m==null?(s(F,v,R),s(J,v,R),X(g.children||[],v,J,M,A,B,W,H)):G>0&&G&64&&Q&&m.dynamicChildren?(he(m.dynamicChildren,Q,v,M,A,B,W),(g.key!=null||M&&g===M.subTree)&&td(m,g,!0)):fe(m,g,v,J,M,A,B,W,H)},j=(m,g,v,R,M,A,B,W,H)=>{g.slotScopeIds=W,m==null?g.shapeFlag&512?M.ctx.activate(g,v,R,B,H):ae(g,v,R,M,A,B,H):Be(m,g,H)},ae=(m,g,v,R,M,A,B)=>{const W=m.component=Qp(m,R,M);if(Uu(m)&&(W.ctx.renderer=x),Jp(W,!1,B),W.asyncDep){if(M&&M.registerDep(W,we,B),!m.el){const H=W.subTree=We(gn);b(null,H,g,v)}}else we(W,m,g,v,M,A,B)},Be=(m,g,v)=>{const R=g.component=m.component;if(Wp(m,g,v))if(R.asyncDep&&!R.asyncResolved){se(R,g,v);return}else R.next=g,R.update();else g.el=m.el,R.vnode=g},we=(m,g,v,R,M,A,B)=>{const W=()=>{if(m.isMounted){let{next:G,bu:Q,u:ie,parent:me,vnode:Re}=m;{const At=nd(m);if(At){G&&(G.el=Re.el,se(m,G,B)),At.asyncDep.then(()=>{m.isUnmounted||W()});return}}let Ee=G,lt;Sn(m,!1),G?(G.el=Re.el,se(m,G,B)):G=Re,Q&&Pr(Q),(lt=G.props&&G.props.onVnodeBeforeUpdate)&&Lt(lt,me,G,Re),Sn(m,!0);const at=ha(m),xt=m.subTree;m.subTree=at,C(xt,at,u(xt.el),y(xt),m,M,A),G.el=at.el,Ee===null&&Bp(m,at.el),ie&&ft(ie,M),(lt=G.props&&G.props.onVnodeUpdated)&&ft(()=>Lt(lt,me,G,Re),M)}else{let G;const{el:Q,props:ie}=g,{bm:me,m:Re,parent:Ee,root:lt,type:at}=m,xt=Is(g);Sn(m,!1),me&&Pr(me),!xt&&(G=ie&&ie.onVnodeBeforeMount)&&Lt(G,Ee,g),Sn(m,!0);{lt.ce&&lt.ce._def.shadowRoot!==!1&&lt.ce._injectChildStyle(at);const At=m.subTree=ha(m);C(null,At,v,R,m,M,A),g.el=At.el}if(Re&&ft(Re,M),!xt&&(G=ie&&ie.onVnodeMounted)){const At=g;ft(()=>Lt(G,Ee,At),M)}(g.shapeFlag&256||Ee&&Is(Ee.vnode)&&Ee.vnode.shapeFlag&256)&&m.a&&ft(m.a,M),m.isMounted=!0,g=v=R=null}};m.scope.on();const H=m.effect=new mu(W);m.scope.off();const F=m.update=H.run.bind(H),J=m.job=H.runIfDirty.bind(H);J.i=m,J.id=m.uid,H.scheduler=()=>cl(J),Sn(m,!0),F()},se=(m,g,v)=>{g.component=m;const R=m.vnode.props;m.vnode=g,m.next=null,Tp(m,g.props,R,v),kp(m,g.children,v),zt(),ia(m),Yt()},fe=(m,g,v,R,M,A,B,W,H=!1)=>{const F=m&&m.children,J=m?m.shapeFlag:0,G=g.children,{patchFlag:Q,shapeFlag:ie}=g;if(Q>0){if(Q&128){dt(F,G,v,R,M,A,B,W,H);return}else if(Q&256){ot(F,G,v,R,M,A,B,W,H);return}}ie&8?(J&16&&k(F,M,A),G!==F&&d(v,G)):J&16?ie&16?dt(F,G,v,R,M,A,B,W,H):k(F,M,A,!0):(J&8&&d(v,""),ie&16&&X(G,v,R,M,A,B,W,H))},ot=(m,g,v,R,M,A,B,W,H)=>{m=m||Vn,g=g||Vn;const F=m.length,J=g.length,G=Math.min(F,J);let Q;for(Q=0;Q<G;Q++){const ie=g[Q]=H?rn(g[Q]):Mt(g[Q]);C(m[Q],ie,v,null,M,A,B,W,H)}F>J?k(m,M,A,!0,!1,G):X(g,v,R,M,A,B,W,H,G)},dt=(m,g,v,R,M,A,B,W,H)=>{let F=0;const J=g.length;let G=m.length-1,Q=J-1;for(;F<=G&&F<=Q;){const ie=m[F],me=g[F]=H?rn(g[F]):Mt(g[F]);if(hs(ie,me))C(ie,me,v,null,M,A,B,W,H);else break;F++}for(;F<=G&&F<=Q;){const ie=m[G],me=g[Q]=H?rn(g[Q]):Mt(g[Q]);if(hs(ie,me))C(ie,me,v,null,M,A,B,W,H);else break;G--,Q--}if(F>G){if(F<=Q){const ie=Q+1,me=ie<J?g[ie].el:R;for(;F<=Q;)C(null,g[F]=H?rn(g[F]):Mt(g[F]),v,me,M,A,B,W,H),F++}}else if(F>Q)for(;F<=G;)Le(m[F],M,A,!0),F++;else{const ie=F,me=F,Re=new Map;for(F=me;F<=Q;F++){const ht=g[F]=H?rn(g[F]):Mt(g[F]);ht.key!=null&&Re.set(ht.key,F)}let Ee,lt=0;const at=Q-me+1;let xt=!1,At=0;const us=new Array(at);for(F=0;F<at;F++)us[F]=0;for(F=ie;F<=G;F++){const ht=m[F];if(lt>=at){Le(ht,M,A,!0);continue}let Nt;if(ht.key!=null)Nt=Re.get(ht.key);else for(Ee=me;Ee<=Q;Ee++)if(us[Ee-me]===0&&hs(ht,g[Ee])){Nt=Ee;break}Nt===void 0?Le(ht,M,A,!0):(us[Nt-me]=F+1,Nt>=At?At=Nt:xt=!0,C(ht,g[Nt],v,null,M,A,B,W,H),lt++)}const ea=xt?Lp(us):Vn;for(Ee=ea.length-1,F=at-1;F>=0;F--){const ht=me+F,Nt=g[ht],ta=ht+1<J?g[ht+1].el:R;us[F]===0?C(null,Nt,v,ta,M,A,B,W,H):xt&&(Ee<0||F!==ea[Ee]?Ke(Nt,v,ta,2):Ee--)}}},Ke=(m,g,v,R,M=null)=>{const{el:A,type:B,transition:W,children:H,shapeFlag:F}=m;if(F&6){Ke(m.component.subTree,g,v,R);return}if(F&128){m.suspense.move(g,v,R);return}if(F&64){B.move(m,g,v,x);return}if(B===Fe){s(A,g,v);for(let G=0;G<H.length;G++)Ke(H[G],g,v,R);s(m.anchor,g,v);return}if(B===xr){I(m,g,v);return}if(R!==2&&F&1&&W)if(R===0)W.beforeEnter(A),s(A,g,v),ft(()=>W.enter(A),M);else{const{leave:G,delayLeave:Q,afterLeave:ie}=W,me=()=>{m.ctx.isUnmounted?r(A):s(A,g,v)},Re=()=>{G(A,()=>{me(),ie&&ie()})};Q?Q(A,me,Re):Re()}else s(A,g,v)},Le=(m,g,v,R=!1,M=!1)=>{const{type:A,props:B,ref:W,children:H,dynamicChildren:F,shapeFlag:J,patchFlag:G,dirs:Q,cacheIndex:ie}=m;if(G===-2&&(M=!1),W!=null&&(zt(),Ts(W,null,v,m,!0),Yt()),ie!=null&&(g.renderCache[ie]=void 0),J&256){g.ctx.deactivate(m);return}const me=J&1&&Q,Re=!Is(m);let Ee;if(Re&&(Ee=B&&B.onVnodeBeforeUnmount)&&Lt(Ee,g,m),J&6)Te(m.component,v,R);else{if(J&128){m.suspense.unmount(v,R);return}me&&En(m,null,g,"beforeUnmount"),J&64?m.type.remove(m,g,v,x,R):F&&!F.hasOnce&&(A!==Fe||G>0&&G&64)?k(F,g,v,!1,!0):(A===Fe&&G&384||!M&&J&16)&&k(H,g,v),R&&z(m)}(Re&&(Ee=B&&B.onVnodeUnmounted)||me)&&ft(()=>{Ee&&Lt(Ee,g,m),me&&En(m,null,g,"unmounted")},v)},z=m=>{const{type:g,el:v,anchor:R,transition:M}=m;if(g===Fe){le(v,R);return}if(g===xr){T(m);return}const A=()=>{r(v),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(m.shapeFlag&1&&M&&!M.persisted){const{leave:B,delayLeave:W}=M,H=()=>B(v,A);W?W(m.el,A,H):H()}else A()},le=(m,g)=>{let v;for(;m!==g;)v=h(m),r(m),m=v;r(g)},Te=(m,g,v)=>{const{bum:R,scope:M,job:A,subTree:B,um:W,m:H,a:F,parent:J,slots:{__:G}}=m;da(H),da(F),R&&Pr(R),J&&re(G)&&G.forEach(Q=>{J.renderCache[Q]=void 0}),M.stop(),A&&(A.flags|=8,Le(B,m,g,v)),W&&ft(W,g),ft(()=>{m.isUnmounted=!0},g),g&&g.pendingBranch&&!g.isUnmounted&&m.asyncDep&&!m.asyncResolved&&m.suspenseId===g.pendingId&&(g.deps--,g.deps===0&&g.resolve())},k=(m,g,v,R=!1,M=!1,A=0)=>{for(let B=A;B<m.length;B++)Le(m[B],g,v,R,M)},y=m=>{if(m.shapeFlag&6)return y(m.component.subTree);if(m.shapeFlag&128)return m.suspense.next();const g=h(m.anchor||m.el),v=g&&g[rp];return v?h(v):g};let w=!1;const D=(m,g,v)=>{m==null?g._vnode&&Le(g._vnode,null,null,!0):C(g._vnode||null,m,g,null,null,null,v),g._vnode=m,w||(w=!0,ia(),Mu(),w=!1)},x={p:C,um:Le,m:Ke,r:z,mt:ae,mc:X,pc:fe,pbc:he,n:y,o:t};return{render:D,hydrate:void 0,createApp:wp(D)}}function Gi({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Sn({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Np(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function td(t,e,n=!1){const s=t.children,r=e.children;if(re(s)&&re(r))for(let i=0;i<s.length;i++){const o=s[i];let l=r[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=r[i]=rn(r[i]),l.el=o.el),!n&&l.patchFlag!==-2&&td(o,l)),l.type===vi&&(l.el=o.el),l.type===gn&&!l.el&&(l.el=o.el)}}function Lp(t){const e=t.slice(),n=[0];let s,r,i,o,l;const a=t.length;for(s=0;s<a;s++){const c=t[s];if(c!==0){if(r=n[n.length-1],t[r]<c){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)l=i+o>>1,t[n[l]]<c?i=l+1:o=l;c<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function nd(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:nd(e)}function da(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Op=Symbol.for("v-scx"),Mp=()=>_t(Op);function qt(t,e,n){return sd(t,e,n)}function sd(t,e,n=Ie){const{immediate:s,deep:r,flush:i,once:o}=n,l=tt({},n),a=e&&s||!e&&i!=="post";let c;if(Bs){if(i==="sync"){const f=Mp();c=f.__watcherHandles||(f.__watcherHandles=[])}else if(!a){const f=()=>{};return f.stop=Dt,f.resume=Dt,f.pause=Dt,f}}const d=et;l.call=(f,_,C)=>Ft(f,d,_,C);let u=!1;i==="post"?l.scheduler=f=>{ft(f,d&&d.suspense)}:i!=="sync"&&(u=!0,l.scheduler=(f,_)=>{_?f():cl(f)}),l.augmentJob=f=>{e&&(f.flags|=4),u&&(f.flags|=2,d&&(f.id=d.uid,f.i=d))};const h=Zf(t,e,l);return Bs&&(c?c.push(h):a&&h()),h}function Dp(t,e,n){const s=this.proxy,r=$e(t)?t.includes(".")?rd(s,t):()=>s[t]:t.bind(s,s);let i;oe(e)?i=e:(i=e.handler,n=e);const o=or(this),l=sd(r,i.bind(s),n);return o(),l}function rd(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const Fp=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${pn(e)}Modifiers`]||t[`${Cn(e)}Modifiers`];function $p(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Ie;let r=n;const i=e.startsWith("update:"),o=i&&Fp(s,e.slice(7));o&&(o.trim&&(r=n.map(d=>$e(d)?d.trim():d)),o.number&&(r=n.map(go)));let l,a=s[l=$i(e)]||s[l=$i(pn(e))];!a&&i&&(a=s[l=$i(Cn(e))]),a&&Ft(a,t,6,r);const c=s[l+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,Ft(c,t,6,r)}}function id(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},l=!1;if(!oe(t)){const a=c=>{const d=id(c,e,!0);d&&(l=!0,tt(o,d))};!n&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!i&&!l?(Ne(t)&&s.set(t,null),null):(re(i)?i.forEach(a=>o[a]=null):tt(o,i),Ne(t)&&s.set(t,o),o)}function yi(t,e){return!t||!ui(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ce(t,e[0].toLowerCase()+e.slice(1))||Ce(t,Cn(e))||Ce(t,e))}function ha(t){const{type:e,vnode:n,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:l,emit:a,render:c,renderCache:d,props:u,data:h,setupState:f,ctx:_,inheritAttrs:C}=t,S=Hr(t);let b,E;try{if(n.shapeFlag&4){const T=r||s,U=T;b=Mt(c.call(U,T,d,u,f,h,_)),E=l}else{const T=e;b=Mt(T.length>1?T(u,{attrs:l,slots:o,emit:a}):T(u,null)),E=e.props?l:Up(l)}}catch(T){Ps.length=0,mi(T,t,1),b=We(gn)}let I=b;if(E&&C!==!1){const T=Object.keys(E),{shapeFlag:U}=I;T.length&&U&7&&(i&&T.some(Xo)&&(E=Hp(E,i)),I=Yn(I,E,!1,!0))}return n.dirs&&(I=Yn(I,null,!1,!0),I.dirs=I.dirs?I.dirs.concat(n.dirs):n.dirs),n.transition&&ul(I,n.transition),b=I,Hr(S),b}const Up=t=>{let e;for(const n in t)(n==="class"||n==="style"||ui(n))&&((e||(e={}))[n]=t[n]);return e},Hp=(t,e)=>{const n={};for(const s in t)(!Xo(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function Wp(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:l,patchFlag:a}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&a>=0){if(a&1024)return!0;if(a&16)return s?fa(s,o,c):!!o;if(a&8){const d=e.dynamicProps;for(let u=0;u<d.length;u++){const h=d[u];if(o[h]!==s[h]&&!yi(c,h))return!0}}}else return(r||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?fa(s,o,c):!0:!!o;return!1}function fa(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!yi(n,i))return!0}return!1}function Bp({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const od=t=>t.__isSuspense;function Vp(t,e){e&&e.pendingBranch?re(t)?e.effects.push(...t):e.effects.push(t):np(t)}const Fe=Symbol.for("v-fgt"),vi=Symbol.for("v-txt"),gn=Symbol.for("v-cmt"),xr=Symbol.for("v-stc"),Ps=[];let gt=null;function N(t=!1){Ps.push(gt=t?null:[])}function Gp(){Ps.pop(),gt=Ps[Ps.length-1]||null}let Ws=1;function pa(t,e=!1){Ws+=t,t<0&&gt&&e&&(gt.hasOnce=!0)}function ld(t){return t.dynamicChildren=Ws>0?gt||Vn:null,Gp(),Ws>0&&gt&&gt.push(t),t}function O(t,e,n,s,r,i){return ld(p(t,e,n,s,r,i,!0))}function ad(t,e,n,s,r){return ld(We(t,e,n,s,r,!0))}function Br(t){return t?t.__v_isVNode===!0:!1}function hs(t,e){return t.type===e.type&&t.key===e.key}const cd=({key:t})=>t??null,Ar=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?$e(t)||De(t)||oe(t)?{i:mt,r:t,k:e,f:!!n}:t:null);function p(t,e=null,n=null,s=0,r=null,i=t===Fe?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&cd(e),ref:e&&Ar(e),scopeId:Fu,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:mt};return l?(fl(a,n),i&128&&t.normalize(a)):n&&(a.shapeFlag|=$e(n)?8:16),Ws>0&&!o&&gt&&(a.patchFlag>0||i&6)&&a.patchFlag!==32&&gt.push(a),a}const We=jp;function jp(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===pp)&&(t=gn),Br(t)){const l=Yn(t,e,!0);return n&&fl(l,n),Ws>0&&!i&&gt&&(l.shapeFlag&6?gt[gt.indexOf(t)]=l:gt.push(l)),l.patchFlag=-2,l}if(tm(t)&&(t=t.__vccOpts),e){e=qp(e);let{class:l,style:a}=e;l&&!$e(l)&&(e.class=Qe(l)),Ne(a)&&(ll(a)&&!re(a)&&(a=tt({},a)),e.style=nr(a))}const o=$e(t)?1:od(t)?128:ip(t)?64:Ne(t)?4:oe(t)?2:0;return p(t,e,n,s,r,o,i,!0)}function qp(t){return t?ll(t)||Yu(t)?tt({},t):t:null}function Yn(t,e,n=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:l,transition:a}=t,c=e?Kp(r||{},e):r,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&cd(c),ref:e&&e.ref?n&&i?re(i)?i.concat(Ar(e)):[i,Ar(e)]:Ar(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Fe?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:a,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Yn(t.ssContent),ssFallback:t.ssFallback&&Yn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return a&&s&&ul(d,a.clone(d)),d}function pt(t=" ",e=0){return We(vi,null,t,e)}function ma(t,e){const n=We(xr,null,t);return n.staticCount=e,n}function pe(t="",e=!1){return e?(N(),ad(gn,null,t)):We(gn,null,t)}function Mt(t){return t==null||typeof t=="boolean"?We(gn):re(t)?We(Fe,null,t.slice()):Br(t)?rn(t):We(vi,null,String(t))}function rn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Yn(t)}function fl(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(re(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),fl(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!Yu(e)?e._ctx=mt:r===3&&mt&&(mt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else oe(e)?(e={default:e,_ctx:mt},n=32):(e=String(e),s&64?(n=16,e=[pt(e)]):n=8);t.children=e,t.shapeFlag|=n}function Kp(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=Qe([e.class,s.class]));else if(r==="style")e.style=nr([e.style,s.style]);else if(ui(r)){const i=e[r],o=s[r];o&&i!==o&&!(re(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Lt(t,e,n,s=null){Ft(t,e,7,[n,s])}const zp=qu();let Yp=0;function Qp(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||zp,i={uid:Yp++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new hu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ju(s,r),emitsOptions:id(s,r),emit:null,emitted:null,propsDefaults:Ie,inheritAttrs:s.inheritAttrs,ctx:Ie,data:Ie,props:Ie,attrs:Ie,slots:Ie,refs:Ie,setupState:Ie,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=$p.bind(null,i),t.ce&&t.ce(i),i}let et=null,Vr,So;{const t=fi(),e=(n,s)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};Vr=e("__VUE_INSTANCE_SETTERS__",n=>et=n),So=e("__VUE_SSR_SETTERS__",n=>Bs=n)}const or=t=>{const e=et;return Vr(t),t.scope.on(),()=>{t.scope.off(),Vr(e)}},ga=()=>{et&&et.scope.off(),Vr(null)};function ud(t){return t.vnode.shapeFlag&4}let Bs=!1;function Jp(t,e=!1,n=!1){e&&So(e);const{props:s,children:r}=t.vnode,i=ud(t);Sp(t,s,i,e),Pp(t,r,n||e);const o=i?Xp(t,e):void 0;return e&&So(!1),o}function Xp(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,mp);const{setup:s}=n;if(s){zt();const r=t.setupContext=s.length>1?em(t):null,i=or(t),o=rr(s,t,0,[t.props,r]),l=iu(o);if(Yt(),i(),(l||t.sp)&&!Is(t)&&$u(t),l){if(o.then(ga,ga),e)return o.then(a=>{_a(t,a)}).catch(a=>{mi(a,t,0)});t.asyncDep=o}else _a(t,o)}else dd(t)}function _a(t,e,n){oe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ne(e)&&(t.setupState=Nu(e)),dd(t)}function dd(t,e,n){const s=t.type;t.render||(t.render=s.render||Dt);{const r=or(t);zt();try{gp(t)}finally{Yt(),r()}}}const Zp={get(t,e){return Ze(t,"get",""),t[e]}};function em(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Zp),slots:t.slots,emit:t.emit,expose:e}}function bi(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Nu(al(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Rs)return Rs[n](t)},has(e,n){return n in e||n in Rs}})):t.proxy}function tm(t){return oe(t)&&"__vccOpts"in t}const ee=(t,e)=>Jf(t,e,Bs);function hd(t,e,n){const s=arguments.length;return s===2?Ne(e)&&!re(e)?Br(e)?We(t,null,[e]):We(t,e):We(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Br(n)&&(n=[n]),We(t,e,n))}const nm="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let To;const ya=typeof window<"u"&&window.trustedTypes;if(ya)try{To=ya.createPolicy("vue",{createHTML:t=>t})}catch{}const fd=To?t=>To.createHTML(t):t=>t,sm="http://www.w3.org/2000/svg",rm="http://www.w3.org/1998/Math/MathML",Bt=typeof document<"u"?document:null,va=Bt&&Bt.createElement("template"),im={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e==="svg"?Bt.createElementNS(sm,t):e==="mathml"?Bt.createElementNS(rm,t):n?Bt.createElement(t,{is:n}):Bt.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Bt.createTextNode(t),createComment:t=>Bt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Bt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{va.innerHTML=fd(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=va.content;if(s==="svg"||s==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}e.insertBefore(l,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},om=Symbol("_vtc");function lm(t,e,n){const s=t[om];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const ba=Symbol("_vod"),am=Symbol("_vsh"),cm=Symbol(""),um=/(^|;)\s*display\s*:/;function dm(t,e,n){const s=t.style,r=$e(n);let i=!1;if(n&&!r){if(e)if($e(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();n[l]==null&&Nr(s,l,"")}else for(const o in e)n[o]==null&&Nr(s,o,"");for(const o in n)o==="display"&&(i=!0),Nr(s,o,n[o])}else if(r){if(e!==n){const o=s[cm];o&&(n+=";"+o),s.cssText=n,i=um.test(n)}}else e&&t.removeAttribute("style");ba in t&&(t[ba]=i?s.display:"",t[am]&&(s.display="none"))}const Ca=/\s*!important$/;function Nr(t,e,n){if(re(n))n.forEach(s=>Nr(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=hm(t,e);Ca.test(n)?t.setProperty(Cn(s),n.replace(Ca,""),"important"):t[s]=n}}const wa=["Webkit","Moz","ms"],ji={};function hm(t,e){const n=ji[e];if(n)return n;let s=pn(e);if(s!=="filter"&&s in t)return ji[e]=s;s=au(s);for(let r=0;r<wa.length;r++){const i=wa[r]+s;if(i in t)return ji[e]=i}return e}const Ea="http://www.w3.org/1999/xlink";function Sa(t,e,n,s,r,i=Ef(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ea,e.slice(6,e.length)):t.setAttributeNS(Ea,e,n):n==null||i&&!cu(n)?t.removeAttribute(e):t.setAttribute(e,i?"":bn(n)?String(n):n)}function Ta(t,e,n,s,r){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?fd(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?t.getAttribute("value")||"":t.value,a=n==null?t.type==="checkbox"?"on":"":String(n);(l!==a||!("_value"in t))&&(t.value=a),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=cu(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(r||e)}function Hn(t,e,n,s){t.addEventListener(e,n,s)}function fm(t,e,n,s){t.removeEventListener(e,n,s)}const Ia=Symbol("_vei");function pm(t,e,n,s,r=null){const i=t[Ia]||(t[Ia]={}),o=i[e];if(s&&o)o.value=s;else{const[l,a]=mm(e);if(s){const c=i[e]=ym(s,r);Hn(t,l,c,a)}else o&&(fm(t,l,o,a),i[e]=void 0)}}const Ra=/(?:Once|Passive|Capture)$/;function mm(t){let e;if(Ra.test(t)){e={};let s;for(;s=t.match(Ra);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Cn(t.slice(2)),e]}let qi=0;const gm=Promise.resolve(),_m=()=>qi||(gm.then(()=>qi=0),qi=Date.now());function ym(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;Ft(vm(s,n.value),e,5,[s])};return n.value=t,n.attached=_m(),n}function vm(t,e){if(re(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Pa=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,bm=(t,e,n,s,r,i)=>{const o=r==="svg";e==="class"?lm(t,s,o):e==="style"?dm(t,n,s):ui(e)?Xo(e)||pm(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Cm(t,e,s,o))?(Ta(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Sa(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!$e(s))?Ta(t,pn(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Sa(t,e,s,o))};function Cm(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Pa(e)&&oe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Pa(e)&&$e(n)?!1:e in t}const ka=t=>{const e=t.props["onUpdate:modelValue"]||!1;return re(e)?n=>Pr(e,n):e};function wm(t){t.target.composing=!0}function xa(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ki=Symbol("_assign"),vt={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t[Ki]=ka(r);const i=s||r.props&&r.props.type==="number";Hn(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;n&&(l=l.trim()),i&&(l=go(l)),t[Ki](l)}),n&&Hn(t,"change",()=>{t.value=t.value.trim()}),e||(Hn(t,"compositionstart",wm),Hn(t,"compositionend",xa),Hn(t,"change",xa))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:r,number:i}},o){if(t[Ki]=ka(o),t.composing)return;const l=(i||t.type==="number")&&!/^0\d/.test(t.value)?go(t.value):t.value,a=e??"";l!==a&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||r&&t.value.trim()===a)||(t.value=a))}},Em=["ctrl","shift","alt","meta"],Sm={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Em.some(n=>t[`${n}Key`]&&!e.includes(n))},pd=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(r,...i)=>{for(let o=0;o<e.length;o++){const l=Sm[e[o]];if(l&&l(r,e))return}return t(r,...i)})},Tm={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Im=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=r=>{if(!("key"in r))return;const i=Cn(r.key);if(e.some(o=>o===i||Tm[o]===i))return t(r)})},Rm=tt({patchProp:bm},im);let Aa;function Pm(){return Aa||(Aa=xp(Rm))}const km=(...t)=>{const e=Pm().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=Am(s);if(!r)return;const i=e._component;!oe(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,xm(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function xm(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Am(t){return $e(t)?document.querySelector(t):t}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let md;const Ci=t=>md=t,gd=Symbol();function Io(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var ks;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(ks||(ks={}));function Nm(){const t=fu(!0),e=t.run(()=>V({}));let n=[],s=[];const r=al({install(i){Ci(r),r._a=i,i.provide(gd,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const _d=()=>{};function Na(t,e,n,s=_d){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&pu()&&Sf(r),r}function Fn(t,...e){t.slice().forEach(n=>{n(...e)})}const Lm=t=>t(),La=Symbol(),zi=Symbol();function Ro(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];Io(r)&&Io(s)&&t.hasOwnProperty(n)&&!De(s)&&!cn(s)?t[n]=Ro(r,s):t[n]=s}return t}const Om=Symbol();function Mm(t){return!Io(t)||!Object.prototype.hasOwnProperty.call(t,Om)}const{assign:nn}=Object;function Dm(t){return!!(De(t)&&t.effect)}function Fm(t,e,n,s){const{state:r,actions:i,getters:o}=e,l=n.state.value[t];let a;function c(){l||(n.state.value[t]=r?r():{});const d=Kf(n.state.value[t]);return nn(d,i,Object.keys(o||{}).reduce((u,h)=>(u[h]=al(ee(()=>{Ci(n);const f=n._s.get(t);return o[h].call(f,f)})),u),{}))}return a=yd(t,c,e,n,s,!0),a}function yd(t,e,n={},s,r,i){let o;const l=nn({actions:{}},n),a={deep:!0};let c,d,u=[],h=[],f;const _=s.state.value[t];!i&&!_&&(s.state.value[t]={}),V({});let C;function S(X){let K;c=d=!1,typeof X=="function"?(X(s.state.value[t]),K={type:ks.patchFunction,storeId:t,events:f}):(Ro(s.state.value[t],X),K={type:ks.patchObject,payload:X,storeId:t,events:f});const he=C=Symbol();gi().then(()=>{C===he&&(c=!0)}),d=!0,Fn(u,K,s.state.value[t])}const b=i?function(){const{state:K}=n,he=K?K():{};this.$patch(ve=>{nn(ve,he)})}:_d;function E(){o.stop(),u=[],h=[],s._s.delete(t)}const I=(X,K="")=>{if(La in X)return X[zi]=K,X;const he=function(){Ci(s);const ve=Array.from(arguments),q=[],j=[];function ae(se){q.push(se)}function Be(se){j.push(se)}Fn(h,{args:ve,name:he[zi],store:U,after:ae,onError:Be});let we;try{we=X.apply(this&&this.$id===t?this:U,ve)}catch(se){throw Fn(j,se),se}return we instanceof Promise?we.then(se=>(Fn(q,se),se)).catch(se=>(Fn(j,se),Promise.reject(se))):(Fn(q,we),we)};return he[La]=!0,he[zi]=K,he},T={_p:s,$id:t,$onAction:Na.bind(null,h),$patch:S,$reset:b,$subscribe(X,K={}){const he=Na(u,X,K.detached,()=>ve()),ve=o.run(()=>qt(()=>s.state.value[t],q=>{(K.flush==="sync"?d:c)&&X({storeId:t,type:ks.direct,events:f},q)},nn({},a,K)));return he},$dispose:E},U=sr(T);s._s.set(t,U);const te=(s._a&&s._a.runWithContext||Lm)(()=>s._e.run(()=>(o=fu()).run(()=>e({action:I}))));for(const X in te){const K=te[X];if(De(K)&&!Dm(K)||cn(K))i||(_&&Mm(K)&&(De(K)?K.value=_[X]:Ro(K,_[X])),s.state.value[t][X]=K);else if(typeof K=="function"){const he=I(K,X);te[X]=he,l.actions[X]=K}}return nn(U,te),nn(_e(U),te),Object.defineProperty(U,"$state",{get:()=>s.state.value[t],set:X=>{S(K=>{nn(K,X)})}}),s._p.forEach(X=>{nn(U,o.run(()=>X({store:U,app:s._a,pinia:s,options:l})))}),_&&i&&n.hydrate&&n.hydrate(U.$state,_),c=!0,d=!0,U}/*! #__NO_SIDE_EFFECTS__ */function vd(t,e,n){let s;const r=typeof e=="function";s=r?n:e;function i(o,l){const a=Ep();return o=o||(a?_t(gd,null):null),o&&Ci(o),o=md,o._s.has(t)||(r?yd(t,e,s,o):Fm(t,s,o)),o._s.get(t)}return i.$id=t,i}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Wn=typeof document<"u";function bd(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function $m(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&bd(t.default)}const be=Object.assign;function Yi(t,e){const n={};for(const s in e){const r=e[s];n[s]=Pt(r)?r.map(t):t(r)}return n}const xs=()=>{},Pt=Array.isArray,Cd=/#/g,Um=/&/g,Hm=/\//g,Wm=/=/g,Bm=/\?/g,wd=/\+/g,Vm=/%5B/g,Gm=/%5D/g,Ed=/%5E/g,jm=/%60/g,Sd=/%7B/g,qm=/%7C/g,Td=/%7D/g,Km=/%20/g;function pl(t){return encodeURI(""+t).replace(qm,"|").replace(Vm,"[").replace(Gm,"]")}function zm(t){return pl(t).replace(Sd,"{").replace(Td,"}").replace(Ed,"^")}function Po(t){return pl(t).replace(wd,"%2B").replace(Km,"+").replace(Cd,"%23").replace(Um,"%26").replace(jm,"`").replace(Sd,"{").replace(Td,"}").replace(Ed,"^")}function Ym(t){return Po(t).replace(Wm,"%3D")}function Qm(t){return pl(t).replace(Cd,"%23").replace(Bm,"%3F")}function Jm(t){return t==null?"":Qm(t).replace(Hm,"%2F")}function Vs(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const Xm=/\/$/,Zm=t=>t.replace(Xm,"");function Qi(t,e,n="/"){let s,r={},i="",o="";const l=e.indexOf("#");let a=e.indexOf("?");return l<a&&l>=0&&(a=-1),a>-1&&(s=e.slice(0,a),i=e.slice(a+1,l>-1?l:e.length),r=t(i)),l>-1&&(s=s||e.slice(0,l),o=e.slice(l,e.length)),s=sg(s??e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:Vs(o)}}function eg(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Oa(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function tg(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&Qn(e.matched[s],n.matched[r])&&Id(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Qn(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Id(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!ng(t[n],e[n]))return!1;return!0}function ng(t,e){return Pt(t)?Ma(t,e):Pt(e)?Ma(e,t):t===e}function Ma(t,e){return Pt(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function sg(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=n.length-1,o,l;for(o=0;o<s.length;o++)if(l=s[o],l!==".")if(l==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const tn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Gs;(function(t){t.pop="pop",t.push="push"})(Gs||(Gs={}));var As;(function(t){t.back="back",t.forward="forward",t.unknown=""})(As||(As={}));function rg(t){if(!t)if(Wn){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Zm(t)}const ig=/^[^#]+#/;function og(t,e){return t.replace(ig,"#")+e}function lg(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const wi=()=>({left:window.scrollX,top:window.scrollY});function ag(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=lg(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Da(t,e){return(history.state?history.state.position-e:-1)+t}const ko=new Map;function cg(t,e){ko.set(t,e)}function ug(t){const e=ko.get(t);return ko.delete(t),e}let dg=()=>location.protocol+"//"+location.host;function Rd(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let l=r.includes(t.slice(i))?t.slice(i).length:1,a=r.slice(l);return a[0]!=="/"&&(a="/"+a),Oa(a,"")}return Oa(n,t)+s+r}function hg(t,e,n,s){let r=[],i=[],o=null;const l=({state:h})=>{const f=Rd(t,location),_=n.value,C=e.value;let S=0;if(h){if(n.value=f,e.value=h,o&&o===_){o=null;return}S=C?h.position-C.position:0}else s(f);r.forEach(b=>{b(n.value,_,{delta:S,type:Gs.pop,direction:S?S>0?As.forward:As.back:As.unknown})})};function a(){o=n.value}function c(h){r.push(h);const f=()=>{const _=r.indexOf(h);_>-1&&r.splice(_,1)};return i.push(f),f}function d(){const{history:h}=window;h.state&&h.replaceState(be({},h.state,{scroll:wi()}),"")}function u(){for(const h of i)h();i=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:a,listen:c,destroy:u}}function Fa(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?wi():null}}function fg(t){const{history:e,location:n}=window,s={value:Rd(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(a,c,d){const u=t.indexOf("#"),h=u>-1?(n.host&&document.querySelector("base")?t:t.slice(u))+a:dg()+t+a;try{e[d?"replaceState":"pushState"](c,"",h),r.value=c}catch(f){console.error(f),n[d?"replace":"assign"](h)}}function o(a,c){const d=be({},e.state,Fa(r.value.back,a,r.value.forward,!0),c,{position:r.value.position});i(a,d,!0),s.value=a}function l(a,c){const d=be({},r.value,e.state,{forward:a,scroll:wi()});i(d.current,d,!0);const u=be({},Fa(s.value,a,null),{position:d.position+1},c);i(a,u,!1),s.value=a}return{location:s,state:r,push:l,replace:o}}function pg(t){t=rg(t);const e=fg(t),n=hg(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=be({location:"",base:t,go:s,createHref:og.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function mg(t){return typeof t=="string"||t&&typeof t=="object"}function Pd(t){return typeof t=="string"||typeof t=="symbol"}const kd=Symbol("");var $a;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})($a||($a={}));function Jn(t,e){return be(new Error,{type:t,[kd]:!0},e)}function Ht(t,e){return t instanceof Error&&kd in t&&(e==null||!!(t.type&e))}const Ua="[^/]+?",gg={sensitive:!1,strict:!1,start:!0,end:!0},_g=/[.+*?^${}()[\]/\\]/g;function yg(t,e){const n=be({},gg,e),s=[];let r=n.start?"^":"";const i=[];for(const c of t){const d=c.length?[]:[90];n.strict&&!c.length&&(r+="/");for(let u=0;u<c.length;u++){const h=c[u];let f=40+(n.sensitive?.25:0);if(h.type===0)u||(r+="/"),r+=h.value.replace(_g,"\\$&"),f+=40;else if(h.type===1){const{value:_,repeatable:C,optional:S,regexp:b}=h;i.push({name:_,repeatable:C,optional:S});const E=b||Ua;if(E!==Ua){f+=10;try{new RegExp(`(${E})`)}catch(T){throw new Error(`Invalid custom RegExp for param "${_}" (${E}): `+T.message)}}let I=C?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;u||(I=S&&c.length<2?`(?:/${I})`:"/"+I),S&&(I+="?"),r+=I,f+=20,S&&(f+=-8),C&&(f+=-20),E===".*"&&(f+=-50)}d.push(f)}s.push(d)}if(n.strict&&n.end){const c=s.length-1;s[c][s[c].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function l(c){const d=c.match(o),u={};if(!d)return null;for(let h=1;h<d.length;h++){const f=d[h]||"",_=i[h-1];u[_.name]=f&&_.repeatable?f.split("/"):f}return u}function a(c){let d="",u=!1;for(const h of t){(!u||!d.endsWith("/"))&&(d+="/"),u=!1;for(const f of h)if(f.type===0)d+=f.value;else if(f.type===1){const{value:_,repeatable:C,optional:S}=f,b=_ in c?c[_]:"";if(Pt(b)&&!C)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const E=Pt(b)?b.join("/"):b;if(!E)if(S)h.length<2&&(d.endsWith("/")?d=d.slice(0,-1):u=!0);else throw new Error(`Missing required param "${_}"`);d+=E}}return d||"/"}return{re:o,score:s,keys:i,parse:l,stringify:a}}function vg(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function xd(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=vg(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(Ha(s))return 1;if(Ha(r))return-1}return r.length-s.length}function Ha(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const bg={type:0,value:""},Cg=/[a-zA-Z0-9_]/;function wg(t){if(!t)return[[]];if(t==="/")return[[bg]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${c}": ${f}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let l=0,a,c="",d="";function u(){c&&(n===0?i.push({type:0,value:c}):n===1||n===2||n===3?(i.length>1&&(a==="*"||a==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:d,repeatable:a==="*"||a==="+",optional:a==="*"||a==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=a}for(;l<t.length;){if(a=t[l++],a==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:a==="/"?(c&&u(),o()):a===":"?(u(),n=1):h();break;case 4:h(),n=s;break;case 1:a==="("?n=2:Cg.test(a)?h():(u(),n=0,a!=="*"&&a!=="?"&&a!=="+"&&l--);break;case 2:a===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+a:n=3:d+=a;break;case 3:u(),n=0,a!=="*"&&a!=="?"&&a!=="+"&&l--,d="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),u(),o(),r}function Eg(t,e,n){const s=yg(wg(t.path),n),r=be(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function Sg(t,e){const n=[],s=new Map;e=Ga({strict:!1,end:!0,sensitive:!1},e);function r(u){return s.get(u)}function i(u,h,f){const _=!f,C=Ba(u);C.aliasOf=f&&f.record;const S=Ga(e,u),b=[C];if("alias"in u){const T=typeof u.alias=="string"?[u.alias]:u.alias;for(const U of T)b.push(Ba(be({},C,{components:f?f.record.components:C.components,path:U,aliasOf:f?f.record:C})))}let E,I;for(const T of b){const{path:U}=T;if(h&&U[0]!=="/"){const Z=h.record.path,te=Z[Z.length-1]==="/"?"":"/";T.path=h.record.path+(U&&te+U)}if(E=Eg(T,h,S),f?f.alias.push(E):(I=I||E,I!==E&&I.alias.push(E),_&&u.name&&!Va(E)&&o(u.name)),Ad(E)&&a(E),C.children){const Z=C.children;for(let te=0;te<Z.length;te++)i(Z[te],E,f&&f.children[te])}f=f||E}return I?()=>{o(I)}:xs}function o(u){if(Pd(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function l(){return n}function a(u){const h=Rg(u,n);n.splice(h,0,u),u.record.name&&!Va(u)&&s.set(u.record.name,u)}function c(u,h){let f,_={},C,S;if("name"in u&&u.name){if(f=s.get(u.name),!f)throw Jn(1,{location:u});S=f.record.name,_=be(Wa(h.params,f.keys.filter(I=>!I.optional).concat(f.parent?f.parent.keys.filter(I=>I.optional):[]).map(I=>I.name)),u.params&&Wa(u.params,f.keys.map(I=>I.name))),C=f.stringify(_)}else if(u.path!=null)C=u.path,f=n.find(I=>I.re.test(C)),f&&(_=f.parse(C),S=f.record.name);else{if(f=h.name?s.get(h.name):n.find(I=>I.re.test(h.path)),!f)throw Jn(1,{location:u,currentLocation:h});S=f.record.name,_=be({},h.params,u.params),C=f.stringify(_)}const b=[];let E=f;for(;E;)b.unshift(E.record),E=E.parent;return{name:S,path:C,params:_,matched:b,meta:Ig(b)}}t.forEach(u=>i(u));function d(){n.length=0,s.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:d,getRoutes:l,getRecordMatcher:r}}function Wa(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function Ba(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:Tg(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Tg(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function Va(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Ig(t){return t.reduce((e,n)=>be(e,n.meta),{})}function Ga(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function Rg(t,e){let n=0,s=e.length;for(;n!==s;){const i=n+s>>1;xd(t,e[i])<0?s=i:n=i+1}const r=Pg(t);return r&&(s=e.lastIndexOf(r,s-1)),s}function Pg(t){let e=t;for(;e=e.parent;)if(Ad(e)&&xd(t,e)===0)return e}function Ad({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function kg(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(wd," "),o=i.indexOf("="),l=Vs(o<0?i:i.slice(0,o)),a=o<0?null:Vs(i.slice(o+1));if(l in e){let c=e[l];Pt(c)||(c=e[l]=[c]),c.push(a)}else e[l]=a}return e}function ja(t){let e="";for(let n in t){const s=t[n];if(n=Ym(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Pt(s)?s.map(i=>i&&Po(i)):[s&&Po(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function xg(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Pt(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const Nd=Symbol(""),qa=Symbol(""),Ei=Symbol(""),ml=Symbol(""),xo=Symbol("");function fs(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ag(t,e,n){const s=()=>{t[e].delete(n)};ir(s),Wu(s),Hu(()=>{t[e].add(n)}),t[e].add(n)}function Ld(t){const e=_t(Nd,{}).value;e&&Ag(e,"leaveGuards",t)}function on(t,e,n,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((l,a)=>{const c=h=>{h===!1?a(Jn(4,{from:n,to:e})):h instanceof Error?a(h):mg(h)?a(Jn(2,{from:e,to:h})):(o&&s.enterCallbacks[r]===o&&typeof h=="function"&&o.push(h),l())},d=i(()=>t.call(s&&s.instances[r],e,n,c));let u=Promise.resolve(d);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Ji(t,e,n,s,r=i=>i()){const i=[];for(const o of t)for(const l in o.components){let a=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(bd(a)){const d=(a.__vccOpts||a)[e];d&&i.push(on(d,n,s,o,l,r))}else{let c=a();i.push(()=>c.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const u=$m(d)?d.default:d;o.mods[l]=d,o.components[l]=u;const f=(u.__vccOpts||u)[e];return f&&on(f,n,s,o,l,r)()}))}}return i}function Ka(t){const e=_t(Ei),n=_t(ml),s=ee(()=>{const a=L(t.to);return e.resolve(a)}),r=ee(()=>{const{matched:a}=s.value,{length:c}=a,d=a[c-1],u=n.matched;if(!d||!u.length)return-1;const h=u.findIndex(Qn.bind(null,d));if(h>-1)return h;const f=za(a[c-2]);return c>1&&za(d)===f&&u[u.length-1].path!==f?u.findIndex(Qn.bind(null,a[c-2])):h}),i=ee(()=>r.value>-1&&Dg(n.params,s.value.params)),o=ee(()=>r.value>-1&&r.value===n.matched.length-1&&Id(n.params,s.value.params));function l(a={}){if(Mg(a)){const c=e[L(t.replace)?"replace":"push"](L(t.to)).catch(xs);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:s,href:ee(()=>s.value.href),isActive:i,isExactActive:o,navigate:l}}function Ng(t){return t.length===1?t[0]:t}const Lg=ut({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ka,setup(t,{slots:e}){const n=sr(Ka(t)),{options:s}=_t(Ei),r=ee(()=>({[Ya(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Ya(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&Ng(e.default(n));return t.custom?i:hd("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),Og=Lg;function Mg(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Dg(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Pt(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function za(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Ya=(t,e,n)=>t??e??n,Fg=ut({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=_t(xo),r=ee(()=>t.route||s.value),i=_t(qa,0),o=ee(()=>{let c=L(i);const{matched:d}=r.value;let u;for(;(u=d[c])&&!u.components;)c++;return c}),l=ee(()=>r.value.matched[o.value]);kr(qa,ee(()=>o.value+1)),kr(Nd,l),kr(xo,r);const a=V();return qt(()=>[a.value,l.value,t.name],([c,d,u],[h,f,_])=>{d&&(d.instances[u]=c,f&&f!==d&&c&&c===h&&(d.leaveGuards.size||(d.leaveGuards=f.leaveGuards),d.updateGuards.size||(d.updateGuards=f.updateGuards))),c&&d&&(!f||!Qn(d,f)||!h)&&(d.enterCallbacks[u]||[]).forEach(C=>C(c))},{flush:"post"}),()=>{const c=r.value,d=t.name,u=l.value,h=u&&u.components[d];if(!h)return Qa(n.default,{Component:h,route:c});const f=u.props[d],_=f?f===!0?c.params:typeof f=="function"?f(c):f:null,S=hd(h,be({},_,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(u.instances[d]=null)},ref:a}));return Qa(n.default,{Component:S,route:c})||S}}});function Qa(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Od=Fg;function $g(t){const e=Sg(t.routes,t),n=t.parseQuery||kg,s=t.stringifyQuery||ja,r=t.history,i=fs(),o=fs(),l=fs(),a=Gf(tn);let c=tn;Wn&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Yi.bind(null,y=>""+y),u=Yi.bind(null,Jm),h=Yi.bind(null,Vs);function f(y,w){let D,x;return Pd(y)?(D=e.getRecordMatcher(y),x=w):x=y,e.addRoute(x,D)}function _(y){const w=e.getRecordMatcher(y);w&&e.removeRoute(w)}function C(){return e.getRoutes().map(y=>y.record)}function S(y){return!!e.getRecordMatcher(y)}function b(y,w){if(w=be({},w||a.value),typeof y=="string"){const v=Qi(n,y,w.path),R=e.resolve({path:v.path},w),M=r.createHref(v.fullPath);return be(v,R,{params:h(R.params),hash:Vs(v.hash),redirectedFrom:void 0,href:M})}let D;if(y.path!=null)D=be({},y,{path:Qi(n,y.path,w.path).path});else{const v=be({},y.params);for(const R in v)v[R]==null&&delete v[R];D=be({},y,{params:u(v)}),w.params=u(w.params)}const x=e.resolve(D,w),Y=y.hash||"";x.params=d(h(x.params));const m=eg(s,be({},y,{hash:zm(Y),path:x.path})),g=r.createHref(m);return be({fullPath:m,hash:Y,query:s===ja?xg(y.query):y.query||{}},x,{redirectedFrom:void 0,href:g})}function E(y){return typeof y=="string"?Qi(n,y,a.value.path):be({},y)}function I(y,w){if(c!==y)return Jn(8,{from:w,to:y})}function T(y){return te(y)}function U(y){return T(be(E(y),{replace:!0}))}function Z(y){const w=y.matched[y.matched.length-1];if(w&&w.redirect){const{redirect:D}=w;let x=typeof D=="function"?D(y):D;return typeof x=="string"&&(x=x.includes("?")||x.includes("#")?x=E(x):{path:x},x.params={}),be({query:y.query,hash:y.hash,params:x.path!=null?{}:y.params},x)}}function te(y,w){const D=c=b(y),x=a.value,Y=y.state,m=y.force,g=y.replace===!0,v=Z(D);if(v)return te(be(E(v),{state:typeof v=="object"?be({},Y,v.state):Y,force:m,replace:g}),w||D);const R=D;R.redirectedFrom=w;let M;return!m&&tg(s,x,D)&&(M=Jn(16,{to:R,from:x}),Ke(x,x,!0,!1)),(M?Promise.resolve(M):he(R,x)).catch(A=>Ht(A)?Ht(A,2)?A:dt(A):fe(A,R,x)).then(A=>{if(A){if(Ht(A,2))return te(be({replace:g},E(A.to),{state:typeof A.to=="object"?be({},Y,A.to.state):Y,force:m}),w||R)}else A=q(R,x,!0,g,Y);return ve(R,x,A),A})}function X(y,w){const D=I(y,w);return D?Promise.reject(D):Promise.resolve()}function K(y){const w=le.values().next().value;return w&&typeof w.runWithContext=="function"?w.runWithContext(y):y()}function he(y,w){let D;const[x,Y,m]=Ug(y,w);D=Ji(x.reverse(),"beforeRouteLeave",y,w);for(const v of x)v.leaveGuards.forEach(R=>{D.push(on(R,y,w))});const g=X.bind(null,y,w);return D.push(g),k(D).then(()=>{D=[];for(const v of i.list())D.push(on(v,y,w));return D.push(g),k(D)}).then(()=>{D=Ji(Y,"beforeRouteUpdate",y,w);for(const v of Y)v.updateGuards.forEach(R=>{D.push(on(R,y,w))});return D.push(g),k(D)}).then(()=>{D=[];for(const v of m)if(v.beforeEnter)if(Pt(v.beforeEnter))for(const R of v.beforeEnter)D.push(on(R,y,w));else D.push(on(v.beforeEnter,y,w));return D.push(g),k(D)}).then(()=>(y.matched.forEach(v=>v.enterCallbacks={}),D=Ji(m,"beforeRouteEnter",y,w,K),D.push(g),k(D))).then(()=>{D=[];for(const v of o.list())D.push(on(v,y,w));return D.push(g),k(D)}).catch(v=>Ht(v,8)?v:Promise.reject(v))}function ve(y,w,D){l.list().forEach(x=>K(()=>x(y,w,D)))}function q(y,w,D,x,Y){const m=I(y,w);if(m)return m;const g=w===tn,v=Wn?history.state:{};D&&(x||g?r.replace(y.fullPath,be({scroll:g&&v&&v.scroll},Y)):r.push(y.fullPath,Y)),a.value=y,Ke(y,w,D,g),dt()}let j;function ae(){j||(j=r.listen((y,w,D)=>{if(!Te.listening)return;const x=b(y),Y=Z(x);if(Y){te(be(Y,{replace:!0,force:!0}),x).catch(xs);return}c=x;const m=a.value;Wn&&cg(Da(m.fullPath,D.delta),wi()),he(x,m).catch(g=>Ht(g,12)?g:Ht(g,2)?(te(be(E(g.to),{force:!0}),x).then(v=>{Ht(v,20)&&!D.delta&&D.type===Gs.pop&&r.go(-1,!1)}).catch(xs),Promise.reject()):(D.delta&&r.go(-D.delta,!1),fe(g,x,m))).then(g=>{g=g||q(x,m,!1),g&&(D.delta&&!Ht(g,8)?r.go(-D.delta,!1):D.type===Gs.pop&&Ht(g,20)&&r.go(-1,!1)),ve(x,m,g)}).catch(xs)}))}let Be=fs(),we=fs(),se;function fe(y,w,D){dt(y);const x=we.list();return x.length?x.forEach(Y=>Y(y,w,D)):console.error(y),Promise.reject(y)}function ot(){return se&&a.value!==tn?Promise.resolve():new Promise((y,w)=>{Be.add([y,w])})}function dt(y){return se||(se=!y,ae(),Be.list().forEach(([w,D])=>y?D(y):w()),Be.reset()),y}function Ke(y,w,D,x){const{scrollBehavior:Y}=t;if(!Wn||!Y)return Promise.resolve();const m=!D&&ug(Da(y.fullPath,0))||(x||!D)&&history.state&&history.state.scroll||null;return gi().then(()=>Y(y,w,m)).then(g=>g&&ag(g)).catch(g=>fe(g,y,w))}const Le=y=>r.go(y);let z;const le=new Set,Te={currentRoute:a,listening:!0,addRoute:f,removeRoute:_,clearRoutes:e.clearRoutes,hasRoute:S,getRoutes:C,resolve:b,options:t,push:T,replace:U,go:Le,back:()=>Le(-1),forward:()=>Le(1),beforeEach:i.add,beforeResolve:o.add,afterEach:l.add,onError:we.add,isReady:ot,install(y){const w=this;y.component("RouterLink",Og),y.component("RouterView",Od),y.config.globalProperties.$router=w,Object.defineProperty(y.config.globalProperties,"$route",{enumerable:!0,get:()=>L(a)}),Wn&&!z&&a.value===tn&&(z=!0,T(r.location).catch(Y=>{}));const D={};for(const Y in tn)Object.defineProperty(D,Y,{get:()=>a.value[Y],enumerable:!0});y.provide(Ei,w),y.provide(ml,ku(D)),y.provide(xo,a);const x=y.unmount;le.add(y),y.unmount=function(){le.delete(y),le.size<1&&(c=tn,j&&j(),j=null,a.value=tn,z=!1,se=!1),x()}}};function k(y){return y.reduce((w,D)=>w.then(()=>K(D)),Promise.resolve())}return Te}function Ug(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const l=e.matched[o];l&&(t.matched.find(c=>Qn(c,l))?s.push(l):n.push(l));const a=t.matched[o];a&&(e.matched.find(c=>Qn(c,a))||r.push(a))}return[n,s,r]}function Zt(){return _t(Ei)}function Si(t){return _t(ml)}const Hg=ut({__name:"App",setup(t){return(e,n)=>(N(),ad(L(Od)))}}),Wg="modulepreload",Bg=function(t){return"/HeardleTournament/"+t},Ja={},Vg=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};var o=c;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=l?.nonce||l?.getAttribute("nonce");r=c(n.map(d=>{if(d=Bg(d),d in Ja)return;Ja[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Wg,u||(f.as="script"),f.crossOrigin="",f.href=d,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((_,C)=>{f.addEventListener("load",_),f.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return r.then(l=>{for(const a of l||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};class Gg{currentLobby=null;currentPlayerId=null;lobbies=new Map;constructor(){this.currentPlayerId=this.generatePlayerId(),this.loadLobbiesFromStorage()}generatePlayerId(){return"player_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36)}generateLobbyCode(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let s=0;s<6;s++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}loadLobbiesFromStorage(){try{const e=localStorage.getItem("heardle_lobbies");if(e){const n=JSON.parse(e);this.lobbies=new Map(Object.entries(n)),console.log("Loaded lobbies from storage:",Array.from(this.lobbies.keys()));const s=Date.now()-3600*1e3;let r=0;for(const[i,o]of this.lobbies.entries())o.createdAt<s&&(this.lobbies.delete(i),r++);r>0&&(console.log(`Cleaned up ${r} old lobbies`),this.saveLobbiesStorage())}}catch{console.warn("Could not load lobbies from storage")}}saveLobbiesStorage(){try{const e=Object.fromEntries(this.lobbies.entries());localStorage.setItem("heardle_lobbies",JSON.stringify(e)),console.log("Saved lobbies to storage:",Array.from(this.lobbies.keys()))}catch{console.warn("Could not save lobbies to storage")}}reloadLobbiesFromStorage(){this.loadLobbiesFromStorage()}async createLobby(e){try{await new Promise(r=>setTimeout(r,1e3));let n=this.generateLobbyCode();for(;this.lobbies.has(n);)n=this.generateLobbyCode();const s={id:n,hostId:this.currentPlayerId,hostName:e,players:{[this.currentPlayerId]:{id:this.currentPlayerId,name:e,isHost:!0,isReady:!1,joinedAt:Date.now()}},gameSettings:{totalRounds:5,playlistUrl:"",tournamentName:`${e}'s Tournament`},status:"waiting",createdAt:Date.now(),maxPlayers:8};return this.lobbies.set(n,s),this.saveLobbiesStorage(),this.currentLobby=s,{success:!0,lobbyCode:n}}catch{return{success:!1,error:"Failed to create lobby"}}}async joinLobby(e,n){try{await new Promise(i=>setTimeout(i,800)),this.reloadLobbiesFromStorage(),console.log("Attempting to join lobby:",e),console.log("Available lobbies:",Array.from(this.lobbies.keys()));const s=this.lobbies.get(e);if(!s)return console.log("Lobby not found in available lobbies"),{success:!1,error:"Lobby not found"};if(console.log("Found lobby:",s),s.status!=="waiting")return{success:!1,error:"Game already in progress"};if(Object.keys(s.players).length>=s.maxPlayers)return{success:!1,error:"Lobby is full"};const r={id:this.currentPlayerId,name:n,isHost:!1,isReady:!1,joinedAt:Date.now()};return s.players[this.currentPlayerId]=r,this.lobbies.set(e,s),this.saveLobbiesStorage(),this.currentLobby=s,console.log("Successfully joined lobby"),{success:!0,lobby:s}}catch{return{success:!1,error:"Failed to join lobby"}}}async leaveLobby(){if(!(!this.currentLobby||!this.currentPlayerId))try{const e=this.currentLobby;delete e.players[this.currentPlayerId],e.hostId===this.currentPlayerId||Object.keys(e.players).length===0?this.lobbies.delete(e.id):this.lobbies.set(e.id,e),this.saveLobbiesStorage(),this.currentLobby=null}catch{console.error("Error leaving lobby")}}getCurrentLobby(){return this.currentLobby}refreshCurrentLobby(){if(this.currentLobby){const e=this.getLobby(this.currentLobby.id);return e&&(this.currentLobby=e),e}return null}getCurrentPlayerId(){return this.currentPlayerId}getLobby(e){return this.reloadLobbiesFromStorage(),this.lobbies.get(e)||null}getAllLobbies(){return this.reloadLobbiesFromStorage(),Array.from(this.lobbies.values())}debugLobbies(){this.reloadLobbiesFromStorage(),console.log("Current lobbies in storage:");for(const[e,n]of this.lobbies.entries())console.log(`- ${e}: ${n.hostName}'s lobby (${Object.keys(n.players).length} players)`)}updateLobby(e){this.lobbies.set(e.id,e),this.saveLobbiesStorage(),this.currentLobby?.id===e.id&&(this.currentLobby=e)}async updateGameSettings(e){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};if(this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can change settings"};try{await new Promise(r=>setTimeout(r,300));const n=this.getLobby(this.currentLobby.id);if(!n)return{success:!1,error:"Lobby not found"};console.log("updateGameSettings - players before update:",Object.keys(n.players));const s={...n.gameSettings,...e};return n.gameSettings=s,this.currentLobby=n,this.lobbies.set(n.id,n),this.saveLobbiesStorage(),console.log("updateGameSettings - players after update:",Object.keys(n.players)),console.log("Host updated game settings:",s),{success:!0}}catch{return{success:!1,error:"Failed to update settings"}}}getPlaylistOptions(){return[{value:"",label:"Default Playlist"},{value:"pop-hits",label:"Pop Hits"},{value:"rock-classics",label:"Rock Classics"},{value:"80s-90s",label:"80s & 90s"},{value:"indie-alternative",label:"Indie & Alternative"},{value:"hip-hop-rap",label:"Hip-Hop & Rap"},{value:"electronic-dance",label:"Electronic & Dance"},{value:"country",label:"Country"},{value:"r-b-soul",label:"R&B & Soul"},{value:"custom",label:"Custom Playlist URL"}]}cleanupOldLobbies(){const n=Date.now()-3600*1e3;for(const[s,r]of this.lobbies.entries())r.createdAt<n&&this.lobbies.delete(s);this.saveLobbiesStorage()}async startGame(){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};if(this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can start game"};try{const e=this.getLobby(this.currentLobby.id);if(!e)return{success:!1,error:"Lobby not found"};if(!Object.values(e.players).every(r=>r.isReady||r.isHost))return{success:!1,error:"Not all players are ready"};const s={currentRound:1,currentTrack:null,currentAttempt:0,maxAttempts:6,clipDurations:[1,2,4,7,11,16],currentClipDuration:1,isRoundActive:!1,roundStartTime:0,roundEndTime:null,playersReady:{},playerGuesses:{}};return Object.keys(e.players).forEach(r=>{s.playersReady[r]=!1,s.playerGuesses[r]={attempts:[],hasWon:!1,hasLost:!1,roundScore:0,totalScore:0,roundsWon:0}}),e.status="playing",e.gameState=s,this.currentLobby=e,this.lobbies.set(e.id,e),this.saveLobbiesStorage(),{success:!0}}catch{return{success:!1,error:"Failed to start game"}}}async updatePlayerReady(e){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};try{const n=this.getLobby(this.currentLobby.id);return n?n.players[this.currentPlayerId]?(n.players[this.currentPlayerId].isReady=e,this.currentLobby=n,this.lobbies.set(n.id,n),this.saveLobbiesStorage(),{success:!0}):{success:!1,error:"Player not found"}:{success:!1,error:"Lobby not found"}}catch{return{success:!1,error:"Failed to update ready status"}}}async submitGuess(e,n){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};try{const s=this.getLobby(this.currentLobby.id);if(!s||!s.gameState)return{success:!1,error:"No active game"};const r=s.gameState,i=r.playerGuesses[this.currentPlayerId];if(!i)return{success:!1,error:"Player not found in game"};if(i.attempts.push({guess:e,isCorrect:n,timestamp:Date.now()}),n){i.hasWon=!0;const o=i.attempts.length,l=1e3,a=Math.max(1,7-o);i.roundScore=l*a,i.totalScore+=i.roundScore}else i.attempts.length>=r.maxAttempts&&(i.hasLost=!0,i.roundScore=0);return this.currentLobby=s,this.lobbies.set(s.id,s),this.saveLobbiesStorage(),{success:!0}}catch{return{success:!1,error:"Failed to submit guess"}}}async updateGameState(e){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};if(this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can update game state"};try{const n=this.getLobby(this.currentLobby.id);return!n||!n.gameState?{success:!1,error:"No active game"}:(Object.assign(n.gameState,e),this.currentLobby=n,this.lobbies.set(n.id,n),this.saveLobbiesStorage(),{success:!0})}catch{return{success:!1,error:"Failed to update game state"}}}async finishTournament(){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};if(this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can finish tournament"};try{const e=this.getLobby(this.currentLobby.id);return e?(e.status="finished",this.currentLobby=e,this.lobbies.set(e.id,e),this.saveLobbiesStorage(),{success:!0}):{success:!1,error:"Lobby not found"}}catch{return{success:!1,error:"Failed to finish tournament"}}}async resetLobby(){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby"};if(this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can reset lobby"};try{const e=this.getLobby(this.currentLobby.id);return e?(e.status="waiting",e.gameState=void 0,Object.keys(e.players).forEach(n=>{e.players[n].isHost||(e.players[n].isReady=!1)}),this.currentLobby=e,this.lobbies.set(e.id,e),this.saveLobbiesStorage(),{success:!0}):{success:!1,error:"Lobby not found"}}catch{return{success:!1,error:"Failed to reset lobby"}}}}const Md=new Gg,jg=Object.freeze(Object.defineProperty({__proto__:null,lobbyService:Md},Symbol.toStringTag,{value:"Module"})),qg={class:"home"},Kg=ut({__name:"HomeVue",setup(t){const e=Zt(),n=()=>{Md.leaveLobby(),e.push("/config")},s=()=>{e.push("/multiplayer")};return(r,i)=>(N(),O("div",qg,[i[3]||(i[3]=p("h1",{style:{"text-align":"center"}},"Heardle Tournament",-1)),p("div",{class:"menu-container"},[i[2]||(i[2]=p("h2",null,"Choose Game Mode",-1)),p("div",{class:"menu-buttons"},[p("button",{class:"menu-button singleplayer-btn",onClick:n},i[0]||(i[0]=[p("div",{class:"button-icon"},"🎵",-1),p("div",{class:"button-text"},[p("h3",null,"Single Player"),p("p",null,"Play solo and test your music knowledge")],-1)])),p("button",{class:"menu-button multiplayer-btn",onClick:s},i[1]||(i[1]=[p("div",{class:"button-icon"},"👥",-1),p("div",{class:"button-text"},[p("h3",null,"Multiplayer"),p("p",null,"Play with friends online!")],-1)]))])])]))}}),kt=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n},zg=kt(Kg,[["__scopeId","data-v-458f4600"]]);function Yg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yr={exports:{}},Xi,Xa;function Qg(){if(Xa)return Xi;Xa=1;var t;/**
* @link https://github.com/gajus/sister for the canonical source repository
* @license https://github.com/gajus/sister/blob/master/LICENSE BSD 3-Clause
*/return t=function(){var e={},n={};return e.on=function(s,r){var i={name:s,handler:r};return n[s]=n[s]||[],n[s].unshift(i),i},e.off=function(s){var r=n[s.name].indexOf(s);r!==-1&&n[s.name].splice(r,1)},e.trigger=function(s,r){var i=n[s],o;if(i)for(o=i.length;o--;)i[o].handler(r)},e},Xi=t,Xi}var vr={exports:{}},br={exports:{}},Zi,Za;function Jg(){if(Za)return Zi;Za=1;var t=1e3,e=t*60,n=e*60,s=n*24,r=s*7,i=s*365.25;Zi=function(d,u){u=u||{};var h=typeof d;if(h==="string"&&d.length>0)return o(d);if(h==="number"&&isFinite(d))return u.long?a(d):l(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(u){var h=parseFloat(u[1]),f=(u[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return h*i;case"weeks":case"week":case"w":return h*r;case"days":case"day":case"d":return h*s;case"hours":case"hour":case"hrs":case"hr":case"h":return h*n;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function l(d){var u=Math.abs(d);return u>=s?Math.round(d/s)+"d":u>=n?Math.round(d/n)+"h":u>=e?Math.round(d/e)+"m":u>=t?Math.round(d/t)+"s":d+"ms"}function a(d){var u=Math.abs(d);return u>=s?c(d,u,s,"day"):u>=n?c(d,u,n,"hour"):u>=e?c(d,u,e,"minute"):u>=t?c(d,u,t,"second"):d+" ms"}function c(d,u,h,f){var _=u>=h*1.5;return Math.round(d/h)+" "+f+(_?"s":"")}return Zi}var eo,ec;function Xg(){if(ec)return eo;ec=1;function t(e){s.debug=s,s.default=s,s.coerce=c,s.disable=l,s.enable=i,s.enabled=a,s.humanize=Jg(),s.destroy=d,Object.keys(e).forEach(u=>{s[u]=e[u]}),s.names=[],s.skips=[],s.formatters={};function n(u){let h=0;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h|=0;return s.colors[Math.abs(h)%s.colors.length]}s.selectColor=n;function s(u){let h,f=null,_,C;function S(...b){if(!S.enabled)return;const E=S,I=Number(new Date),T=I-(h||I);E.diff=T,E.prev=h,E.curr=I,h=I,b[0]=s.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let U=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(te,X)=>{if(te==="%%")return"%";U++;const K=s.formatters[X];if(typeof K=="function"){const he=b[U];te=K.call(E,he),b.splice(U,1),U--}return te}),s.formatArgs.call(E,b),(E.log||s.log).apply(E,b)}return S.namespace=u,S.useColors=s.useColors(),S.color=s.selectColor(u),S.extend=r,S.destroy=s.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(_!==s.namespaces&&(_=s.namespaces,C=s.enabled(u)),C),set:b=>{f=b}}),typeof s.init=="function"&&s.init(S),S}function r(u,h){const f=s(this.namespace+(typeof h>"u"?":":h)+u);return f.log=this.log,f}function i(u){s.save(u),s.namespaces=u,s.names=[],s.skips=[];const h=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const f of h)f[0]==="-"?s.skips.push(f.slice(1)):s.names.push(f)}function o(u,h){let f=0,_=0,C=-1,S=0;for(;f<u.length;)if(_<h.length&&(h[_]===u[f]||h[_]==="*"))h[_]==="*"?(C=_,S=f,_++):(f++,_++);else if(C!==-1)_=C+1,S++,f=S;else return!1;for(;_<h.length&&h[_]==="*";)_++;return _===h.length}function l(){const u=[...s.names,...s.skips.map(h=>"-"+h)].join(",");return s.enable(""),u}function a(u){for(const h of s.skips)if(o(u,h))return!1;for(const h of s.names)if(o(u,h))return!0;return!1}function c(u){return u instanceof Error?u.stack||u.message:u}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s.enable(s.load()),s}return eo=t,eo}var tc;function Zg(){return tc||(tc=1,function(t,e){var n={};e.formatArgs=r,e.save=i,e.load=o,e.useColors=s,e.storage=l(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function s(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let c;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(c=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(c[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;c.splice(1,0,d,"color: inherit");let u=0,h=0;c[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(u++,f==="%c"&&(h=u))}),c.splice(h,0,d)}e.log=console.debug||console.log||(()=>{});function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function o(){let c;try{c=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=n.DEBUG),c}function l(){try{return localStorage}catch{}}t.exports=Xg()(e);const{formatters:a}=t.exports;a.j=function(c){try{return JSON.stringify(c)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}(br,br.exports)),br.exports}var Cr={exports:{}},wr={exports:{}},nc;function e_(){return nc||(nc=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5},t.exports=e.default}(wr,wr.exports)),wr.exports}var sc;function t_(){return sc||(sc=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=e_(),s=r(n);function r(i){return i&&i.__esModule?i:{default:i}}e.default={pauseVideo:{acceptableStates:[s.default.ENDED,s.default.PAUSED],stateChangeRequired:!1},playVideo:{acceptableStates:[s.default.ENDED,s.default.PLAYING],stateChangeRequired:!1},seekTo:{acceptableStates:[s.default.ENDED,s.default.PLAYING,s.default.PAUSED],stateChangeRequired:!0,timeout:3e3}},t.exports=e.default}(Cr,Cr.exports)),Cr.exports}var Er={exports:{}},rc;function n_(){return rc||(rc=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=["ready","stateChange","playbackQualityChange","playbackRateChange","error","apiChange","volumeChange"],t.exports=e.default}(Er,Er.exports)),Er.exports}var Sr={exports:{}},ic;function s_(){return ic||(ic=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=["cueVideoById","loadVideoById","cueVideoByUrl","loadVideoByUrl","playVideo","pauseVideo","stopVideo","getVideoLoadedFraction","cuePlaylist","loadPlaylist","nextVideo","previousVideo","playVideoAt","setShuffle","setLoop","getPlaylist","getPlaylistIndex","setOption","mute","unMute","isMuted","setVolume","getVolume","seekTo","getPlayerState","getPlaybackRate","setPlaybackRate","getAvailablePlaybackRates","getPlaybackQuality","setPlaybackQuality","getAvailableQualityLevels","getCurrentTime","getDuration","removeEventListener","getVideoUrl","getVideoEmbedCode","getOptions","getOption","addEventListener","destroy","setSize","getIframe","getSphericalProperties","setSphericalProperties"],t.exports=e.default}(Sr,Sr.exports)),Sr.exports}var oc;function r_(){return oc||(oc=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Zg(),s=d(n),r=t_(),i=d(r),o=n_(),l=d(o),a=s_(),c=d(a);function d(f){return f&&f.__esModule?f:{default:f}}const u=(0,s.default)("youtube-player"),h={};h.proxyEvents=f=>{const _={};for(const C of l.default){const S="on"+C.slice(0,1).toUpperCase()+C.slice(1);_[S]=b=>{u('event "%s"',S,b),f.trigger(C,b)}}return _},h.promisifyPlayer=(f,_=!1)=>{const C={};for(const S of c.default)_&&i.default[S]?C[S]=(...b)=>f.then(E=>{const I=i.default[S],T=E.getPlayerState(),U=E[S].apply(E,b);return I.stateChangeRequired||Array.isArray(I.acceptableStates)&&!I.acceptableStates.includes(T)?new Promise(Z=>{const te=()=>{const X=E.getPlayerState();let K;typeof I.timeout=="number"&&(K=setTimeout(()=>{E.removeEventListener("onStateChange",te),Z()},I.timeout)),Array.isArray(I.acceptableStates)&&I.acceptableStates.includes(X)&&(E.removeEventListener("onStateChange",te),clearTimeout(K),Z())};E.addEventListener("onStateChange",te)}).then(()=>U):U}):C[S]=(...b)=>f.then(E=>E[S].apply(E,b));return C},e.default=h,t.exports=e.default}(vr,vr.exports)),vr.exports}var Tr={exports:{}},to,lc;function i_(){if(lc)return to;lc=1,to=function(r,i,o){var l=document.head||document.getElementsByTagName("head")[0],a=document.createElement("script");typeof i=="function"&&(o=i,i={}),i=i||{},o=o||function(){},a.type=i.type||"text/javascript",a.charset=i.charset||"utf8",a.async="async"in i?!!i.async:!0,a.src=r,i.attrs&&t(a,i.attrs),i.text&&(a.text=""+i.text);var c="onload"in a?e:n;c(a,o),a.onload||e(a,o),l.appendChild(a)};function t(s,r){for(var i in r)s.setAttribute(i,r[i])}function e(s,r){s.onload=function(){this.onerror=this.onload=null,r(null,s)},s.onerror=function(){this.onerror=this.onload=null,r(new Error("Failed to load "+this.src),s)}}function n(s,r){s.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,r(null,s))}}return to}var ac;function o_(){return ac||(ac=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=i_(),s=r(n);function r(i){return i&&i.__esModule?i:{default:i}}e.default=i=>new Promise(l=>{if(window.YT&&window.YT.Player&&window.YT.Player instanceof Function){l(window.YT);return}else{const c=window.location.protocol==="http:"?"http:":"https:";(0,s.default)(c+"//www.youtube.com/iframe_api",d=>{d&&i.trigger("error",d)})}const a=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{a&&a(),l(window.YT)}}),t.exports=e.default}(Tr,Tr.exports)),Tr.exports}var cc;function l_(){return cc||(cc=1,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=Qg(),s=a(n),r=r_(),i=a(r),o=o_(),l=a(o);function a(d){return d&&d.__esModule?d:{default:d}}let c;e.default=(d,u={},h=!1)=>{const f=(0,s.default)();if(c||(c=(0,l.default)(f)),u.events)throw new Error("Event handlers cannot be overwritten.");if(typeof d=="string"&&!document.getElementById(d))throw new Error('Element "'+d+'" does not exist.');u.events=i.default.proxyEvents(f);const _=new Promise(S=>{typeof d=="object"&&d.playVideo instanceof Function?S(d):c.then(b=>{const E=new b.Player(d,u);return f.on("ready",()=>{S(E)}),null})}),C=i.default.promisifyPlayer(_,h);return C.on=f.on,C.off=f.off,C},t.exports=e.default}(yr,yr.exports)),yr.exports}var a_=l_();const c_=Yg(a_);function Lr(t){const e=[/[?&]list=([a-zA-Z0-9_-]+)/,/youtube\.com\/embed\/videoseries\?list=([a-zA-Z0-9_-]+)/];for(const n of e){const s=t.match(n);if(s)return s[1]}return/^[a-zA-Z0-9_-]+$/.test(t)&&t.length>11?t:null}async function Or(t,e){const n=[];let s="";try{do{const i=new URL("https://www.googleapis.com/youtube/v3/playlistItems");i.searchParams.set("part","snippet"),i.searchParams.set("playlistId",t),i.searchParams.set("maxResults","50"),i.searchParams.set("key",e),s&&i.searchParams.set("pageToken",s);const o=await fetch(i.toString());if(!o.ok)throw new Error(`YouTube API error: ${o.status} ${o.statusText}`);const l=await o.json();for(const a of l.items){const c=a.snippet;n.push({videoId:c.resourceId.videoId,title:c.title,description:c.description,thumbnail:c.thumbnails.medium?.url||c.thumbnails.default?.url,publishedAt:c.publishedAt,channelTitle:c.channelTitle})}s=l.nextPageToken||""}while(s);return n}catch(i){throw console.error("Error fetching playlist videos:",i),i}}function Ao(){return"AIzaSyB6CK59n--_1YXc2hlYiSyuFDfLbv9mCtU"}function Gr(){return"https://www.youtube.com/watch?v=nNH5pJ1_HBY&list=PLTZ3xk9qgxoFpnob6UdCKyFJtaJMzOHdb"}function uc(){return!1}const rs=vd("audioPlayer",()=>{const t=V(null),e=V(null),n=V(!1),s=V(!1),r=V(null),i=V(!1),o=V(!1),l=V(50),a=V(0),c=V(0),d=V([]),u=V(-1),h=V(!1),f=V(!1),_=ee(()=>r.value!==null),C=ee(()=>d.value.length>0),S=ee(()=>u.value<d.value.length-1),b=ee(()=>u.value>0),E=ee(()=>c.value>0?a.value/c.value*100:0),I=z=>{t.value&&e.value===z||(t.value&&e.value!==z&&(t.value=null,e.value=null),e.value=z,n.value=!1,t.value=c_(z,{width:"100%",height:"1",playerVars:{autoplay:0,controls:0,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0}}),t.value.on("ready",()=>{n.value=!0,t.value&&t.value.setVolume(l.value).catch(le=>{console.warn("Could not set initial volume:",le)})}),t.value.on("stateChange",le=>{const Te=le.data;Te===1?(i.value=!0,o.value=!1):Te===2?i.value=!1:Te===3?o.value=!0:Te===0&&(i.value=!1,f.value||Be())}),t.value.on("ready",()=>{ve(),X(l.value)}),setInterval(async()=>{if(t.value&&i.value)try{a.value=await t.value.getCurrentTime()}catch{}},1e3))},T=async z=>{if(!n.value){let le=0;const Te=5e3;for(;!n.value&&le<Te;)await new Promise(k=>setTimeout(k,100)),le+=100}r.value=z,o.value=!0;try{if(!t.value)throw new Error("Player not available");await t.value.loadVideoById(z.videoId);let le=0;const Te=10;let k=-1;for(;le<Te;){await new Promise(y=>setTimeout(y,300));try{if(!t.value||(k=await t.value.getPlayerState(),k!==-1))break}catch(y){console.warn(`Error checking player state on attempt ${le+1}:`,y)}le++}if(k===-1)throw new Error("Video failed to load properly after multiple attempts");await ve()}catch(le){throw console.error("Error loading track:",le),r.value=null,o.value=!1,le}finally{o.value=!1}},U=async()=>{if(!(!t.value||!r.value)&&n.value)try{s.value=!0,await t.value.playVideo(),setTimeout(async()=>{try{t.value&&await t.value.getPlayerState()!==1&&s.value}catch{}},1e3)}catch(z){console.error("Error playing:",z)}},Z=async()=>{if(!(!t.value||!n.value))try{await t.value.pauseVideo()}catch(z){console.error("Error pausing:",z)}},te=async()=>{i.value?await Z():await U()},X=async z=>{if(l.value=Math.max(0,Math.min(100,z)),t.value&&n.value)try{await t.value.setVolume(l.value)}catch(le){console.error("Error setting volume:",le)}},K=async()=>{if(!(!t.value||!n.value))try{h.value?(await t.value.unMute(),h.value=!1):(await t.value.mute(),h.value=!0)}catch(z){console.error("Error toggling mute:",z)}},he=async z=>{if(!(!t.value||!n.value))try{await t.value.seekTo(z,!0),a.value=z}catch(le){console.error("Error seeking:",le)}},ve=async()=>{if(!(!t.value||!n.value))try{c.value=await t.value.getDuration()}catch{}},q=z=>{d.value.push(z)},j=z=>{d.value.splice(z,1),u.value===z?(u.value=-1,r.value=null,Be()):u.value>z&&(u.value--,Be())},ae=z=>{z>=0&&z<d.value.length&&(u.value=z,T(d.value[z]))},Be=()=>{S.value&&ae(u.value+1)};return{player:t,currentTrack:r,isPlaying:i,isLoading:o,isPlayerReady:n,userInteracted:s,volume:l,currentTime:a,duration:c,playlist:d,currentIndex:u,isMuted:h,heardleMode:f,hasTrack:_,hasPlaylist:C,canGoNext:S,canGoPrevious:b,progress:E,initializePlayer:I,loadTrack:T,play:U,pause:Z,togglePlayPause:te,setVolume:X,toggleMute:K,seekTo:he,addToPlaylist:q,removeFromPlaylist:j,playTrackAtIndex:ae,playNext:Be,playPrevious:()=>{b.value&&ae(u.value-1)},clearPlaylist:()=>{d.value=[],u.value=-1,r.value=null,Z()},loadPlaylistFromYouTube:async()=>{const z=Gr(),le=Lr(z);if(!le)throw console.error("Invalid YouTube playlist URL"),new Error("Invalid YouTube playlist URL");const Te=Ao();try{o.value=!0;const y=(await Or(le,Te)).map(w=>({id:w.videoId,videoId:w.videoId,title:w.title,artist:w.channelTitle}));return d.value=y,u.value=-1,y.length>0,y}catch(k){throw console.error("Error loading YouTube playlist:",k),k}finally{o.value=!1}},addPlaylistFromYouTube:async(z,le)=>{const Te=Lr(z);if(!Te)throw new Error("Invalid YouTube playlist URL");try{o.value=!0;const y=(await Or(Te,le)).map(w=>({id:w.videoId,videoId:w.videoId,title:w.title,artist:w.channelTitle}));return d.value.push(...y),y}catch(k){throw console.error("Error adding YouTube playlist:",k),k}finally{o.value=!1}},loadCustomPlaylistFromYouTube:async z=>{const le=Lr(z);if(!le)throw new Error("Invalid YouTube playlist URL");const Te=Ao();try{o.value=!0;const y=(await Or(le,Te)).map(w=>({id:w.videoId,videoId:w.videoId,title:w.title,artist:w.channelTitle}));return d.value=y,u.value=-1,y}catch(k){throw console.error("Error loading custom YouTube playlist:",k),k}finally{o.value=!1}},setHeardleMode:z=>{f.value=z},primePlayerForAutoplay:async()=>{if(!t.value||!n.value)return!1;try{return await t.value.playVideo(),await new Promise(z=>setTimeout(z,100)),await t.value.pauseVideo(),s.value=!0,!0}catch(z){return console.error("Error priming player:",z),!1}}}}),Wt=[1,2,4,7,11,16],gl=vd("heardle",()=>{const t=V(null),e=V([]),n=V(!1),s=V(!1),r=V(0),i=V(0),o=V(!1),l=V(Wt[0]),a=V(!1),c=V([]),d=V(null),u=V(null),h=V(!1),f=V(null),_=V(0),C=V([]),S=V(0),b=V(!1),E=V(new Set),I=V(!1),T=rs(),U=ee(()=>e.value.length+1),Z=ee(()=>Wt.length),te=ee(()=>!n.value&&U.value<=Z.value),X=ee(()=>Math.max(0,Z.value-e.value.length)),K=ee(()=>Math.max(1,Z.value-e.value.length+1)),he=ee(()=>!h.value||!f.value?null:{current:_.value,total:f.value.totalRounds,percentage:_.value/f.value.totalRounds*100}),ve=ee(()=>C.value.filter(x=>x.hasWon).length),q=ee(()=>C.value.length===0?0:Math.round(C.value.reduce((x,Y)=>x+Y.score,0)/C.value.length)),j=ee(()=>{const x=c.value.length,Y=c.value.filter(v=>v.hasWon).length,m=x>0?Math.round(Y/x*100):0,g=x>0?Math.round(c.value.reduce((v,R)=>v+R.score,0)/x):0;return{totalGames:x,wins:Y,winRate:m,averageScore:g}}),ae=async x=>{t.value&&(h.value?(console.log("startNewGame: Previous game found in tournament mode - calling completeRound"),le()):Ke()),d.value&&(clearTimeout(d.value),d.value=null),u.value&&(clearInterval(u.value),u.value=null),T.setHeardleMode(!0),t.value=x,e.value=[],n.value=!1,s.value=!1,r.value=0,i.value=Date.now(),o.value=!1,l.value=Wt[0],a.value=!1,I.value=!1;try{if(await T.loadTrack(x),!T.hasTrack||!T.currentTrack)throw new Error("Track loading appeared to succeed but hasTrack is false")}catch(Y){console.error("heardleStore: Failed to load track:",Y),console.error("heardleStore: Game cannot start without loaded track"),t.value=null;return}await T.pause()},Be=async()=>{if(!(!t.value||!T.player))try{d.value&&(clearTimeout(d.value),d.value=null),u.value&&(clearInterval(u.value),u.value=null),await T.seekTo(0),await new Promise(x=>setTimeout(x,300)),await T.play(),o.value=!0,d.value=window.setTimeout(async()=>{await T.pause(),o.value=!1,d.value=null},l.value*1e3)}catch(x){console.error("Error playing clip:",x),o.value=!1}},we=async()=>{if(T.player)try{d.value&&(clearTimeout(d.value),d.value=null),u.value&&(clearInterval(u.value),u.value=null),await T.pause(),o.value=!1}catch(x){console.error("Error stopping clip:",x)}},se=x=>{if(!te.value||!t.value)return!1;const Y=x.toLowerCase().trim(),m=t.value.title.toLowerCase().trim(),g=t.value.artist?.toLowerCase().trim()||"",v=Y===m||Y===g||m.includes(Y)&&Y.length>3||g.includes(Y)&&Y.length>3,R={guess:x,isCorrect:v,clipDuration:l.value};if(e.value.push(R),v)s.value=!0,n.value=!0,r.value=(Z.value-e.value.length+1)*100,a.value=!0,console.log("Player won the round!"),h.value&&(console.log("Tournament mode - calling completeRound for WIN"),le());else if(e.value.length>=Z.value)n.value=!0,a.value=!0,console.log("Player lost the round (no more attempts)"),h.value&&(console.log("Tournament mode - calling completeRound for LOSS"),le());else{const M=e.value.length;M<Wt.length&&(l.value=Wt[M])}return v},fe=()=>{if(!te.value)return;const x={guess:"",isCorrect:!1,clipDuration:l.value};if(e.value.push(x),e.value.length>=Z.value)n.value=!0,a.value=!0,console.log("Player skipped all attempts - game over"),h.value&&(console.log("Tournament mode - calling completeRound for SKIP LOSS"),le());else{const Y=e.value.length;Y<Wt.length&&(l.value=Wt[Y])}},ot=()=>{a.value=!0,n.value=!0,h.value&&!s.value&&(console.log("revealAnswer called in tournament mode - completing round"),le())},dt=async()=>{if(!(!t.value||!T.player))try{d.value&&(clearTimeout(d.value),d.value=null),u.value&&(clearInterval(u.value),u.value=null),T.setHeardleMode(!1),o.value=!1,await T.seekTo(0),await T.play()}catch(x){console.error("Error playing full song:",x)}},Ke=()=>{if(!t.value)return;const x={currentTrack:{...t.value},attempts:[...e.value],isGameOver:n.value,hasWon:s.value,score:r.value,startTime:i.value};c.value.push(x),c.value.length>100&&(c.value=c.value.slice(-100))},Le=x=>{h.value=!0,f.value=x,_.value=0,C.value=[],S.value=0,b.value=!1,E.value.clear(),I.value=!1,z()},z=async()=>{if(!h.value||!f.value)return;if(console.log("startNextRound called:",{currentRound:_.value,totalRounds:f.value.totalRounds}),_.value>=f.value.totalRounds){console.log("Tournament already complete in startNextRound"),Te();return}const x=T.playlist.filter(m=>!E.value.has(m.id));if(x.length===0){console.warn("No more available tracks for tournament"),Te();return}const Y=x[Math.floor(Math.random()*x.length)];E.value.add(Y.id),_.value++,console.log("Starting round:",_.value,"with track:",Y.title),await ae(Y)},le=()=>{if(console.log("completeRound called with state:",{isTournamentMode:h.value,hasCurrentTrack:!!t.value,alreadyCompleted:I.value,currentRound:_.value,totalRounds:f.value?.totalRounds,hasWon:s.value,currentTrack:t.value?.title}),!h.value||!t.value){console.log("completeRound: skipping - not in tournament mode or no current track");return}if(I.value){console.log("completeRound: skipping - round already completed");return}console.log("completeRound: proceeding to save round result"),I.value=!0;const x={track:{...t.value},attempts:[...e.value],hasWon:s.value,score:r.value,roundTime:Date.now()-i.value};C.value.push(x),S.value+=r.value,console.log("Round result saved:",x),console.log("Total round results so far:",C.value.length),_.value>=(f.value?.totalRounds||0)&&(console.log("Tournament complete - calling completeTournament()"),Te())},Te=()=>{b.value=!0,n.value=!0,console.log("Tournament completed!",{rounds:C.value.length,totalScore:S.value,wins:ve.value,averageScore:q.value})},k=()=>{h.value=!1,f.value=null,_.value=0,C.value=[],S.value=0,b.value=!1,E.value.clear(),I.value=!1,y()},y=()=>{t.value&&Ke(),d.value&&(clearTimeout(d.value),d.value=null),u.value&&(clearInterval(u.value),u.value=null),t.value=null,e.value=[],n.value=!1,s.value=!1,r.value=0,i.value=0,o.value=!1,l.value=Wt[0],a.value=!1,h.value=!1,f.value=null,_.value=0,C.value=[],S.value=0,b.value=!1,E.value.clear()},w=()=>{if(T.playlist.length===0)return null;const x=Math.floor(Math.random()*T.playlist.length);return T.playlist[x]};return{currentTrack:t,attempts:e,isGameOver:n,hasWon:s,score:r,startTime:i,isPlaying:o,currentClipDuration:l,showAnswer:a,gameHistory:c,isTournamentMode:h,tournamentConfig:f,currentRound:_,roundResults:C,tournamentScore:S,isTournamentComplete:b,currentAttemptNumber:U,maxAttempts:Z,canMakeGuess:te,remainingAttempts:X,currentScoreMultiplier:K,gameStats:j,tournamentProgress:he,tournamentWins:ve,tournamentAverageScore:q,startNewGame:ae,playClip:Be,stopClip:we,makeGuess:se,skipGuess:fe,revealAnswer:ot,playFullSong:dt,resetGame:y,getRandomTrackFromPlaylist:w,startRandomGame:async()=>{const x=w();x?await ae(x):console.error("No tracks available in playlist - playlist length:",T.playlist.length)},saveGameToHistory:Ke,startTournament:Le,startNextRound:z,completeRound:le,completeTournament:Te,resetTournament:k,HEARDLE_CLIP_DURATIONS:Wt}}),u_={class:"smart-guess-input"},d_={class:"input-container"},h_=["placeholder","disabled"],f_={key:0,class:"suggestions-dropdown"},p_=["onMousedown"],m_={class:"suggestion-title"},g_={key:0,class:"suggestion-artist"},__=["disabled"],y_=ut({__name:"SmartGuessInput",props:{modelValue:{},placeholder:{default:"Enter song title or artist..."},disabled:{type:Boolean,default:!1},submitText:{default:"Guess"},maxSuggestions:{default:8}},emits:["update:modelValue","submit"],setup(t,{expose:e,emit:n}){const s=t,r=n,i=rs(),o=V(),l=V(s.modelValue),a=V(!1),c=V(-1);qt(()=>s.modelValue,b=>{l.value=b}),qt(l,b=>{r("update:modelValue",b)});const d=ee(()=>{if(!l.value||l.value.length<1)return[];const b=l.value.toLowerCase().trim();return i.playlist.filter(E=>{const I=E.title.toLowerCase().includes(b),T=E.artist?.toLowerCase().includes(b)||!1;return I||T}).sort((E,I)=>{const T=E.title.toLowerCase(),U=I.title.toLowerCase(),Z=E.artist?.toLowerCase()||"",te=I.artist?.toLowerCase()||"",X=T===b,K=U===b,he=Z===b,ve=te===b;if(X&&!K)return-1;if(K&&!X)return 1;if(he&&!ve)return-1;if(ve&&!he)return 1;const q=T.indexOf(b),j=U.indexOf(b);return q!==j?q===-1?1:j===-1?-1:q-j:E.title.length-I.title.length})}),u=()=>{c.value=-1,a.value=!0},h=b=>{if(!a.value||d.value.length===0){b.key==="Enter"&&C();return}switch(b.key){case"ArrowDown":b.preventDefault(),c.value=Math.min(c.value+1,Math.min(d.value.length-1,s.maxSuggestions-1));break;case"ArrowUp":b.preventDefault(),c.value=Math.max(c.value-1,-1);break;case"Enter":if(b.preventDefault(),c.value>=0){const E=d.value[c.value];f(E)}else C();break;case"Escape":a.value=!1,c.value=-1,o.value?.blur();break;case"Tab":if(c.value>=0){b.preventDefault();const E=d.value[c.value];f(E)}else a.value=!1;break}},f=b=>{l.value=b.title,a.value=!1,c.value=-1,gi(()=>{o.value?.focus()})},_=()=>{setTimeout(()=>{a.value=!1,c.value=-1},150)},C=()=>{l.value.trim()&&r("submit",l.value.trim())};return e({focus:()=>{o.value?.focus()}}),(b,E)=>(N(),O("div",u_,[p("div",d_,[yt(p("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":E[0]||(E[0]=I=>l.value=I),onInput:u,onKeydown:h,onFocus:E[1]||(E[1]=I=>a.value=!0),onBlur:_,placeholder:b.placeholder,disabled:b.disabled,class:"guess-input",autocomplete:"off"},null,40,h_),[[vt,l.value]]),a.value&&d.value.length>0?(N(),O("div",f_,[(N(!0),O(Fe,null,It(d.value.slice(0,b.maxSuggestions),(I,T)=>(N(),O("div",{key:I.id,onMousedown:U=>f(I),class:Qe(["suggestion-item",{highlighted:T===c.value}])},[p("div",m_,P(I.title),1),I.artist?(N(),O("div",g_," by "+P(I.artist),1)):pe("",!0)],42,p_))),128))])):pe("",!0)]),p("button",{onClick:C,disabled:!l.value.trim()||b.disabled,class:"submit-button"},P(b.submitText),9,__)]))}}),Dd=kt(y_,[["__scopeId","data-v-ad79f0ad"]]),v_={class:"heardle-game"},b_={class:"game-header"},C_={class:"game-header"},w_={key:0,class:"tournament-info"},E_={class:"tournament-progress"},S_={class:"progress-bar"},T_={class:"progress-text"},I_={class:"tournament-stats"},R_={class:"tournament-stat"},P_={class:"stat-value"},k_={class:"tournament-stat"},x_={class:"stat-value"},A_={class:"tournament-stat"},N_={class:"stat-value"},L_={key:1},O_={class:"game-stats"},M_={class:"stat"},D_={class:"stat-value"},F_={key:0,class:"stat"},$_={class:"stat-value"},U_={key:0,class:"game-status"},H_={class:"single-player-status"},W_=["disabled"],B_={key:0,class:"no-playlist"},V_={key:1,class:"no-playlist"},G_={key:1,class:"active-game"},j_={class:"clip-info"},q_={class:"clip-duration"},K_={class:"duration-value"},z_={class:"attempts-display"},Y_={class:"play-controls"},Q_=["disabled"],J_={key:0},X_={key:1},Z_={class:"volume-control"},ey={class:"volume-container"},ty=["title"],ny={key:0},sy={key:1},ry={key:2},iy={key:3},oy=["disabled"],ly={class:"volume-display"},ay={key:0,class:"guess-section"},cy={class:"action-buttons"},uy=["disabled"],dy={key:1,class:"attempts-history"},hy={class:"attempts-list"},fy={class:"attempt-number"},py={class:"attempt-guess"},my={class:"attempt-result"},gy={key:2,class:"game-result"},_y={class:"result-header"},yy={key:0,class:"win-message"},vy={key:1,class:"lose-message"},by={class:"answer-reveal"},Cy={class:"track-info"},wy={class:"track-title"},Ey={key:0,class:"track-artist"},Sy={key:0,class:"final-score"},Ty={class:"score-value"},Iy={class:"score-multiplier"},Ry={class:"end-game-actions"},Py={key:0,class:"tournament-actions"},ky={key:1,class:"single-game-actions"},xy={key:0,class:"video-player-section"},Ay={class:"video-info"},Ny={class:"video-title"},Ly={key:0,class:"video-artist"},Oy={class:"video-wrapper"},My=["src"],Dy={key:2,class:"game-statistics"},Fy={class:"stats-grid"},$y={class:"stat-item"},Uy={class:"stat-number"},Hy={class:"stat-item"},Wy={class:"stat-number"},By={class:"stat-item"},Vy={class:"stat-number"},Gy=ut({__name:"HeardleGame",setup(t){const e=Zt(),n=gl(),s=rs(),r=V(""),i=V(!1);wn(()=>{}),Vu(()=>{});const o=async()=>{s.userInteracted||await s.primePlayerForAutoplay(),await n.playClip()},l=async()=>{await n.stopClip()},a=()=>{s.setVolume(s.volume)},c=S=>{const b=S||r.value.trim();b&&(n.makeGuess(b),r.value="")},d=()=>{n.skipGuess()},u=()=>{n.revealAnswer()},h=async()=>{i.value=!1,await n.startRandomGame(),r.value=""},f=async()=>{await s.pause(),i.value=!0},_=async()=>{i.value=!1,r.value="",await n.startNextRound()},C=()=>{console.log("completeTournament called, current tournament state:",{isTournamentMode:n.isTournamentMode,isTournamentComplete:n.isTournamentComplete,currentRound:n.currentRound,totalRounds:n.tournamentConfig?.totalRounds,roundResults:n.roundResults.length}),n.completeTournament(),console.log("After completeTournament, state:",{isTournamentComplete:n.isTournamentComplete,roundResults:n.roundResults.length}),setTimeout(()=>{e.push("/results")},100)};return(S,b)=>(N(),O("div",v_,[p("div",b_,[p("div",C_,[L(n).isTournamentMode&&L(n).tournamentConfig?(N(),O("div",w_,[p("h2",null,"🏆 "+P(L(n).tournamentConfig.tournamentName),1),p("div",E_,[p("div",S_,[p("div",{class:"progress-fill",style:nr({width:`${L(n).tournamentProgress?.percentage||0}%`})},null,4)]),p("div",T_," Round "+P(L(n).currentRound)+" of "+P(L(n).tournamentConfig.totalRounds),1)]),p("div",I_,[p("div",R_,[b[3]||(b[3]=p("span",{class:"stat-label"},"Player:",-1)),p("span",P_,P(L(n).tournamentConfig.playerName),1)]),p("div",k_,[b[4]||(b[4]=p("span",{class:"stat-label"},"Tournament Score:",-1)),p("span",x_,P(L(n).tournamentScore),1)]),p("div",A_,[b[5]||(b[5]=p("span",{class:"stat-label"},"Wins:",-1)),p("span",N_,P(L(n).tournamentWins)+"/"+P(L(n).currentRound-1),1)])])])):(N(),O("h2",L_,"🎵 Heardle Game")),p("div",O_,[p("div",M_,[b[6]||(b[6]=p("span",{class:"stat-label"},"Attempt:",-1)),p("span",D_,P(L(n).currentAttemptNumber)+"/"+P(L(n).maxAttempts),1)]),L(n).score>0?(N(),O("div",F_,[b[7]||(b[7]=p("span",{class:"stat-label"},"Score:",-1)),p("span",$_,P(L(n).score),1)])):pe("",!0)])]),L(n).currentTrack?(N(),O("div",G_,[p("div",j_,[p("div",q_,[b[9]||(b[9]=p("span",{class:"duration-label"},"Current clip length:",-1)),p("span",K_,P(L(n).currentClipDuration)+"s",1)]),p("div",z_,[(N(!0),O(Fe,null,It(L(n).HEARDLE_CLIP_DURATIONS,(E,I)=>(N(),O("div",{key:I,class:Qe(["attempt-dot",{completed:I<L(n).attempts.length,current:I===L(n).attempts.length&&!L(n).isGameOver,correct:I<L(n).attempts.length&&L(n).attempts[I]?.isCorrect,skipped:I<L(n).attempts.length&&L(n).attempts[I]?.guess===""}])},P(E)+"s ",3))),128))])]),p("div",Y_,[p("button",{onClick:o,disabled:L(n).isPlaying||L(n).isGameOver,class:"play-clip-btn"},[L(n).isPlaying?(N(),O("span",J_,"🔄 Playing...")):(N(),O("span",X_,"▶️ Play "+P(L(n).currentClipDuration)+"s",1))],8,Q_),L(n).isPlaying?(N(),O("button",{key:0,onClick:l,class:"stop-clip-btn"}," ⏹️ Stop ")):pe("",!0)]),p("div",Z_,[p("div",ey,[p("button",{onClick:b[0]||(b[0]=E=>L(s).toggleMute()),class:"volume-btn",title:L(s).isMuted?"Unmute":"Mute"},[L(s).isMuted?(N(),O("span",ny,"🔇")):L(s).volume===0?(N(),O("span",sy,"🔈")):L(s).volume<50?(N(),O("span",ry,"🔉")):(N(),O("span",iy,"🔊"))],8,ty),yt(p("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":b[1]||(b[1]=E=>L(s).volume=E),onInput:a,class:"volume-slider",disabled:L(s).isMuted},null,40,oy),[[vt,L(s).volume]]),p("span",ly,P(L(s).volume)+"%",1)])]),L(n).isGameOver?pe("",!0):(N(),O("div",ay,[We(Dd,{modelValue:r.value,"onUpdate:modelValue":b[2]||(b[2]=E=>r.value=E),onSubmit:c,disabled:!L(n).canMakeGuess,placeholder:"Type to search for a song or artist...","submit-text":"Guess"},null,8,["modelValue","disabled"]),p("div",cy,[p("button",{onClick:d,disabled:!L(n).canMakeGuess,class:"skip-btn"}," Skip (+"+P(L(n).HEARDLE_CLIP_DURATIONS[L(n).attempts.length+1]||"reveal")+"s) ",9,uy),p("button",{onClick:u,class:"give-up-btn"}," Give Up ")])])),L(n).attempts.length>0?(N(),O("div",dy,[b[10]||(b[10]=p("h4",null,"Previous Attempts:",-1)),p("div",hy,[(N(!0),O(Fe,null,It(L(n).attempts,(E,I)=>(N(),O("div",{key:I,class:Qe(["attempt-item",{correct:E.isCorrect,skipped:E.guess===""}])},[p("span",fy,P(I+1)+".",1),p("span",py,P(E.guess||"Skipped"),1),p("span",my,P(E.isCorrect?"✅":E.guess===""?"⏭️":"❌"),1)],2))),128))])])):pe("",!0),L(n).isGameOver||L(n).showAnswer?(N(),O("div",gy,[p("div",_y,[L(n).hasWon?(N(),O("h3",yy," 🎉 Congratulations! You got it! ")):(N(),O("h3",vy," 😔 Better luck next time! "))]),p("div",by,[p("div",Cy,[p("h4",wy,P(L(n).currentTrack?.title),1),L(n).currentTrack?.artist?(N(),O("p",Ey," by "+P(L(n).currentTrack.artist),1)):pe("",!0)]),L(n).hasWon?(N(),O("div",Sy,[b[11]||(b[11]=p("span",{class:"score-label"},"Final Score:",-1)),p("span",Ty,P(L(n).score)+" points",1),p("span",Iy,"("+P(L(n).currentScoreMultiplier)+"x multiplier)",1)])):pe("",!0)]),p("div",Ry,[p("button",{onClick:f,class:"play-full-btn"}," 🎵 Play Full Song "),L(n).isTournamentMode?(N(),O("div",Py,[!L(n).isTournamentComplete&&L(n).currentRound<(L(n).tournamentConfig?.totalRounds||0)?(N(),O("button",{key:0,onClick:_,class:"next-round-btn"}," ⏭️ Next Round ("+P(L(n).currentRound+1)+"/"+P(L(n).tournamentConfig?.totalRounds)+") ",1)):L(n).isTournamentComplete||L(n).currentRound>=(L(n).tournamentConfig?.totalRounds||0)?(N(),O("button",{key:1,onClick:C,class:"tournament-complete-btn"}," 🏆 View Tournament Results ")):pe("",!0)])):(N(),O("div",ky,[p("button",{onClick:h,class:"new-game-btn"}," 🎲 New Random Game ")]))]),i.value&&L(n).currentTrack?(N(),O("div",xy,[p("div",Ay,[p("h4",Ny,P(L(n).currentTrack.title),1),L(n).currentTrack.artist?(N(),O("p",Ly,"by "+P(L(n).currentTrack.artist),1)):pe("",!0)]),p("div",Oy,[p("iframe",{src:`https://www.youtube.com/embed/${L(n).currentTrack.videoId}?autoplay=1&controls=1&rel=0&modestbranding=1`,frameborder:"0",allowfullscreen:"",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",class:"youtube-iframe"},null,8,My)])])):pe("",!0)])):pe("",!0)])):(N(),O("div",U_,[p("div",H_,[b[8]||(b[8]=p("p",null,"Ready to start a new game?",-1)),p("button",{onClick:h,class:"start-btn",disabled:!L(s).hasPlaylist||!L(s).isPlayerReady}," 🎲 Start Random Game ",8,W_),L(s).hasPlaylist?L(s).isPlayerReady?pe("",!0):(N(),O("p",V_," Audio player initializing... ")):(N(),O("p",B_," No playlist loaded. Please wait for tracks to load. "))])])),L(n).gameStats.totalGames>0?(N(),O("div",Dy,[b[15]||(b[15]=p("h4",null,"📊 Your Statistics",-1)),p("div",Fy,[p("div",$y,[p("span",Uy,P(L(n).gameStats.totalGames),1),b[12]||(b[12]=p("span",{class:"stat-description"},"Games Played",-1))]),p("div",Hy,[p("span",Wy,P(L(n).gameStats.winRate)+"%",1),b[13]||(b[13]=p("span",{class:"stat-description"},"Win Rate",-1))]),p("div",By,[p("span",Vy,P(L(n).gameStats.averageScore),1),b[14]||(b[14]=p("span",{class:"stat-description"},"Avg Score",-1))])])])):pe("",!0)])]))}}),jy=kt(Gy,[["__scopeId","data-v-2783c577"]]),qy={class:"youtube-audio-player"},Ky=["id"],zy={class:"player-container"},Yy={key:0,class:"track-info"},Qy={class:"track-title"},Jy={key:0,class:"track-artist"},Xy={class:"progress-container"},Zy={class:"time-display"},ev={class:"progress-track"},tv={class:"time-display"},nv={class:"controls"},sv=["disabled","title"],rv={key:0},iv={key:1},ov={key:2},lv={class:"volume-container"},av=["title"],cv={key:0},uv={key:1},dv={key:2},hv={key:3},fv=["disabled"],pv=ut({__name:"YouTubeAudioPlayer",setup(t){const e=rs(),n=V(`youtube-player-${Math.random().toString(36).substr(2,9)}`),s=o=>{const l=Math.floor(o/60),a=Math.floor(o%60);return`${l}:${a.toString().padStart(2,"0")}`},r=o=>{if(!e.hasTrack)return;const a=o.currentTarget.getBoundingClientRect(),d=(o.clientX-a.left)/a.width*e.duration;e.seekTo(d)},i=()=>{e.setVolume(e.volume)};return wn(()=>{e.initializePlayer(n.value)}),(o,l)=>(N(),O("div",qy,[p("div",{id:n.value,style:{width:"1px",height:"1px",opacity:"0","pointer-events":"none"}},null,8,Ky),p("div",zy,[L(e).hasTrack?(N(),O("div",Yy,[p("h3",Qy,P(L(e).currentTrack?.title),1),L(e).currentTrack?.artist?(N(),O("p",Jy,P(L(e).currentTrack.artist),1)):pe("",!0)])):pe("",!0),p("div",Xy,[p("span",Zy,P(s(L(e).currentTime)),1),p("div",{class:"progress-bar",onClick:r},[p("div",ev,[p("div",{class:"progress-fill",style:nr({width:L(e).progress+"%"})},null,4)])]),p("span",tv,P(s(L(e).duration)),1)]),p("div",nv,[p("button",{onClick:l[0]||(l[0]=a=>L(e).togglePlayPause()),disabled:!L(e).hasTrack,class:"control-btn play-pause-btn",title:L(e).isPlaying?"Pause":"Play"},[L(e).isLoading?(N(),O("span",rv,"🔄")):L(e).isPlaying?(N(),O("span",iv,"⏸️")):(N(),O("span",ov,"▶️"))],8,sv),p("div",lv,[p("button",{onClick:l[1]||(l[1]=a=>L(e).toggleMute()),class:"control-btn volume-btn",title:L(e).isMuted?"Unmute":"Mute"},[L(e).isMuted?(N(),O("span",cv,"🔇")):L(e).volume===0?(N(),O("span",uv,"🔈")):L(e).volume<50?(N(),O("span",dv,"🔉")):(N(),O("span",hv,"🔊"))],8,av),yt(p("input",{type:"range",min:"0",max:"100","onUpdate:modelValue":l[2]||(l[2]=a=>L(e).volume=a),onInput:i,class:"volume-slider",disabled:L(e).isMuted},null,40,fv),[[vt,L(e).volume]])])])])]))}}),Fd=kt(pv,[["__scopeId","data-v-8dcf3b79"]]),mv={class:"game-view"},gv={class:"single-player-section"},_v={style:{display:"none"}},yv=ut({__name:"GameView",setup(t){const e=Zt(),n=Si(),s=rs(),r=gl(),i=()=>{r.resetGame(),e.push("/")};return wn(async()=>{const o=n.query.playlistUrl,l=n.query.playerName,a=n.query.tournamentName,c=n.query.songCount;console.log("Game started with config:",{playerName:l,tournamentName:a,playlistUrl:o,songCount:c});try{if(o&&o.trim()!==""?(console.log("Loading custom playlist:",o),await s.loadCustomPlaylistFromYouTube(o)):s.hasPlaylist||(console.log("Loading default playlist"),await s.loadPlaylistFromYouTube()),l&&a&&c){const d={playerName:l.trim(),tournamentName:a.trim(),totalRounds:parseInt(c)||10};console.log("Starting tournament:",d),r.startTournament(d)}else console.log("Starting single random game"),r.startRandomGame()}catch(d){if(console.error("Error loading playlist:",d),o&&!s.hasPlaylist){console.log("Falling back to default playlist");try{if(await s.loadPlaylistFromYouTube(),l&&a&&c){const u={playerName:l.trim(),tournamentName:a.trim(),totalRounds:parseInt(c)||10};r.startTournament(u)}else r.startRandomGame()}catch(u){console.error("Error loading fallback playlist:",u)}}}}),(o,l)=>(N(),O("div",mv,[p("div",{class:"menu-button-container"},[p("button",{class:"return-menu-btn",onClick:i}," ← Return to Menu ")]),l[0]||(l[0]=p("h1",{style:{"text-align":"center"}},"Heardle Tournament",-1)),p("div",gv,[We(jy)]),p("div",_v,[We(Fd)])]))}}),vv=kt(yv,[["__scopeId","data-v-e9d38985"]]),bv={class:"config-view"},Cv={class:"config-container"},wv={class:"form-group"},Ev={class:"form-group"},Sv={class:"form-group"},Tv={class:"form-group"},Iv={class:"predefined-playlists"},Rv={key:0,class:"predefined-menu"},Pv=["onClick"],kv={class:"playlist-info"},xv={class:"playlist-meta"},Av={class:"form-group"},Nv=["disabled","max"],Lv={key:0,class:"form-hint"},Ov={key:1,class:"form-hint"},Mv={key:2,class:"form-hint"},Dv=ut({__name:"ConfigView",setup(t){const e=Zt(),n=V(""),s=V(""),r=V(""),i=V(10),o=V(0),l=V(!1),a=V([{id:"xenoblade",name:"Xenoblade Chronicles",description:"Epic orchestral soundtrack from the Xenoblade Chronicles series",url:Gr(),songCount:"50+",genre:"Video Game OST"}]),c=h=>{r.value=h.url,l.value=!1,h.id==="xenoblade"?o.value=50:o.value=25,i.value>o.value&&(i.value=Math.min(10,o.value))};qt(r,h=>{h&&h.trim()!==""?o.value=100:(o.value=0,i.value=10)});const d=()=>{e.push("/")},u=()=>{if(i.value<1){alert("Number of songs must be at least 1");return}if(o.value>0&&i.value>o.value){alert(`Number of songs cannot exceed ${o.value} (playlist size)`);return}console.log("Starting game with config:",{playerName:n.value,tournamentName:s.value,playlistUrl:r.value,songCount:i.value}),e.push({path:"/game",query:{playerName:n.value,tournamentName:s.value,playlistUrl:r.value,songCount:i.value.toString()}})};return(h,f)=>(N(),O("div",bv,[p("div",{class:"menu-button-container"},[p("button",{class:"return-menu-btn",onClick:d}," ← Back to Menu ")]),f[12]||(f[12]=p("h1",{style:{"text-align":"center"}},"Tournament Configuration",-1)),p("div",Cv,[f[11]||(f[11]=p("h2",null,"Setup Your Game",-1)),p("form",{class:"config-form",onSubmit:pd(u,["prevent"])},[p("div",wv,[f[5]||(f[5]=p("label",{for:"playerName"},"Player Name",-1)),yt(p("input",{type:"text",id:"playerName","onUpdate:modelValue":f[0]||(f[0]=_=>n.value=_),placeholder:"Enter your name",class:"form-input"},null,512),[[vt,n.value]])]),p("div",Ev,[f[6]||(f[6]=p("label",{for:"tournamentName"},"Tournament Name",-1)),yt(p("input",{type:"text",id:"tournamentName","onUpdate:modelValue":f[1]||(f[1]=_=>s.value=_),placeholder:"Name your tournament",class:"form-input"},null,512),[[vt,s.value]])]),p("div",Sv,[f[7]||(f[7]=p("label",{for:"playlistUrl"},"YouTube Playlist URL",-1)),yt(p("input",{type:"url",id:"playlistUrl","onUpdate:modelValue":f[2]||(f[2]=_=>r.value=_),placeholder:"https://www.youtube.com/playlist?list=...",class:"form-input"},null,512),[[vt,r.value]]),f[8]||(f[8]=p("p",{class:"form-hint"},[pt(" ⚠️ Make sure your playlist is set to "),p("strong",null,"Public"),pt(" or "),p("strong",null,"Unlisted"),pt(" (not Private) ")],-1))]),p("div",Tv,[p("div",Iv,[p("button",{type:"button",class:"predefined-toggle",onClick:f[3]||(f[3]=_=>l.value=!l.value)},P(l.value?"▼":"▶")+" Or choose from predefined playlists ",1),l.value?(N(),O("div",Rv,[(N(!0),O(Fe,null,It(a.value,_=>(N(),O("div",{class:"predefined-item",key:_.id},[p("button",{type:"button",class:Qe(["predefined-btn",{selected:r.value===_.url}]),onClick:C=>c(_)},[p("div",kv,[p("h4",null,P(_.name),1),p("p",null,P(_.description),1),p("span",xv,P(_.songCount)+" songs • "+P(_.genre),1)])],10,Pv)]))),128))])):pe("",!0)])]),p("div",Av,[f[9]||(f[9]=p("label",{for:"songCount"},"Number of Songs",-1)),yt(p("input",{type:"number",id:"songCount","onUpdate:modelValue":f[4]||(f[4]=_=>i.value=_),disabled:!r.value||r.value.trim()==="",min:1,max:o.value,placeholder:"Enter number of songs",class:Qe(["form-input",{disabled:!r.value||r.value.trim()===""}])},null,10,Nv),[[vt,i.value,void 0,{number:!0}]]),!r.value||r.value.trim()===""?(N(),O("p",Lv," Please select a playlist first ")):o.value>0?(N(),O("p",Ov," Choose between 1 and "+P(o.value)+" songs (playlist size) ",1)):(N(),O("p",Mv," How many songs will be played in this tournament "))]),f[10]||(f[10]=p("div",{class:"form-actions"},[p("button",{type:"submit",class:"start-game-btn"}," 🎵 Start Tournament ")],-1))],32)])]))}}),Fv=kt(Dv,[["__scopeId","data-v-a8cb074c"]]),$v={class:"tournament-results"},Uv={class:"results-header"},Hv={class:"trophy-container"},Wv={key:0},Bv={class:"results-container"},Vv={class:"overall-stats"},Gv={class:"stats-grid"},jv={class:"stat-card primary"},qv={class:"stat-content"},Kv={class:"stat-value"},zv={class:"stat-detail"},Yv={class:"stat-card secondary"},Qv={class:"stat-content"},Jv={class:"stat-value"},Xv={class:"stat-detail"},Zv={class:"stat-card accent"},eb={class:"stat-content"},tb={class:"stat-value"},nb={class:"stat-detail"},sb={class:"round-results"},rb={class:"rounds-list"},ib={class:"round-header"},ob={class:"round-number"},lb={class:"round-status"},ab={class:"status-icon"},cb={class:"status-text"},ub={class:"round-details"},db={class:"track-info"},hb={class:"track-title"},fb={key:0,class:"track-artist"},pb={class:"round-stats"},mb={class:"round-stat"},gb={class:"stat-value"},_b={class:"round-stat"},yb={class:"stat-value"},vb={class:"round-stat"},bb={class:"stat-value"},Cb={class:"player-info"},wb={class:"info-grid"},Eb={class:"info-item"},Sb={class:"info-value"},Tb={class:"info-item"},Ib={class:"info-value"},Rb={class:"info-item"},Pb={class:"info-value"},kb={class:"info-item"},xb={class:"info-value"},Ab=ut({__name:"TournamentResults",setup(t){const e=Zt(),n=gl();wn(()=>{console.log("TournamentResults mounted with data:",{isTournamentComplete:n.isTournamentComplete,tournamentConfig:n.tournamentConfig,roundResultsLength:n.roundResults.length,isTournamentMode:n.isTournamentMode,currentRound:n.currentRound,roundResults:n.roundResults}),!n.tournamentConfig&&n.roundResults.length===0?(console.log("No tournament data found, redirecting to home"),setTimeout(()=>{e.push("/")},3e3)):n.tournamentConfig&&n.roundResults.length>0&&(n.isTournamentComplete||(console.log("Tournament has data but not marked complete, marking as complete"),n.completeTournament()))});const s=ee(()=>{const d=n.tournamentConfig?.totalRounds||0;return d===0?0:Math.round(n.tournamentWins/d*100)}),r=ee(()=>{const d=s.value;return d>=90?"Excellent!":d>=75?"Great!":d>=60?"Good":d>=40?"Fair":"Keep trying!"}),i=ee(()=>new Date().toLocaleDateString()),o=ee(()=>{if(n.roundResults.length===0)return"0m";const d=n.roundResults.reduce((f,_)=>f+_.roundTime,0),u=Math.floor(d/6e4),h=Math.floor(d%6e4/1e3);return u>0?`${u}m ${h}s`:`${h}s`}),l=d=>{const u=Math.floor(d/1e3),h=Math.floor(u/60),f=u%60;return h>0?`${h}m ${f}s`:`${f}s`},a=()=>{n.resetTournament(),e.push("/config")},c=()=>{n.resetTournament(),e.push("/")};return(d,u)=>(N(),O("div",$v,[p("div",Uv,[p("div",Hv,[u[0]||(u[0]=p("div",{class:"trophy-icon"},"🏆",-1)),u[1]||(u[1]=p("h1",null,"Tournament Complete!",-1)),L(n).tournamentConfig?(N(),O("h2",Wv,P(L(n).tournamentConfig.tournamentName),1)):pe("",!0)])]),p("div",Bv,[p("div",Vv,[u[8]||(u[8]=p("h3",null,"Final Results",-1)),p("div",Gv,[p("div",jv,[u[3]||(u[3]=p("div",{class:"stat-icon"},"🎯",-1)),p("div",qv,[p("span",Kv,P(L(n).tournamentWins),1),u[2]||(u[2]=p("span",{class:"stat-label"},"Wins",-1)),p("span",zv,"out of "+P(L(n).tournamentConfig?.totalRounds||0)+" rounds",1)])]),p("div",Yv,[u[5]||(u[5]=p("div",{class:"stat-icon"},"⭐",-1)),p("div",Qv,[p("span",Jv,P(L(n).tournamentScore),1),u[4]||(u[4]=p("span",{class:"stat-label"},"Total Score",-1)),p("span",Xv,P(L(n).tournamentAverageScore)+" avg per round",1)])]),p("div",Zv,[u[7]||(u[7]=p("div",{class:"stat-icon"},"📊",-1)),p("div",eb,[p("span",tb,P(s.value)+"%",1),u[6]||(u[6]=p("span",{class:"stat-label"},"Win Rate",-1)),p("span",nb,P(r.value),1)])])])]),p("div",sb,[u[12]||(u[12]=p("h3",null,"Round by Round",-1)),p("div",rb,[(N(!0),O(Fe,null,It(L(n).roundResults,(h,f)=>(N(),O("div",{key:f,class:Qe(["round-item",{won:h.hasWon,lost:!h.hasWon}])},[p("div",ib,[p("div",ob,"Round "+P(f+1),1),p("div",lb,[p("span",ab,P(h.hasWon?"✅":"❌"),1),p("span",cb,P(h.hasWon?"Won":"Lost"),1)])]),p("div",ub,[p("div",db,[p("h4",hb,P(h.track.title),1),h.track.artist?(N(),O("p",fb,"by "+P(h.track.artist),1)):pe("",!0)]),p("div",pb,[p("div",mb,[u[9]||(u[9]=p("span",{class:"stat-label"},"Score:",-1)),p("span",gb,P(h.score),1)]),p("div",_b,[u[10]||(u[10]=p("span",{class:"stat-label"},"Attempts:",-1)),p("span",yb,P(h.attempts.length),1)]),p("div",vb,[u[11]||(u[11]=p("span",{class:"stat-label"},"Time:",-1)),p("span",bb,P(l(h.roundTime)),1)])])])],2))),128))])]),p("div",Cb,[u[17]||(u[17]=p("h3",null,"Tournament Details",-1)),p("div",wb,[p("div",Eb,[u[13]||(u[13]=p("span",{class:"info-label"},"Player:",-1)),p("span",Sb,P(L(n).tournamentConfig?.playerName||"Anonymous"),1)]),p("div",Tb,[u[14]||(u[14]=p("span",{class:"info-label"},"Tournament:",-1)),p("span",Ib,P(L(n).tournamentConfig?.tournamentName||"Untitled Tournament"),1)]),p("div",Rb,[u[15]||(u[15]=p("span",{class:"info-label"},"Date:",-1)),p("span",Pb,P(i.value),1)]),p("div",kb,[u[16]||(u[16]=p("span",{class:"info-label"},"Duration:",-1)),p("span",xb,P(o.value),1)])])]),p("div",{class:"results-actions"},[p("button",{onClick:a,class:"action-btn primary"}," 🎯 New Tournament "),p("button",{onClick:c,class:"action-btn secondary"}," 🏠 Back to Menu ")])])]))}}),Nb=kt(Ab,[["__scopeId","data-v-bf684284"]]),Lb=()=>{};var dc={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $d={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(t,e){if(!t)throw is(e)},is=function(t){return new Error("Firebase Database ("+$d.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Ob=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],a=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(a>>10)),e[s++]=String.fromCharCode(56320+(a&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},_l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,a=r+2<t.length,c=a?t[r+2]:0,d=i>>2,u=(i&3)<<4|l>>4;let h=(l&15)<<2|c>>6,f=c&63;a||(f=64,o||(h=64)),s.push(n[d],n[u],n[h],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ud(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ob(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const u=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||c==null||u==null)throw new Mb;const h=i<<2|l>>4;if(s.push(h),c!==64){const f=l<<4&240|c>>2;if(s.push(f),u!==64){const _=c<<6&192|u;s.push(_)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Mb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Hd=function(t){const e=Ud(t);return _l.encodeByteArray(e,!0)},jr=function(t){return Hd(t).replace(/\./g,"")},No=function(t){try{return _l.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){return Wd(void 0,t)}function Wd(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Fb(n)||(t[n]=Wd(t[n],e[n]));return t}function Fb(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=()=>$b().__FIREBASE_DEFAULTS__,Hb=()=>{if(typeof process>"u"||typeof dc>"u")return;const t=dc.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Wb=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&No(t[1]);return e&&JSON.parse(e)},Bd=()=>{try{return Lb()||Ub()||Hb()||Wb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Bb=t=>Bd()?.emulatorHosts?.[t],Vb=t=>{const e=Bb(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Vd=()=>Bd()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Gb(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[jr(JSON.stringify(n)),jr(JSON.stringify(o)),""].join(".")}const Ns={};function qb(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ns))Ns[e]?t.emulator.push(e):t.prod.push(e);return t}function Kb(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let hc=!1;function zb(t,e){if(typeof window>"u"||typeof document>"u"||!yl(window.location.host)||Ns[t]===e||Ns[t]||hc)return;Ns[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=qb().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function a(h,f){h.setAttribute("width","24"),h.setAttribute("id",f),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function c(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{hc=!0,o()},h}function d(h,f){h.setAttribute("id",f),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function u(){const h=Kb(s),f=n("text"),_=document.getElementById(f)||document.createElement("span"),C=n("learnmore"),S=document.getElementById(C)||document.createElement("a"),b=n("preprendIcon"),E=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const I=h.element;l(I),d(S,C);const T=c();a(E,b),I.append(E,_,S,T),document.body.appendChild(I)}i?(_.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gd(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yb())}function Qb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Jb(){return $d.NODE_ADMIN===!0}function Xb(){try{return typeof indexedDB=="object"}catch{return!1}}function Zb(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="FirebaseError";class ar extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=eC,Object.setPrototypeOf(this,ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jd.prototype.create)}}class jd{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?tC(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new ar(r,l,s)}}function tC(t,e){return t.replace(nC,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const nC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t){return JSON.parse(t)}function He(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=js(No(i[0])||""),n=js(No(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},sC=function(t){const e=qd(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},rC=function(t){const e=qd(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xn(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function fc(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qr(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function Kr(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(pc(i)&&pc(o)){if(!Kr(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function pc(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let u=0;u<16;u++)s[u]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let u=0;u<16;u++)s[u]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let u=16;u<80;u++){const h=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=(h<<1|h>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,d;for(let u=0;u<80;u++){u<40?u<20?(c=l^i&(o^l),d=1518500249):(c=i^o^l,d=1859775393):u<60?(c=i&o|l&(i|o),d=2400959708):(c=i^o^l,d=3395469782);const h=(r<<5|r>>>27)+c+a+d+s[u]&4294967295;a=l,l=o,o=(i<<30|i>>>2)&4294967295,i=r,r=h}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function Ti(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,$(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Ii=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(t){return t&&t._delegate?t._delegate:t}class qs{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new lr;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uC(e))try{this.getOrInitializeService({instanceIdentifier:In})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=In){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=In){return this.instances.has(e)}getOptions(e=In){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:cC(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=In){return this.component?this.component.multipleInstances?e:In:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cC(t){return t===In?void 0:t}function uC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new aC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const hC={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},fC=xe.INFO,pC={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},mC=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=pC[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kd{constructor(e){this.name=e,this._logLevel=fC,this._logHandler=mC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const gC=(t,e)=>e.some(n=>t instanceof n);let mc,gc;function _C(){return mc||(mc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yC(){return gc||(gc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zd=new WeakMap,Lo=new WeakMap,Yd=new WeakMap,no=new WeakMap,vl=new WeakMap;function vC(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(un(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&zd.set(n,t)}).catch(()=>{}),vl.set(e,t),e}function bC(t){if(Lo.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Lo.set(t,e)}let Oo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Lo.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Yd.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return un(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function CC(t){Oo=t(Oo)}function wC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(so(this),e,...n);return Yd.set(s,e.sort?e.sort():[e]),un(s)}:yC().includes(t)?function(...e){return t.apply(so(this),e),un(zd.get(this))}:function(...e){return un(t.apply(so(this),e))}}function EC(t){return typeof t=="function"?wC(t):(t instanceof IDBTransaction&&bC(t),gC(t,_C())?new Proxy(t,Oo):t)}function un(t){if(t instanceof IDBRequest)return vC(t);if(no.has(t))return no.get(t);const e=EC(t);return e!==t&&(no.set(t,e),vl.set(e,t)),e}const so=t=>vl.get(t);function SC(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),l=un(o);return s&&o.addEventListener("upgradeneeded",a=>{s(un(o.result),a.oldVersion,a.newVersion,un(o.transaction),a)}),n&&o.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{i&&a.addEventListener("close",()=>i()),r&&a.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const TC=["get","getKey","getAll","getAllKeys","count"],IC=["put","add","delete","clear"],ro=new Map;function _c(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ro.get(e))return ro.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=IC.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||TC.includes(n)))return;const i=async function(o,...l){const a=this.transaction(o,r?"readwrite":"readonly");let c=a.store;return s&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),r&&a.done]))[0]};return ro.set(e,i),i}CC(t=>({...t,get:(e,n,s)=>_c(e,n)||t.get(e,n,s),has:(e,n)=>!!_c(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(PC(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function PC(t){return t.getComponent()?.type==="VERSION"}const Mo="@firebase/app",yc="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt=new Kd("@firebase/app"),kC="@firebase/app-compat",xC="@firebase/analytics-compat",AC="@firebase/analytics",NC="@firebase/app-check-compat",LC="@firebase/app-check",OC="@firebase/auth",MC="@firebase/auth-compat",DC="@firebase/database",FC="@firebase/data-connect",$C="@firebase/database-compat",UC="@firebase/functions",HC="@firebase/functions-compat",WC="@firebase/installations",BC="@firebase/installations-compat",VC="@firebase/messaging",GC="@firebase/messaging-compat",jC="@firebase/performance",qC="@firebase/performance-compat",KC="@firebase/remote-config",zC="@firebase/remote-config-compat",YC="@firebase/storage",QC="@firebase/storage-compat",JC="@firebase/firestore",XC="@firebase/ai",ZC="@firebase/firestore-compat",e1="firebase",t1="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="[DEFAULT]",n1={[Mo]:"fire-core",[kC]:"fire-core-compat",[AC]:"fire-analytics",[xC]:"fire-analytics-compat",[LC]:"fire-app-check",[NC]:"fire-app-check-compat",[OC]:"fire-auth",[MC]:"fire-auth-compat",[DC]:"fire-rtdb",[FC]:"fire-data-connect",[$C]:"fire-rtdb-compat",[UC]:"fire-fn",[HC]:"fire-fn-compat",[WC]:"fire-iid",[BC]:"fire-iid-compat",[VC]:"fire-fcm",[GC]:"fire-fcm-compat",[jC]:"fire-perf",[qC]:"fire-perf-compat",[KC]:"fire-rc",[zC]:"fire-rc-compat",[YC]:"fire-gcs",[QC]:"fire-gcs-compat",[JC]:"fire-fst",[ZC]:"fire-fst-compat",[XC]:"fire-vertex","fire-js":"fire-js",[e1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new Map,s1=new Map,Fo=new Map;function vc(t,e){try{t.container.addComponent(e)}catch(n){Qt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Yr(t){const e=t.name;if(Fo.has(e))return Qt.debug(`There were multiple attempts to register component ${e}.`),!1;Fo.set(e,t);for(const n of zr.values())vc(n,t);for(const n of s1.values())vc(n,t);return!0}function r1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function i1(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dn=new jd("app","Firebase",o1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new qs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1=t1;function Qd(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Do,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw dn.create("bad-app-name",{appName:String(r)});if(n||(n=Vd()),!n)throw dn.create("no-options");const i=zr.get(r);if(i){if(Kr(n,i.options)&&Kr(s,i.config))return i;throw dn.create("duplicate-app",{appName:r})}const o=new dC(r);for(const a of Fo.values())o.addComponent(a);const l=new l1(n,s,o);return zr.set(r,l),l}function c1(t=Do){const e=zr.get(t);if(!e&&t===Do&&Vd())return Qd();if(!e)throw dn.create("no-app",{appName:t});return e}function qn(t,e,n){let s=n1[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qt.warn(o.join(" "));return}Yr(new qs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="firebase-heartbeat-database",d1=1,Ks="firebase-heartbeat-store";let io=null;function Jd(){return io||(io=SC(u1,d1,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ks)}catch(n){console.warn(n)}}}}).catch(t=>{throw dn.create("idb-open",{originalErrorMessage:t.message})})),io}async function h1(t){try{const n=(await Jd()).transaction(Ks),s=await n.objectStore(Ks).get(Xd(t));return await n.done,s}catch(e){if(e instanceof ar)Qt.warn(e.message);else{const n=dn.create("idb-get",{originalErrorMessage:e?.message});Qt.warn(n.message)}}}async function bc(t,e){try{const s=(await Jd()).transaction(Ks,"readwrite");await s.objectStore(Ks).put(e,Xd(t)),await s.done}catch(n){if(n instanceof ar)Qt.warn(n.message);else{const s=dn.create("idb-set",{originalErrorMessage:n?.message});Qt.warn(s.message)}}}function Xd(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1=1024,p1=30;class m1{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _1(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Cc();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>p1){const r=y1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Qt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Cc(),{heartbeatsToSend:n,unsentEntries:s}=g1(this._heartbeatsCache.heartbeats),r=jr(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Qt.warn(e),""}}}function Cc(){return new Date().toISOString().substring(0,10)}function g1(t,e=f1){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),wc(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),wc(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class _1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xb()?Zb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await h1(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return bc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return bc(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function wc(t){return jr(JSON.stringify({version:2,heartbeats:t})).length}function y1(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(t){Yr(new qs("platform-logger",e=>new RC(e),"PRIVATE")),Yr(new qs("heartbeat",e=>new m1(e),"PRIVATE")),qn(Mo,yc,t),qn(Mo,yc,"esm2020"),qn("fire-js","")}v1("");var b1="firebase",C1="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn(b1,C1,"app");var Ec={};const Sc="@firebase/database",Tc="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zd="";function w1(t){Zd=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),He(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:js(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return $t(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new E1(e)}}catch{}return new S1},Pn=eh("localStorage"),T1=eh("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new Kd("@firebase/database"),I1=function(){let t=1;return function(){return t++}}(),th=function(t){const e=lC(t),n=new oC;n.update(e);const s=n.digest();return _l.encodeByteArray(s)},cr=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=cr.apply(null,s):typeof s=="object"?e+=He(s):e+=s,e+=" "}return e};let Ls=null,Ic=!0;const R1=function(t,e){$(!0,"Can't turn on custom loggers persistently."),Kn.logLevel=xe.VERBOSE,Ls=Kn.log.bind(Kn)},Ye=function(...t){if(Ic===!0&&(Ic=!1,Ls===null&&T1.get("logging_enabled")===!0&&R1()),Ls){const e=cr.apply(null,t);Ls(e)}},ur=function(t){return function(...e){Ye(t,...e)}},$o=function(...t){const e="FIREBASE INTERNAL ERROR: "+cr(...t);Kn.error(e)},Jt=function(...t){const e=`FIREBASE FATAL ERROR: ${cr(...t)}`;throw Kn.error(e),new Error(e)},it=function(...t){const e="FIREBASE WARNING: "+cr(...t);Kn.warn(e)},P1=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&it("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},bl=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},k1=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Zn="[MIN_NAME]",An="[MAX_NAME]",On=function(t,e){if(t===e)return 0;if(t===Zn||e===An)return-1;if(e===Zn||t===An)return 1;{const n=Rc(t),s=Rc(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},x1=function(t,e){return t===e?0:t<e?-1:1},ps=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+He(e))},Cl=function(t){if(typeof t!="object"||t===null)return He(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=He(e[s]),n+=":",n+=Cl(t[e[s]]);return n+="}",n},nh=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function Je(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const sh=function(t){$(!bl(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,l,a;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=l+s,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(a=n;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(a=e;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(r?1:0),c.reverse();const d=c.join("");let u="";for(a=0;a<64;a+=8){let h=parseInt(d.substr(a,8),2).toString(16);h.length===1&&(h="0"+h),u=u+h}return u.toLowerCase()},A1=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},N1=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function L1(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const O1=new RegExp("^-?(0*)\\d{1,10}$"),M1=-2147483648,D1=2147483647,Rc=function(t){if(O1.test(t)){const e=Number(t);if(e>=M1&&e<=D1)return e}return null},ls=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw it("Exception was thrown by user callback.",n),e},Math.floor(0))}},F1=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Os=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,i1(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){it(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ye("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',it(e)}}class Mr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Mr.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl="5",rh="v",ih="s",oh="r",lh="f",ah=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ch="ls",uh="p",Uo="ac",dh="websocket",hh="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n,s,r,i=!1,o="",l=!1,a=!1,c=null){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Pn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Pn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function H1(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function ph(t,e,n){$(typeof e=="string","typeof type must == string"),$(typeof n=="object","typeof params must == object");let s;if(e===dh)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===hh)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);H1(t)&&(n.ns=t.namespace);const r=[];return Je(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.counters_={}}incrementCounter(e,n=1){$t(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Db(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo={},lo={};function El(t){const e=t.toString();return oo[e]||(oo[e]=new W1),oo[e]}function B1(t,e){const n=t.toString();return lo[n]||(lo[n]=e()),lo[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&ls(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc="start",G1="close",j1="pLPCommand",q1="pRTLPCB",mh="id",gh="pw",_h="ser",K1="cb",z1="seg",Y1="ts",Q1="d",J1="dframe",yh=1870,vh=30,X1=yh-vh,Z1=25e3,ew=3e4;class Bn{constructor(e,n,s,r,i,o,l){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ur(e),this.stats_=El(n),this.urlFn=a=>(this.appCheckToken&&(a[Uo]=this.appCheckToken),ph(n,hh,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new V1(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(ew)),k1(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Sl((...i)=>{const[o,l,a,c,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Pc)this.id=l,this.password=a;else if(o===G1)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const s={};s[Pc]="t",s[_h]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[K1]=this.scriptTagHolder.uniqueCallbackIdentifier),s[rh]=wl,this.transportSessionId&&(s[ih]=this.transportSessionId),this.lastSessionId&&(s[ch]=this.lastSessionId),this.applicationId&&(s[uh]=this.applicationId),this.appCheckToken&&(s[Uo]=this.appCheckToken),typeof location<"u"&&location.hostname&&ah.test(location.hostname)&&(s[oh]=lh);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Bn.forceAllow_=!0}static forceDisallow(){Bn.forceDisallow_=!0}static isAvailable(){return Bn.forceAllow_?!0:!Bn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!A1()&&!N1()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=He(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Hd(n),r=nh(s,X1);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[J1]="t",s[mh]=e,s[gh]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=He(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Sl{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=I1(),window[j1+this.uniqueCallbackIdentifier]=e,window[q1+this.uniqueCallbackIdentifier]=n,this.myIFrame=Sl.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Ye("frame writing exception"),l.stack&&Ye(l.stack),Ye(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ye("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[mh]=this.myID,e[gh]=this.myPW,e[_h]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+vh+s.length<=yh;){const o=this.pendingSegs.shift();s=s+"&"+z1+r+"="+o.seg+"&"+Y1+r+"="+o.ts+"&"+Q1+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(Z1)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Ye("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=16384,nw=45e3;let Qr=null;typeof MozWebSocket<"u"?Qr=MozWebSocket:typeof WebSocket<"u"&&(Qr=WebSocket);class Et{constructor(e,n,s,r,i,o,l){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ur(this.connId),this.stats_=El(n),this.connURL=Et.connectionURL_(n,o,l,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[rh]=wl,typeof location<"u"&&location.hostname&&ah.test(location.hostname)&&(o[oh]=lh),n&&(o[ih]=n),s&&(o[ch]=s),r&&(o[Uo]=r),i&&(o[uh]=i),ph(e,dh,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Pn.set("previous_websocket_failure",!0);try{let s;Jb(),this.mySock=new Qr(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Et.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Qr!==null&&!Et.forceDisallow_}static previouslyFailed(){return Pn.isInMemoryStorage||Pn.get("previous_websocket_failure")===!0}markConnectionHealthy(){Pn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=js(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if($(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=He(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=nh(n,tw);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(nw))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Et.responsesRequiredToBeHealthy=2;Et.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{static get ALL_TRANSPORTS(){return[Bn,Et]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Et&&Et.isAvailable();let s=n&&!Et.previouslyFailed();if(e.webSocketOnly&&(n||it("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Et];else{const r=this.transports_=[];for(const i of zs.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);zs.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}zs.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw=6e4,rw=5e3,iw=10*1024,ow=100*1024,ao="t",kc="d",lw="s",xc="r",aw="e",Ac="o",Nc="a",Lc="n",Oc="p",cw="h";class uw{constructor(e,n,s,r,i,o,l,a,c,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ur("c:"+this.id+":"),this.transportManager_=new zs(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Os(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>ow?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>iw?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ao in e){const n=e[ao];n===Nc?this.upgradeIfSecondaryHealthy_():n===xc?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Ac&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=ps("t",e),s=ps("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Oc,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Nc,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Lc,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=ps("t",e),s=ps("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=ps(ao,e);if(kc in e){const s=e[kc];if(n===cw){const r={...s};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===Lc){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===lw?this.onConnectionShutdown_(s):n===xc?this.onReset_(s):n===aw?$o("Server Error: "+s):n===Ac?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$o("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),wl!==s&&it("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Os(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(sw))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Os(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(rw))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Oc,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Pn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){$(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends Ch{static getInstance(){return new Jr}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Gd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=32,Dc=768;class Se{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ye(){return new Se("")}function ce(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function _n(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Se(t.pieces_,e)}function Tl(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function dw(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ys(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function wh(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Se(e,0)}function Oe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Se)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Se(n,0)}function de(t){return t.pieceNum_>=t.pieces_.length}function rt(t,e){const n=ce(t),s=ce(e);if(n===null)return e;if(n===s)return rt(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function hw(t,e){const n=Ys(t,0),s=Ys(e,0);for(let r=0;r<n.length&&r<s.length;r++){const i=On(n[r],s[r]);if(i!==0)return i}return n.length===s.length?0:n.length<s.length?-1:1}function Il(t,e){if(_n(t)!==_n(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function bt(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(_n(t)>_n(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class fw{constructor(e,n){this.errorPrefix_=n,this.parts_=Ys(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Ii(this.parts_[s]);Eh(this)}}function pw(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Ii(e),Eh(t)}function mw(t){const e=t.parts_.pop();t.byteLength_-=Ii(e),t.parts_.length>0&&(t.byteLength_-=1)}function Eh(t){if(t.byteLength_>Dc)throw new Error(t.errorPrefix_+"has a key path longer than "+Dc+" bytes ("+t.byteLength_+").");if(t.parts_.length>Mc)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mc+") or object contains a cycle "+Rn(t))}function Rn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends Ch{static getInstance(){return new Rl}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=1e3,gw=300*1e3,Fc=30*1e3,_w=1.3,yw=3e4,vw="server_kill",$c=3;class Kt extends bh{constructor(e,n,s,r,i,o,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Kt.nextPersistentConnectionId_++,this.log_=ur("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ms,this.maxReconnectDelay_=gw,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Rl.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Jr.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(He(i)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new lr,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const l={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,l=>{const a=l.d,c=l.s;Kt.warnOnListenWarnings_(a,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&$t(e,"w")){const s=Xn(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();it(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||rC(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Fc)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=sC(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+He(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):$o("Unrecognized action received from server: "+He(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ms,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ms,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>yw&&(this.reconnectDelay_=ms),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*_w)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Kt.nextConnectionId_++,i=this.lastSessionId;let o=!1,l=null;const a=function(){l?l.close():(o=!0,s())},c=function(u){$(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(u)};this.realtime_={close:a,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?Ye("getToken() completed but was canceled"):(Ye("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=h&&h.token,l=new uw(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{it(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(vw)},i))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&it(u),a())}}}interrupt(e){Ye("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ye("Resuming connection for reason: "+e),delete this.interruptReasons_[e],fc(this.interruptReasons_)&&(this.reconnectDelay_=ms,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>Cl(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Se(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){Ye("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=$c&&(this.reconnectDelay_=Fc,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ye("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=$c&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Zd.replace(/\./g,"-")]=1,Gd()?e["framework.cordova"]=1:Qb()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Jr.getInstance().currentlyOnline();return fc(this.interruptReasons_)&&e}}Kt.nextPersistentConnectionId_=0;Kt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ue(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new ue(Zn,e),r=new ue(Zn,n);return this.compare(s,r)!==0}minPost(){return ue.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ir;class Sh extends Ri{static get __EMPTY_NODE(){return Ir}static set __EMPTY_NODE(e){Ir=e}compare(e,n){return On(e.name,n.name)}isDefinedOn(e){throw is("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ue.MIN}maxPost(){return new ue(An,Ir)}makePost(e,n){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new ue(e,Ir)}toString(){return".key"}}const zn=new Sh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class qe{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??qe.RED,this.left=r??ct.EMPTY_NODE,this.right=i??ct.EMPTY_NODE}copy(e,n,s,r,i){return new qe(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return ct.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return ct.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,qe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,qe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}qe.RED=!0;qe.BLACK=!1;class bw{copy(e,n,s,r,i){return this}insert(e,n,s){return new qe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ct{constructor(e,n=ct.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new ct(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,qe.BLACK,null,null))}remove(e){return new ct(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qe.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Rr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Rr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Rr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Rr(this.root_,null,this.comparator_,!0,e)}}ct.EMPTY_NODE=new bw;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t,e){return On(t.name,e.name)}function Pl(t,e){return On(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ho;function ww(t){Ho=t}const Th=function(t){return typeof t=="number"?"number:"+sh(t):"string:"+t},Ih=function(t){if(t.isLeafNode()){const e=t.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$t(e,".sv"),"Priority must be a string or number.")}else $(t===Ho||t.isEmpty(),"priority of unexpected type.");$(t===Ho||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc;class je{static set __childrenNodeConstructor(e){Uc=e}static get __childrenNodeConstructor(){return Uc}constructor(e,n=je.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ih(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new je(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:je.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return de(e)?this:ce(e)===".priority"?this.priorityNode_:je.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:je.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ce(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:($(s!==".priority"||_n(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,je.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Th(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=sh(this.value_):e+=this.value_,this.lazyHash_=th(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===je.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof je.__childrenNodeConstructor?-1:($(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=je.VALUE_TYPE_ORDER.indexOf(n),i=je.VALUE_TYPE_ORDER.indexOf(s);return $(r>=0,"Unknown leaf type: "+n),$(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}je.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rh,Ph;function Ew(t){Rh=t}function Sw(t){Ph=t}class Tw extends Ri{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?On(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ue.MIN}maxPost(){return new ue(An,new je("[PRIORITY-POST]",Ph))}makePost(e,n){const s=Rh(e);return new ue(n,new je("[PRIORITY-POST]",s))}toString(){return".priority"}}const Me=new Tw;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw=Math.log(2);class Rw{constructor(e){const n=i=>parseInt(Math.log(i)/Iw,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Xr=function(t,e,n,s){t.sort(e);const r=function(a,c){const d=c-a;let u,h;if(d===0)return null;if(d===1)return u=t[a],h=n?n(u):u,new qe(h,u.node,qe.BLACK,null,null);{const f=parseInt(d/2,10)+a,_=r(a,f),C=r(f+1,c);return u=t[f],h=n?n(u):u,new qe(h,u.node,qe.BLACK,_,C)}},i=function(a){let c=null,d=null,u=t.length;const h=function(_,C){const S=u-_,b=u;u-=_;const E=r(S+1,b),I=t[S],T=n?n(I):I;f(new qe(T,I.node,C,null,E))},f=function(_){c?(c.left=_,c=_):(d=_,c=_)};for(let _=0;_<a.count;++_){const C=a.nextBitIsOne(),S=Math.pow(2,a.count-(_+1));C?h(S,qe.BLACK):(h(S,qe.BLACK),h(S,qe.RED))}return d},o=new Rw(t.length),l=i(o);return new ct(s||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let co;const $n={};class jt{static get Default(){return $($n&&Me,"ChildrenNode.ts has not been loaded"),co=co||new jt({".priority":$n},{".priority":Me}),co}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Xn(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ct?n:null}hasIndex(e){return $t(this.indexSet_,e.toString())}addIndex(e,n){$(e!==zn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(ue.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let l;r?l=Xr(s,e.getCompare()):l=$n;const a=e.toString(),c={...this.indexSet_};c[a]=e;const d={...this.indexes_};return d[a]=l,new jt(d,c)}addToIndexes(e,n){const s=qr(this.indexes_,(r,i)=>{const o=Xn(this.indexSet_,i);if($(o,"Missing index implementation for "+i),r===$n)if(o.isDefinedOn(e.node)){const l=[],a=n.getIterator(ue.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),Xr(l,o.getCompare())}else return $n;else{const l=n.get(e.name);let a=r;return l&&(a=a.remove(new ue(e.name,l))),a.insert(e,e.node)}});return new jt(s,this.indexSet_)}removeFromIndexes(e,n){const s=qr(this.indexes_,r=>{if(r===$n)return r;{const i=n.get(e.name);return i?r.remove(new ue(e.name,i)):r}});return new jt(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gs;class ne{static get EMPTY_NODE(){return gs||(gs=new ne(new ct(Pl),null,jt.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Ih(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||gs}updatePriority(e){return this.children_.isEmpty()?this:new ne(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?gs:n}}getChild(e){const n=ce(e);return n===null?this:this.getImmediateChild(n).getChild(Ae(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if($(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new ue(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?gs:this.priorityNode_;return new ne(r,o,i)}}updateChild(e,n){const s=ce(e);if(s===null)return n;{$(ce(e)!==".priority"||_n(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Ae(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(Me,(o,l)=>{n[o]=l.val(e),s++,i&&ne.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Th(this.getPriority().val())+":"),this.forEachChild(Me,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":th(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new ue(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ue(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ue(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,ue.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,ue.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===dr?-1:0}withIndex(e){if(e===zn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ne(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===zn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Me),r=n.getIterator(Me);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===zn?null:this.indexMap_.get(e.toString())}}ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Pw extends ne{constructor(){super(new ct(Pl),ne.EMPTY_NODE,jt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ne.EMPTY_NODE}isEmpty(){return!1}}const dr=new Pw;Object.defineProperties(ue,{MIN:{value:new ue(Zn,ne.EMPTY_NODE)},MAX:{value:new ue(An,dr)}});Sh.__EMPTY_NODE=ne.EMPTY_NODE;je.__childrenNodeConstructor=ne;ww(dr);Sw(dr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=!0;function Ue(t,e=null){if(t===null)return ne.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new je(n,Ue(e))}if(!(t instanceof Array)&&kw){const n=[];let s=!1;if(Je(t,(o,l)=>{if(o.substring(0,1)!=="."){const a=Ue(l);a.isEmpty()||(s=s||!a.getPriority().isEmpty(),n.push(new ue(o,a)))}}),n.length===0)return ne.EMPTY_NODE;const i=Xr(n,Cw,o=>o.name,Pl);if(s){const o=Xr(n,Me.getCompare());return new ne(i,Ue(e),new jt({".priority":o},{".priority":Me}))}else return new ne(i,Ue(e),jt.Default)}else{let n=ne.EMPTY_NODE;return Je(t,(s,r)=>{if($t(t,s)&&s.substring(0,1)!=="."){const i=Ue(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Ue(e))}}Ew(Ue);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw extends Ri{constructor(e){super(),this.indexPath_=e,$(!de(e)&&ce(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?On(e.name,n.name):i}makePost(e,n){const s=Ue(e),r=ne.EMPTY_NODE.updateChild(this.indexPath_,s);return new ue(n,r)}maxPost(){const e=ne.EMPTY_NODE.updateChild(this.indexPath_,dr);return new ue(An,e)}toString(){return Ys(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw extends Ri{compare(e,n){const s=e.node.compareTo(n.node);return s===0?On(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ue.MIN}maxPost(){return ue.MAX}makePost(e,n){const s=Ue(e);return new ue(n,s)}toString(){return".value"}}const Nw=new Aw;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t){return{type:"value",snapshotNode:t}}function es(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Qs(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Js(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Lw(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(r).equals(s.getChild(r))&&l.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Qs(n,l)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(es(n,s)):o.trackChildChange(Js(n,s,l))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Me,(r,i)=>{n.hasChild(r)||s.trackChildChange(Qs(r,i))}),n.isLeafNode()||n.forEachChild(Me,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Js(r,i,o))}else s.trackChildChange(es(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ne.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e){this.indexedFilter_=new kl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Xs.getStartPost_(e),this.endPost_=Xs.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,r,i,o){return this.matches(new ue(n,s))||(s=ne.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=ne.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(ne.EMPTY_NODE);const i=this;return n.forEachChild(Me,(o,l)=>{i.matches(new ue(o,l))||(r=r.updateImmediateChild(o,ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Xs(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new ue(n,s))||(s=ne.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=ne.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))r=r.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(ne.EMPTY_NODE);let i;this.reverse_?i=r.getReverseIterator(this.index_):i=r.getIterator(this.index_);let o=0;for(;i.hasNext();){const l=i.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:r=r.updateImmediateChild(l.name,ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const u=this.index_.getCompare();o=(h,f)=>u(f,h)}else o=this.index_.getCompare();const l=e;$(l.numChildren()===this.limit_,"");const a=new ue(n,s),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),d=this.rangedFilter_.matches(a);if(l.hasChild(n)){const u=l.getImmediateChild(n);let h=r.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||l.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);const f=h==null?1:o(h,a);if(d&&!s.isEmpty()&&f>=0)return i?.trackChildChange(Js(n,s,u)),l.updateImmediateChild(n,s);{i?.trackChildChange(Qs(n,u));const C=l.updateImmediateChild(n,ne.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(i?.trackChildChange(es(h.name,h.node)),C.updateImmediateChild(h.name,h.node)):C}}else return s.isEmpty()?e:d&&o(c,a)>=0?(i!=null&&(i.trackChildChange(Qs(c.name,c.node)),i.trackChildChange(es(n,s))),l.updateImmediateChild(n,s).updateImmediateChild(c.name,ne.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Me}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Zn}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:An}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Me}copy(){const e=new xl;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Mw(t){return t.loadsAllData()?new kl(t.getIndex()):t.hasLimit()?new Ow(t):new Xs(t)}function Hc(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Me?n="$priority":t.index_===Nw?n="$value":t.index_===zn?n="$key":($(t.index_ instanceof xw,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=He(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=He(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+He(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=He(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+He(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Wc(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Me&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends bh{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=ur("p:rest:"),this.listens_={}}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Zr.getListenId_(e,s),l={};this.listens_[o]=l;const a=Hc(e._queryParams);this.restRequest_(i+".json",a,(c,d)=>{let u=d;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(i,u,!1,s),Xn(this.listens_,o)===l){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",r(h,null)}})}unlisten(e,n){const s=Zr.getListenId_(e,n);delete this.listens_[s]}get(e){const n=Hc(e._queryParams),s=e._path.toString(),r=new lr;return this.restRequest_(s+".json",n,(i,o)=>{let l=o;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(s,l,!1,null),r.resolve(l)):r.reject(new Error(l))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+iC(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=js(l.responseText)}catch{it("Failed to parse JSON response for "+o+": "+l.responseText)}s(null,a)}else l.status!==401&&l.status!==404&&it("Got unsuccessful REST response for "+o+" Status: "+l.status),s(l.status);s=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(){this.rootNode_=ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return{value:null,children:new Map}}function xh(t,e,n){if(de(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ce(e);t.children.has(s)||t.children.set(s,ei());const r=t.children.get(s);e=Ae(e),xh(r,e,n)}}function Wo(t,e,n){t.value!==null?n(e,t.value):Fw(t,(s,r)=>{const i=new Se(e.toString()+"/"+s);Wo(r,i,n)})}function Fw(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Je(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc=10*1e3,Uw=30*1e3,Hw=300*1e3;class Ww{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new $w(e);const s=Bc+(Uw-Bc)*Math.random();Os(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Je(e,(r,i)=>{i>0&&$t(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),Os(this.reportStats_.bind(this),Math.floor(Math.random()*2*Hw))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(St||(St={}));function Al(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Nl(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Ll(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=St.ACK_USER_WRITE,this.source=Al()}operationForChild(e){if(de(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Se(e));return new ti(ye(),n,this.revert)}}else return $(ce(this.path)===e,"operationForChild called for unrelated child."),new ti(Ae(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n){this.source=e,this.path=n,this.type=St.LISTEN_COMPLETE}operationForChild(e){return de(this.path)?new Zs(this.source,ye()):new Zs(this.source,Ae(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=St.OVERWRITE}operationForChild(e){return de(this.path)?new Nn(this.source,ye(),this.snap.getImmediateChild(e)):new Nn(this.source,Ae(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=St.MERGE}operationForChild(e){if(de(this.path)){const n=this.children.subtree(new Se(e));return n.isEmpty()?null:n.value?new Nn(this.source,ye(),n.value):new ts(this.source,ye(),n)}else return $(ce(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ts(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(de(e))return this.isFullyInitialized()&&!this.filtered_;const n=ce(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Vw(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(Lw(o.childName,o.snapshotNode))}),_s(t,r,"child_removed",e,s,n),_s(t,r,"child_added",e,s,n),_s(t,r,"child_moved",i,s,n),_s(t,r,"child_changed",e,s,n),_s(t,r,"value",e,s,n),r}function _s(t,e,n,s,r,i){const o=s.filter(l=>l.type===n);o.sort((l,a)=>jw(t,l,a)),o.forEach(l=>{const a=Gw(t,l,i);r.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,t.query_))})})}function Gw(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function jw(t,e,n){if(e.childName==null||n.childName==null)throw is("Should only compare child_ events.");const s=new ue(e.childName,e.snapshotNode),r=new ue(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(t,e){return{eventCache:t,serverCache:e}}function Ms(t,e,n,s){return Pi(new yn(e,n,s),t.serverCache)}function Ah(t,e,n,s){return Pi(t.eventCache,new yn(e,n,s))}function ni(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ln(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uo;const qw=()=>(uo||(uo=new ct(x1)),uo);class ke{static fromObject(e){let n=new ke(null);return Je(e,(s,r)=>{n=n.set(new Se(s),r)}),n}constructor(e,n=qw()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ye(),value:this.value};if(de(e))return null;{const s=ce(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Ae(e),n);return i!=null?{path:Oe(new Se(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(de(e))return this;{const n=ce(e),s=this.children.get(n);return s!==null?s.subtree(Ae(e)):new ke(null)}}set(e,n){if(de(e))return new ke(n,this.children);{const s=ce(e),i=(this.children.get(s)||new ke(null)).set(Ae(e),n),o=this.children.insert(s,i);return new ke(this.value,o)}}remove(e){if(de(e))return this.children.isEmpty()?new ke(null):new ke(null,this.children);{const n=ce(e),s=this.children.get(n);if(s){const r=s.remove(Ae(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new ke(null):new ke(this.value,i)}else return this}}get(e){if(de(e))return this.value;{const n=ce(e),s=this.children.get(n);return s?s.get(Ae(e)):null}}setTree(e,n){if(de(e))return n;{const s=ce(e),i=(this.children.get(s)||new ke(null)).setTree(Ae(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new ke(this.value,o)}}fold(e){return this.fold_(ye(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Oe(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,ye(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(de(e))return null;{const i=ce(e),o=this.children.get(i);return o?o.findOnPath_(Ae(e),Oe(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ye(),n)}foreachOnPath_(e,n,s){if(de(e))return this;{this.value&&s(n,this.value);const r=ce(e),i=this.children.get(r);return i?i.foreachOnPath_(Ae(e),Oe(n,r),s):new ke(null)}}foreach(e){this.foreach_(ye(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Oe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.writeTree_=e}static empty(){return new Rt(new ke(null))}}function Ds(t,e,n){if(de(e))return new Rt(new ke(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=rt(r,e);return i=i.updateChild(o,n),new Rt(t.writeTree_.set(r,i))}else{const r=new ke(n),i=t.writeTree_.setTree(e,r);return new Rt(i)}}}function Bo(t,e,n){let s=t;return Je(n,(r,i)=>{s=Ds(s,Oe(e,r),i)}),s}function Vc(t,e){if(de(e))return Rt.empty();{const n=t.writeTree_.setTree(e,new ke(null));return new Rt(n)}}function Vo(t,e){return Mn(t,e)!=null}function Mn(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(rt(n.path,e)):null}function Gc(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Me,(s,r)=>{e.push(new ue(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new ue(s,r.value))}),e}function hn(t,e){if(de(e))return t;{const n=Mn(t,e);return n!=null?new Rt(new ke(n)):new Rt(t.writeTree_.subtree(e))}}function Go(t){return t.writeTree_.isEmpty()}function ns(t,e){return Nh(ye(),t.writeTree_,e)}function Nh(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?($(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=Nh(Oe(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Oe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(t,e){return Dh(e,t)}function Kw(t,e,n,s,r){$(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=Ds(t.visibleWrites,e,n)),t.lastWriteId=s}function zw(t,e,n,s){$(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=Bo(t.visibleWrites,e,n),t.lastWriteId=s}function Yw(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function Qw(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);$(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&Jw(l,s.path)?r=!1:bt(s.path,l.path)&&(i=!0)),o--}if(r){if(i)return Xw(t),!0;if(s.snap)t.visibleWrites=Vc(t.visibleWrites,s.path);else{const l=s.children;Je(l,a=>{t.visibleWrites=Vc(t.visibleWrites,Oe(s.path,a))})}return!0}else return!1}function Jw(t,e){if(t.snap)return bt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&bt(Oe(t.path,n),e))return!0;return!1}function Xw(t){t.visibleWrites=Lh(t.allWrites,Zw,ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Zw(t){return t.visible}function Lh(t,e,n){let s=Rt.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let l;if(i.snap)bt(n,o)?(l=rt(n,o),s=Ds(s,l,i.snap)):bt(o,n)&&(l=rt(o,n),s=Ds(s,ye(),i.snap.getChild(l)));else if(i.children){if(bt(n,o))l=rt(n,o),s=Bo(s,l,i.children);else if(bt(o,n))if(l=rt(o,n),de(l))s=Bo(s,ye(),i.children);else{const a=Xn(i.children,ce(l));if(a){const c=a.getChild(Ae(l));s=Ds(s,ye(),c)}}}else throw is("WriteRecord should have .snap or .children")}}return s}function Oh(t,e,n,s,r){if(!s&&!r){const i=Mn(t.visibleWrites,e);if(i!=null)return i;{const o=hn(t.visibleWrites,e);if(Go(o))return n;if(n==null&&!Vo(o,ye()))return null;{const l=n||ne.EMPTY_NODE;return ns(o,l)}}}else{const i=hn(t.visibleWrites,e);if(!r&&Go(i))return n;if(!r&&n==null&&!Vo(i,ye()))return null;{const o=function(c){return(c.visible||r)&&(!s||!~s.indexOf(c.writeId))&&(bt(c.path,e)||bt(e,c.path))},l=Lh(t.allWrites,o,e),a=n||ne.EMPTY_NODE;return ns(l,a)}}}function eE(t,e,n){let s=ne.EMPTY_NODE;const r=Mn(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Me,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=hn(t.visibleWrites,e);return n.forEachChild(Me,(o,l)=>{const a=ns(hn(i,new Se(o)),l);s=s.updateImmediateChild(o,a)}),Gc(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=hn(t.visibleWrites,e);return Gc(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function tE(t,e,n,s,r){$(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Oe(e,n);if(Vo(t.visibleWrites,i))return null;{const o=hn(t.visibleWrites,i);return Go(o)?r.getChild(n):ns(o,r.getChild(n))}}function nE(t,e,n,s){const r=Oe(e,n),i=Mn(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=hn(t.visibleWrites,r);return ns(o,s.getNode().getImmediateChild(n))}else return null}function sE(t,e){return Mn(t.visibleWrites,e)}function rE(t,e,n,s,r,i,o){let l;const a=hn(t.visibleWrites,e),c=Mn(a,ye());if(c!=null)l=c;else if(n!=null)l=ns(a,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const d=[],u=o.getCompare(),h=i?l.getReverseIteratorFrom(s,o):l.getIteratorFrom(s,o);let f=h.getNext();for(;f&&d.length<r;)u(f,s)!==0&&d.push(f),f=h.getNext();return d}else return[]}function iE(){return{visibleWrites:Rt.empty(),allWrites:[],lastWriteId:-1}}function si(t,e,n,s){return Oh(t.writeTree,t.treePath,e,n,s)}function Ol(t,e){return eE(t.writeTree,t.treePath,e)}function jc(t,e,n,s){return tE(t.writeTree,t.treePath,e,n,s)}function ri(t,e){return sE(t.writeTree,Oe(t.treePath,e))}function oE(t,e,n,s,r,i){return rE(t.writeTree,t.treePath,e,n,s,r,i)}function Ml(t,e,n){return nE(t.writeTree,t.treePath,e,n)}function Mh(t,e){return Dh(Oe(t.treePath,e),t.writeTree)}function Dh(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;$(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),$(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Js(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Qs(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,es(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Js(s,e.snapshotNode,r.oldSnap));else throw is("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Fh=new aE;class Dl{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new yn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ml(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ln(this.viewCache_),i=oE(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(t){return{filter:t}}function uE(t,e){$(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function dE(t,e,n,s,r){const i=new lE;let o,l;if(n.type===St.OVERWRITE){const c=n;c.source.fromUser?o=jo(t,e,c.path,c.snap,s,r,i):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!de(c.path),o=ii(t,e,c.path,c.snap,s,r,l,i))}else if(n.type===St.MERGE){const c=n;c.source.fromUser?o=fE(t,e,c.path,c.children,s,r,i):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),o=qo(t,e,c.path,c.children,s,r,l,i))}else if(n.type===St.ACK_USER_WRITE){const c=n;c.revert?o=gE(t,e,c.path,s,r,i):o=pE(t,e,c.path,c.affectedTree,s,r,i)}else if(n.type===St.LISTEN_COMPLETE)o=mE(t,e,n.path,s,i);else throw is("Unknown operation type: "+n.type);const a=i.getChanges();return hE(e,o,a),{viewCache:o,changes:a}}function hE(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=ni(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(kh(ni(e)))}}function $h(t,e,n,s,r,i){const o=e.eventCache;if(ri(s,n)!=null)return e;{let l,a;if(de(n))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Ln(e),d=c instanceof ne?c:ne.EMPTY_NODE,u=Ol(s,d);l=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const c=si(s,Ln(e));l=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const c=ce(n);if(c===".priority"){$(_n(n)===1,"Can't have a priority with additional path components");const d=o.getNode();a=e.serverCache.getNode();const u=jc(s,n,d,a);u!=null?l=t.filter.updatePriority(d,u):l=o.getNode()}else{const d=Ae(n);let u;if(o.isCompleteForChild(c)){a=e.serverCache.getNode();const h=jc(s,n,o.getNode(),a);h!=null?u=o.getNode().getImmediateChild(c).updateChild(d,h):u=o.getNode().getImmediateChild(c)}else u=Ml(s,c,e.serverCache);u!=null?l=t.filter.updateChild(o.getNode(),c,u,d,r,i):l=o.getNode()}}return Ms(e,l,o.isFullyInitialized()||de(n),t.filter.filtersNodes())}}function ii(t,e,n,s,r,i,o,l){const a=e.serverCache;let c;const d=o?t.filter:t.filter.getIndexedFilter();if(de(n))c=d.updateFullNode(a.getNode(),s,null);else if(d.filtersNodes()&&!a.isFiltered()){const f=a.getNode().updateChild(n,s);c=d.updateFullNode(a.getNode(),f,null)}else{const f=ce(n);if(!a.isCompleteForPath(n)&&_n(n)>1)return e;const _=Ae(n),S=a.getNode().getImmediateChild(f).updateChild(_,s);f===".priority"?c=d.updatePriority(a.getNode(),S):c=d.updateChild(a.getNode(),f,S,_,Fh,null)}const u=Ah(e,c,a.isFullyInitialized()||de(n),d.filtersNodes()),h=new Dl(r,u,i);return $h(t,u,n,r,h,l)}function jo(t,e,n,s,r,i,o){const l=e.eventCache;let a,c;const d=new Dl(r,e,i);if(de(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),a=Ms(e,c,!0,t.filter.filtersNodes());else{const u=ce(n);if(u===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),a=Ms(e,c,l.isFullyInitialized(),l.isFiltered());else{const h=Ae(n),f=l.getNode().getImmediateChild(u);let _;if(de(h))_=s;else{const C=d.getCompleteChild(u);C!=null?Tl(h)===".priority"&&C.getChild(wh(h)).isEmpty()?_=C:_=C.updateChild(h,s):_=ne.EMPTY_NODE}if(f.equals(_))a=e;else{const C=t.filter.updateChild(l.getNode(),u,_,h,d,o);a=Ms(e,C,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function qc(t,e){return t.eventCache.isCompleteForChild(e)}function fE(t,e,n,s,r,i,o){let l=e;return s.foreach((a,c)=>{const d=Oe(n,a);qc(e,ce(d))&&(l=jo(t,l,d,c,r,i,o))}),s.foreach((a,c)=>{const d=Oe(n,a);qc(e,ce(d))||(l=jo(t,l,d,c,r,i,o))}),l}function Kc(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function qo(t,e,n,s,r,i,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;de(n)?c=s:c=new ke(null).setTree(n,s);const d=e.serverCache.getNode();return c.children.inorderTraversal((u,h)=>{if(d.hasChild(u)){const f=e.serverCache.getNode().getImmediateChild(u),_=Kc(t,f,h);a=ii(t,a,new Se(u),_,r,i,o,l)}}),c.children.inorderTraversal((u,h)=>{const f=!e.serverCache.isCompleteForChild(u)&&h.value===null;if(!d.hasChild(u)&&!f){const _=e.serverCache.getNode().getImmediateChild(u),C=Kc(t,_,h);a=ii(t,a,new Se(u),C,r,i,o,l)}}),a}function pE(t,e,n,s,r,i,o){if(ri(r,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(s.value!=null){if(de(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return ii(t,e,n,a.getNode().getChild(n),r,i,l,o);if(de(n)){let c=new ke(null);return a.getNode().forEachChild(zn,(d,u)=>{c=c.set(new Se(d),u)}),qo(t,e,n,c,r,i,l,o)}else return e}else{let c=new ke(null);return s.foreach((d,u)=>{const h=Oe(n,d);a.isCompleteForPath(h)&&(c=c.set(d,a.getNode().getChild(h)))}),qo(t,e,n,c,r,i,l,o)}}function mE(t,e,n,s,r){const i=e.serverCache,o=Ah(e,i.getNode(),i.isFullyInitialized()||de(n),i.isFiltered());return $h(t,o,n,s,Fh,r)}function gE(t,e,n,s,r,i){let o;if(ri(s,n)!=null)return e;{const l=new Dl(s,e,r),a=e.eventCache.getNode();let c;if(de(n)||ce(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=si(s,Ln(e));else{const u=e.serverCache.getNode();$(u instanceof ne,"serverChildren would be complete if leaf node"),d=Ol(s,u)}d=d,c=t.filter.updateFullNode(a,d,i)}else{const d=ce(n);let u=Ml(s,d,e.serverCache);u==null&&e.serverCache.isCompleteForChild(d)&&(u=a.getImmediateChild(d)),u!=null?c=t.filter.updateChild(a,d,u,Ae(n),l,i):e.eventCache.getNode().hasChild(d)?c=t.filter.updateChild(a,d,ne.EMPTY_NODE,Ae(n),l,i):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=si(s,Ln(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,i)))}return o=e.serverCache.isFullyInitialized()||ri(s,ye())!=null,Ms(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new kl(s.getIndex()),i=Mw(s);this.processor_=cE(i);const o=n.serverCache,l=n.eventCache,a=r.updateFullNode(ne.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(ne.EMPTY_NODE,l.getNode(),null),d=new yn(a,o.isFullyInitialized(),r.filtersNodes()),u=new yn(c,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=Pi(u,d),this.eventGenerator_=new Bw(this.query_)}get query(){return this.query_}}function yE(t){return t.viewCache_.serverCache.getNode()}function vE(t){return ni(t.viewCache_)}function bE(t,e){const n=Ln(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!de(e)&&!n.getImmediateChild(ce(e)).isEmpty())?n.getChild(e):null}function zc(t){return t.eventRegistrations_.length===0}function CE(t,e){t.eventRegistrations_.push(e)}function Yc(t,e,n){const s=[];if(n){$(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function Qc(t,e,n,s){e.type===St.MERGE&&e.source.queryId!==null&&($(Ln(t.viewCache_),"We should always have a full cache before handling merges"),$(ni(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=dE(t.processor_,r,e,n,s);return uE(t.processor_,i.viewCache),$(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Uh(t,i.changes,i.viewCache.eventCache.getNode(),null)}function wE(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Me,(i,o)=>{s.push(es(i,o))}),n.isFullyInitialized()&&s.push(kh(n.getNode())),Uh(t,s,n.getNode(),e)}function Uh(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return Vw(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oi;class Hh{constructor(){this.views=new Map}}function EE(t){$(!oi,"__referenceConstructor has already been defined"),oi=t}function SE(){return $(oi,"Reference.ts has not been loaded"),oi}function TE(t){return t.views.size===0}function Fl(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return $(i!=null,"SyncTree gave us an op for an invalid query."),Qc(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(Qc(o,e,n,s));return i}}function Wh(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let l=si(n,r?s:null),a=!1;l?a=!0:s instanceof ne?(l=Ol(n,s),a=!1):(l=ne.EMPTY_NODE,a=!1);const c=Pi(new yn(l,a,!1),new yn(s,r,!1));return new _E(e,c)}return o}function IE(t,e,n,s,r,i){const o=Wh(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),CE(o,n),wE(o,n)}function RE(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const l=vn(t);if(r==="default")for(const[a,c]of t.views.entries())o=o.concat(Yc(c,n,s)),zc(c)&&(t.views.delete(a),c.query._queryParams.loadsAllData()||i.push(c.query));else{const a=t.views.get(r);a&&(o=o.concat(Yc(a,n,s)),zc(a)&&(t.views.delete(r),a.query._queryParams.loadsAllData()||i.push(a.query)))}return l&&!vn(t)&&i.push(new(SE())(e._repo,e._path)),{removed:i,events:o}}function Bh(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function fn(t,e){let n=null;for(const s of t.views.values())n=n||bE(s,e);return n}function Vh(t,e){if(e._queryParams.loadsAllData())return xi(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Gh(t,e){return Vh(t,e)!=null}function vn(t){return xi(t)!=null}function xi(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let li;function PE(t){$(!li,"__referenceConstructor has already been defined"),li=t}function kE(){return $(li,"Reference.ts has not been loaded"),li}let xE=1;class Jc{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ke(null),this.pendingWriteTree_=iE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function jh(t,e,n,s,r){return Kw(t.pendingWriteTree_,e,n,s,r),r?as(t,new Nn(Al(),e,n)):[]}function AE(t,e,n,s){zw(t.pendingWriteTree_,e,n,s);const r=ke.fromObject(n);return as(t,new ts(Al(),e,r))}function ln(t,e,n=!1){const s=Yw(t.pendingWriteTree_,e);if(Qw(t.pendingWriteTree_,e)){let i=new ke(null);return s.snap!=null?i=i.set(ye(),!0):Je(s.children,o=>{i=i.set(new Se(o),!0)}),as(t,new ti(s.path,i,n))}else return[]}function hr(t,e,n){return as(t,new Nn(Nl(),e,n))}function NE(t,e,n){const s=ke.fromObject(n);return as(t,new ts(Nl(),e,s))}function LE(t,e){return as(t,new Zs(Nl(),e))}function OE(t,e,n){const s=Ul(t,n);if(s){const r=Hl(s),i=r.path,o=r.queryId,l=rt(i,e),a=new Zs(Ll(o),l);return Wl(t,i,a)}else return[]}function ai(t,e,n,s,r=!1){const i=e._path,o=t.syncPointTree_.get(i);let l=[];if(o&&(e._queryIdentifier==="default"||Gh(o,e))){const a=RE(o,e,n,s);TE(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const c=a.removed;if(l=a.events,!r){const d=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(i,(h,f)=>vn(f));if(d&&!u){const h=t.syncPointTree_.subtree(i);if(!h.isEmpty()){const f=FE(h);for(let _=0;_<f.length;++_){const C=f[_],S=C.query,b=Yh(t,C);t.listenProvider_.startListening(Fs(S),er(t,S),b.hashFn,b.onComplete)}}}!u&&c.length>0&&!s&&(d?t.listenProvider_.stopListening(Fs(e),null):c.forEach(h=>{const f=t.queryToTagMap.get(Ai(h));t.listenProvider_.stopListening(Fs(h),f)}))}$E(t,c)}return l}function qh(t,e,n,s){const r=Ul(t,s);if(r!=null){const i=Hl(r),o=i.path,l=i.queryId,a=rt(o,e),c=new Nn(Ll(l),a,n);return Wl(t,o,c)}else return[]}function ME(t,e,n,s){const r=Ul(t,s);if(r){const i=Hl(r),o=i.path,l=i.queryId,a=rt(o,e),c=ke.fromObject(n),d=new ts(Ll(l),a,c);return Wl(t,o,d)}else return[]}function Ko(t,e,n,s=!1){const r=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(r,(h,f)=>{const _=rt(h,r);i=i||fn(f,_),o=o||vn(f)});let l=t.syncPointTree_.get(r);l?(o=o||vn(l),i=i||fn(l,ye())):(l=new Hh,t.syncPointTree_=t.syncPointTree_.set(r,l));let a;i!=null?a=!0:(a=!1,i=ne.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,_)=>{const C=fn(_,ye());C&&(i=i.updateImmediateChild(f,C))}));const c=Gh(l,e);if(!c&&!e._queryParams.loadsAllData()){const h=Ai(e);$(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const f=UE();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}const d=ki(t.pendingWriteTree_,r);let u=IE(l,e,n,d,i,a);if(!c&&!o&&!s){const h=Vh(l,e);u=u.concat(HE(t,e,h))}return u}function $l(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,l)=>{const a=rt(o,e),c=fn(l,a);if(c)return c});return Oh(r,e,i,n,!0)}function DE(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,d)=>{const u=rt(c,n);s=s||fn(d,u)});let r=t.syncPointTree_.get(n);r?s=s||fn(r,ye()):(r=new Hh,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new yn(s,!0,!1):null,l=ki(t.pendingWriteTree_,e._path),a=Wh(r,e,l,i?o.getNode():ne.EMPTY_NODE,i);return vE(a)}function as(t,e){return Kh(e,t.syncPointTree_,null,ki(t.pendingWriteTree_,ye()))}function Kh(t,e,n,s){if(de(t.path))return zh(t,e,n,s);{const r=e.get(ye());n==null&&r!=null&&(n=fn(r,ye()));let i=[];const o=ce(t.path),l=t.operationForChild(o),a=e.children.get(o);if(a&&l){const c=n?n.getImmediateChild(o):null,d=Mh(s,o);i=i.concat(Kh(l,a,c,d))}return r&&(i=i.concat(Fl(r,t,s,n))),i}}function zh(t,e,n,s){const r=e.get(ye());n==null&&r!=null&&(n=fn(r,ye()));let i=[];return e.children.inorderTraversal((o,l)=>{const a=n?n.getImmediateChild(o):null,c=Mh(s,o),d=t.operationForChild(o);d&&(i=i.concat(zh(d,l,a,c)))}),r&&(i=i.concat(Fl(r,t,s,n))),i}function Yh(t,e){const n=e.query,s=er(t,n);return{hashFn:()=>(yE(e)||ne.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?OE(t,n._path,s):LE(t,n._path);{const i=L1(r,n);return ai(t,n,null,i)}}}}function er(t,e){const n=Ai(e);return t.queryToTagMap.get(n)}function Ai(t){return t._path.toString()+"$"+t._queryIdentifier}function Ul(t,e){return t.tagToQueryMap.get(e)}function Hl(t){const e=t.indexOf("$");return $(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Se(t.substr(0,e))}}function Wl(t,e,n){const s=t.syncPointTree_.get(e);$(s,"Missing sync point for query tag that we're tracking");const r=ki(t.pendingWriteTree_,e);return Fl(s,n,r,null)}function FE(t){return t.fold((e,n,s)=>{if(n&&vn(n))return[xi(n)];{let r=[];return n&&(r=Bh(n)),Je(s,(i,o)=>{r=r.concat(o)}),r}})}function Fs(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(kE())(t._repo,t._path):t}function $E(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=Ai(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function UE(){return xE++}function HE(t,e,n){const s=e._path,r=er(t,e),i=Yh(t,n),o=t.listenProvider_.startListening(Fs(e),r,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(s);if(r)$(!vn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,d,u)=>{if(!de(c)&&d&&vn(d))return[xi(d).query];{let h=[];return d&&(h=h.concat(Bh(d).map(f=>f.query))),Je(u,(f,_)=>{h=h.concat(_)}),h}});for(let c=0;c<a.length;++c){const d=a[c];t.listenProvider_.stopListening(Fs(d),er(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Bl(n)}node(){return this.node_}}class Vl{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Oe(this.path_,e);return new Vl(this.syncTree_,n)}node(){return $l(this.syncTree_,this.path_)}}const WE=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Xc=function(t,e,n){if(!t||typeof t!="object")return t;if($(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return BE(t[".sv"],e,n);if(typeof t[".sv"]=="object")return VE(t[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},BE=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:$(!1,"Unexpected server value: "+t)}},VE=function(t,e,n){t.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&$(!1,"Unexpected increment value: "+s);const r=e.node();if($(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},Qh=function(t,e,n,s){return Gl(e,new Vl(n,t),s)},Jh=function(t,e,n){return Gl(t,new Bl(e),n)};function Gl(t,e,n){const s=t.getPriority().val(),r=Xc(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,l=Xc(o.getValue(),e,n);return l!==o.getValue()||r!==o.getPriority().val()?new je(l,Ue(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new je(r))),o.forEachChild(Me,(l,a)=>{const c=Gl(a,e.getImmediateChild(l),n);c!==a&&(i=i.updateImmediateChild(l,c))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function ql(t,e){let n=e instanceof Se?e:new Se(e),s=t,r=ce(n);for(;r!==null;){const i=Xn(s.node.children,r)||{children:{},childCount:0};s=new jl(r,s,i),n=Ae(n),r=ce(n)}return s}function cs(t){return t.node.value}function Xh(t,e){t.node.value=e,zo(t)}function Zh(t){return t.node.childCount>0}function GE(t){return cs(t)===void 0&&!Zh(t)}function Ni(t,e){Je(t.node.children,(n,s)=>{e(new jl(n,t,s))})}function ef(t,e,n,s){n&&e(t),Ni(t,r=>{ef(r,e,!0)})}function jE(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function fr(t){return new Se(t.parent===null?t.name:fr(t.parent)+"/"+t.name)}function zo(t){t.parent!==null&&qE(t.parent,t.name,t)}function qE(t,e,n){const s=GE(n),r=$t(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,zo(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,zo(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=/[\[\].#$\/\u0000-\u001F\u007F]/,zE=/[\[\].#$\u0000-\u001F\u007F]/,ho=10*1024*1024,Kl=function(t){return typeof t=="string"&&t.length!==0&&!KE.test(t)},tf=function(t){return typeof t=="string"&&t.length!==0&&!zE.test(t)},YE=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),tf(t)},QE=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!bl(t)||t&&typeof t=="object"&&$t(t,".sv")},JE=function(t,e,n,s){Li(Ti(t,"value"),e,n)},Li=function(t,e,n){const s=n instanceof Se?new fw(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Rn(s));if(typeof e=="function")throw new Error(t+"contains a function "+Rn(s)+" with contents = "+e.toString());if(bl(e))throw new Error(t+"contains "+e.toString()+" "+Rn(s));if(typeof e=="string"&&e.length>ho/3&&Ii(e)>ho)throw new Error(t+"contains a string greater than "+ho+" utf8 bytes "+Rn(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Je(e,(o,l)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Kl(o)))throw new Error(t+" contains an invalid key ("+o+") "+Rn(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);pw(s,o),Li(t,l,s),mw(s)}),r&&i)throw new Error(t+' contains ".value" child '+Rn(s)+" in addition to actual children.")}},XE=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const i=Ys(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Kl(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(hw);let r=null;for(n=0;n<e.length;n++){if(s=e[n],r!==null&&bt(r,s))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},ZE=function(t,e,n,s){const r=Ti(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];Je(e,(o,l)=>{const a=new Se(o);if(Li(r,l,Oe(n,a)),Tl(a)===".priority"&&!QE(l))throw new Error(r+"contains an invalid value for '"+a.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(a)}),XE(r,i)},nf=function(t,e,n,s){if(!tf(n))throw new Error(Ti(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},eS=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),nf(t,e,n)},sf=function(t,e){if(ce(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},tS=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Kl(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!YE(n))throw new Error(Ti(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Oi(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!Il(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function rf(t,e,n){Oi(t,n),of(t,s=>Il(s,e))}function wt(t,e,n){Oi(t,n),of(t,s=>bt(s,e)||bt(e,s))}function of(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(sS(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function sS(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Ls&&Ye("event: "+n.toString()),ls(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="repo_interrupt",iS=25;class oS{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new nS,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ei(),this.transactionQueueTree_=new jl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function lS(t,e,n){if(t.stats_=El(t.repoInfo_),t.forceRestClient_||F1())t.server_=new Zr(t.repoInfo_,(s,r,i,o)=>{Zc(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>eu(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{He(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Kt(t.repoInfo_,e,(s,r,i,o)=>{Zc(t,s,r,i,o)},s=>{eu(t,s)},s=>{cS(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=B1(t.repoInfo_,()=>new Ww(t.stats_,t.server_)),t.infoData_=new Dw,t.infoSyncTree_=new Jc({startListening:(s,r,i,o)=>{let l=[];const a=t.infoData_.getNode(s._path);return a.isEmpty()||(l=hr(t.infoSyncTree_,s._path,a),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),zl(t,"connected",!1),t.serverSyncTree_=new Jc({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(l,a)=>{const c=o(l,a);wt(t.eventQueue_,s._path,c)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function aS(t){const n=t.infoData_.getNode(new Se(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Mi(t){return WE({timestamp:aS(t)})}function Zc(t,e,n,s,r){t.dataUpdateCount++;const i=new Se(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const a=qr(n,c=>Ue(c));o=ME(t.serverSyncTree_,i,a,r)}else{const a=Ue(n);o=qh(t.serverSyncTree_,i,a,r)}else if(s){const a=qr(n,c=>Ue(c));o=NE(t.serverSyncTree_,i,a)}else{const a=Ue(n);o=hr(t.serverSyncTree_,i,a)}let l=i;o.length>0&&(l=ss(t,i)),wt(t.eventQueue_,l,o)}function eu(t,e){zl(t,"connected",e),e===!1&&fS(t)}function cS(t,e){Je(e,(n,s)=>{zl(t,n,s)})}function zl(t,e,n){const s=new Se("/.info/"+e),r=Ue(n);t.infoData_.updateSnapshot(s,r);const i=hr(t.infoSyncTree_,s,r);wt(t.eventQueue_,s,i)}function Yl(t){return t.nextWriteId_++}function uS(t,e,n){const s=DE(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(r=>{const i=Ue(r).withIndex(e._queryParams.getIndex());Ko(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=hr(t.serverSyncTree_,e._path,i);else{const l=er(t.serverSyncTree_,e);o=qh(t.serverSyncTree_,e._path,i,l)}return wt(t.eventQueue_,e._path,o),ai(t.serverSyncTree_,e,n,null,!0),i},r=>(pr(t,"get for query "+He(e)+" failed: "+r),Promise.reject(new Error(r))))}function dS(t,e,n,s,r){pr(t,"set",{path:e.toString(),value:n,priority:s});const i=Mi(t),o=Ue(n,s),l=$l(t.serverSyncTree_,e),a=Jh(o,l,i),c=Yl(t),d=jh(t.serverSyncTree_,e,a,c,!0);Oi(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(h,f)=>{const _=h==="ok";_||it("set at "+e+" failed: "+h);const C=ln(t.serverSyncTree_,c,!_);wt(t.eventQueue_,e,C),Yo(t,r,h,f)});const u=Jl(t,e);ss(t,u),wt(t.eventQueue_,u,[])}function hS(t,e,n,s){pr(t,"update",{path:e.toString(),value:n});let r=!0;const i=Mi(t),o={};if(Je(n,(l,a)=>{r=!1,o[l]=Qh(Oe(e,l),Ue(a),t.serverSyncTree_,i)}),r)Ye("update() called with empty data.  Don't do anything."),Yo(t,s,"ok",void 0);else{const l=Yl(t),a=AE(t.serverSyncTree_,e,o,l);Oi(t.eventQueue_,a),t.server_.merge(e.toString(),n,(c,d)=>{const u=c==="ok";u||it("update at "+e+" failed: "+c);const h=ln(t.serverSyncTree_,l,!u),f=h.length>0?ss(t,e):e;wt(t.eventQueue_,f,h),Yo(t,s,c,d)}),Je(n,c=>{const d=Jl(t,Oe(e,c));ss(t,d)}),wt(t.eventQueue_,e,[])}}function fS(t){pr(t,"onDisconnectEvents");const e=Mi(t),n=ei();Wo(t.onDisconnect_,ye(),(r,i)=>{const o=Qh(r,i,t.serverSyncTree_,e);xh(n,r,o)});let s=[];Wo(n,ye(),(r,i)=>{s=s.concat(hr(t.serverSyncTree_,r,i));const o=Jl(t,r);ss(t,o)}),t.onDisconnect_=ei(),wt(t.eventQueue_,ye(),s)}function pS(t,e,n){let s;ce(e._path)===".info"?s=Ko(t.infoSyncTree_,e,n):s=Ko(t.serverSyncTree_,e,n),rf(t.eventQueue_,e._path,s)}function tu(t,e,n){let s;ce(e._path)===".info"?s=ai(t.infoSyncTree_,e,n):s=ai(t.serverSyncTree_,e,n),rf(t.eventQueue_,e._path,s)}function mS(t){t.persistentConnection_&&t.persistentConnection_.interrupt(rS)}function pr(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ye(n,...e)}function Yo(t,e,n,s){e&&ls(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function lf(t,e,n){return $l(t.serverSyncTree_,e,n)||ne.EMPTY_NODE}function Ql(t,e=t.transactionQueueTree_){if(e||Di(t,e),cs(e)){const n=cf(t,e);$(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&gS(t,fr(e),n)}else Zh(e)&&Ni(e,n=>{Ql(t,n)})}function gS(t,e,n){const s=n.map(c=>c.currentWriteId),r=lf(t,e,s);let i=r;const o=r.hash();for(let c=0;c<n.length;c++){const d=n[c];$(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const u=rt(e,d.path);i=i.updateChild(u,d.currentOutputSnapshotRaw)}const l=i.val(!0),a=e;t.server_.put(a.toString(),l,c=>{pr(t,"transaction put response",{path:a.toString(),status:c});let d=[];if(c==="ok"){const u=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(ln(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&u.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Di(t,ql(t.transactionQueueTree_,e)),Ql(t,t.transactionQueueTree_),wt(t.eventQueue_,e,d);for(let h=0;h<u.length;h++)ls(u[h])}else{if(c==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{it("transaction at "+a.toString()+" failed: "+c);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=c}ss(t,e)}},o)}function ss(t,e){const n=af(t,e),s=fr(n),r=cf(t,n);return _S(t,r,s),s}function _S(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=rt(n,a.path);let d=!1,u;if($(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)d=!0,u=a.abortReason,r=r.concat(ln(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=iS)d=!0,u="maxretry",r=r.concat(ln(t.serverSyncTree_,a.currentWriteId,!0));else{const h=lf(t,a.path,o);a.currentInputSnapshot=h;const f=e[l].update(h.val());if(f!==void 0){Li("transaction failed: Data returned ",f,a.path);let _=Ue(f);typeof f=="object"&&f!=null&&$t(f,".priority")||(_=_.updatePriority(h.getPriority()));const S=a.currentWriteId,b=Mi(t),E=Jh(_,h,b);a.currentOutputSnapshotRaw=_,a.currentOutputSnapshotResolved=E,a.currentWriteId=Yl(t),o.splice(o.indexOf(S),1),r=r.concat(jh(t.serverSyncTree_,a.path,E,a.currentWriteId,a.applyLocally)),r=r.concat(ln(t.serverSyncTree_,S,!0))}else d=!0,u="nodata",r=r.concat(ln(t.serverSyncTree_,a.currentWriteId,!0))}wt(t.eventQueue_,n,r),r=[],d&&(e[l].status=2,function(h){setTimeout(h,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(u==="nodata"?s.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):s.push(()=>e[l].onComplete(new Error(u),!1,null))))}Di(t,t.transactionQueueTree_);for(let l=0;l<s.length;l++)ls(s[l]);Ql(t,t.transactionQueueTree_)}function af(t,e){let n,s=t.transactionQueueTree_;for(n=ce(e);n!==null&&cs(s)===void 0;)s=ql(s,n),e=Ae(e),n=ce(e);return s}function cf(t,e){const n=[];return uf(t,e,n),n.sort((s,r)=>s.order-r.order),n}function uf(t,e,n){const s=cs(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);Ni(e,r=>{uf(t,r,n)})}function Di(t,e){const n=cs(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,Xh(e,n.length>0?n:void 0)}Ni(e,s=>{Di(t,s)})}function Jl(t,e){const n=fr(af(t,e)),s=ql(t.transactionQueueTree_,e);return jE(s,r=>{fo(t,r)}),fo(t,s),ef(s,r=>{fo(t,r)}),n}function fo(t,e){const n=cs(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?($(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):($(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(ln(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Xh(e,void 0):n.length=i+1,wt(t.eventQueue_,fr(e),r);for(let o=0;o<s.length;o++)ls(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function vS(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):it(`Invalid query segment '${n}' in query '${t}'`)}return e}const nu=function(t,e){const n=bS(t),s=n.namespace;n.domain==="firebase.com"&&Jt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Jt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||P1();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new fh(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Se(n.pathString)}},bS=function(t){let e="",n="",s="",r="",i="",o=!0,l="https",a=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(l=t.substring(0,c-1),t=t.substring(c+2));let d=t.indexOf("/");d===-1&&(d=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(d,u)),d<u&&(r=yS(t.substring(d,u)));const h=vS(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const _=e.indexOf(".");s=e.substring(0,_).toLowerCase(),n=e.substring(_+1),i=s}"ns"in h&&(i=h.ns)}return{host:e,port:a,domain:n,subdomain:s,secure:o,scheme:l,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+He(this.snapshot.exportVal())}}class wS{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return de(this._path)?null:Tl(this._path)}get ref(){return new en(this._repo,this._path)}get _queryIdentifier(){const e=Wc(this._queryParams),n=Cl(e);return n==="{}"?"default":n}get _queryObject(){return Wc(this._queryParams)}isEqual(e){if(e=os(e),!(e instanceof Xl))return!1;const n=this._repo===e._repo,s=Il(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+dw(this._path)}}class en extends Xl{constructor(e,n){super(e,n,new xl,!1)}get parent(){const e=wh(this._path);return e===null?null:new en(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class tr{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Se(e),s=ci(this.ref,e);return new tr(this._node.getChild(n),s,Me)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new tr(r,ci(this.ref,s),Me)))}hasChild(e){const n=new Se(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ve(t,e){return t=os(t),t._checkNotDeleted("ref"),e!==void 0?ci(t._root,e):t._root}function ci(t,e){return t=os(t),ce(t._path)===null?eS("child","path",e):nf("child","path",e),new en(t._repo,Oe(t._path,e))}function po(t){return sf("remove",t._path),Cs(t,null)}function Cs(t,e){t=os(t),sf("set",t._path),JE("set",e,t._path);const n=new lr;return dS(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ys(t,e){ZE("update",e,t._path);const n=new lr;return hS(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function vs(t){t=os(t);const e=new df(()=>{}),n=new Fi(e);return uS(t._repo,t,n).then(s=>new tr(s,new en(t._repo,t._path),t._queryParams.getIndex()))}class Fi{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new CS("value",this,new tr(e.snapshotNode,new en(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new wS(this,e,n):null}matches(e){return e instanceof Fi?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function ES(t,e,n,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const a=n,c=(d,u)=>{tu(t._repo,t,l),a(d,u)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new df(n,i||void 0),l=new Fi(o);return pS(t._repo,t,l),()=>tu(t._repo,t,l)}function su(t,e,n,s){return ES(t,"value",e,n,s)}EE(en);PE(en);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS="FIREBASE_DATABASE_EMULATOR_HOST",Qo={};let TS=!1;function IS(t,e,n,s){const r=e.lastIndexOf(":"),i=e.substring(0,r),o=yl(i);t.repoInfo_=new fh(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function RS(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||Jt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ye("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=nu(i,r),l=o.repoInfo,a;typeof process<"u"&&Ec&&(a=Ec[SS]),a?(i=`http://${a}?ns=${l.namespace}`,o=nu(i,r),l=o.repoInfo):o.repoInfo.secure;const c=new U1(t.name,t.options,e);tS("Invalid Firebase Database URL",o),de(o.path)||Jt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=kS(l,t,c,new $1(t,n));return new xS(d,t)}function PS(t,e){const n=Qo[e];(!n||n[t.key]!==t)&&Jt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),mS(t),delete n[t.key]}function kS(t,e,n,s){let r=Qo[e.name];r||(r={},Qo[e.name]=r);let i=r[t.toURLString()];return i&&Jt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new oS(t,TS,n,s),r[t.toURLString()]=i,i}class xS{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(lS(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new en(this._repo,ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(PS(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Jt("Cannot call "+e+" on a deleted database.")}}function AS(t=c1(),e){const n=r1(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=Vb("database");s&&NS(n,...s)}return n}function NS(t,e,n,s={}){t=os(t),t._checkNotDeleted("useEmulator");const r=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(r===t._repoInternal.repoInfo_.host&&Kr(s,i.repoInfo_.emulatorOptions))return;Jt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&Jt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Mr(Mr.OWNER);else if(s.mockUserToken){const l=typeof s.mockUserToken=="string"?s.mockUserToken:jb(s.mockUserToken,t.app.options.projectId);o=new Mr(l)}yl(e)&&(Gb(e),zb("Database",!0)),IS(i,r,s,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t){w1(a1),Yr(new qs("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return RS(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),qn(Sc,Tc,t),qn(Sc,Tc,"esm2020")}Kt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Kt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};LS();const OS={apiKey:void 0,authDomain:void 0,databaseURL:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},MS=Qd(OS),Ge=AS(MS);class DS{currentLobby=null;currentPlayerId=null;lobbyListeners={};constructor(){this.currentPlayerId=this.generatePlayerId(),console.log("Firebase Lobby Service initialized with player ID:",this.currentPlayerId)}generatePlayerId(){return"player_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36)}generateLobbyCode(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let s=0;s<6;s++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}cleanupOldLobbies(){const e=Date.now()-72e5,n=Ve(Ge,"lobbies");vs(n).then(s=>{if(s.exists()){const r=s.val(),i={};Object.keys(r).forEach(o=>{r[o].createdAt<e&&(i[`lobbies/${o}`]=null)}),Object.keys(i).length>0&&(ys(Ve(Ge),i),console.log(`Cleaned up ${Object.keys(i).length} old lobbies`))}}).catch(s=>{console.warn("Could not clean up old lobbies:",s)})}async createLobby(e){try{this.cleanupOldLobbies();let n=this.generateLobbyCode();const s=Ve(Ge,"lobbies");let r=!0;for(;r;){const l=ci(s,n);(await vs(l)).exists()?n=this.generateLobbyCode():r=!1}const i={id:n,hostId:this.currentPlayerId,hostName:e,players:{[this.currentPlayerId]:{id:this.currentPlayerId,name:e,isHost:!0,isReady:!1,joinedAt:Date.now()}},gameSettings:{totalRounds:5,playlistUrl:"",tournamentName:`${e}'s Tournament`},status:"waiting",createdAt:Date.now(),maxPlayers:8},o=Ve(Ge,`lobbies/${n}`);return await Cs(o,i),this.currentLobby=i,console.log("Lobby created successfully:",n),{success:!0,lobbyCode:n}}catch(n){return console.error("Error creating lobby:",n),{success:!1,error:"Failed to create lobby"}}}async joinLobby(e,n){try{console.log("Attempting to join lobby:",e);const s=Ve(Ge,`lobbies/${e}`),r=await vs(s);if(!r.exists())return console.log("Lobby not found:",e),{success:!1,error:"Lobby not found"};const i=r.val();if(console.log("Found lobby:",i),i.status!=="waiting")return{success:!1,error:"Game already in progress"};if(Object.keys(i.players).length>=i.maxPlayers)return{success:!1,error:"Lobby is full"};if(i.players[this.currentPlayerId])return console.log("Player already in lobby, rejoining"),this.currentLobby=i,{success:!0,lobby:i};const o={id:this.currentPlayerId,name:n,isHost:!1,isReady:!1,joinedAt:Date.now()},l=Ve(Ge,`lobbies/${e}/players/${this.currentPlayerId}`);return await Cs(l,o),i.players[this.currentPlayerId]=o,this.currentLobby=i,console.log("Successfully joined lobby"),{success:!0,lobby:i}}catch(s){return console.error("Error joining lobby:",s),{success:!1,error:"Failed to join lobby"}}}async leaveLobby(){if(!(!this.currentLobby||!this.currentPlayerId))try{const e=this.currentLobby.id,n=Ve(Ge,`lobbies/${e}`),s=Ve(Ge,`lobbies/${e}/players/${this.currentPlayerId}`);if(await po(s),this.currentLobby.hostId===this.currentPlayerId)await po(n),console.log("Host left, lobby deleted");else{const r=await vs(Ve(Ge,`lobbies/${e}/players`));(!r.exists()||Object.keys(r.val()).length===0)&&(await po(n),console.log("Last player left, lobby deleted"))}this.removeAllListeners(),this.currentLobby=null}catch(e){console.error("Error leaving lobby:",e)}}listenToLobby(e,n){const s=Ve(Ge,`lobbies/${e}`),r=su(s,i=>{if(i.exists()){const o=i.val();this.currentLobby=o,n(o)}else n(null)},i=>{console.error("Error listening to lobby:",i),n(null)});this.lobbyListeners[`lobby_${e}`]=r}async updateLobbySettings(e){if(!this.currentLobby||this.currentLobby.hostId!==this.currentPlayerId)return!1;try{const n=Ve(Ge,`lobbies/${this.currentLobby.id}/gameSettings`);return await ys(n,e),!0}catch(n){return console.error("Error updating lobby settings:",n),!1}}async setPlayerReady(e){if(!this.currentLobby||!this.currentPlayerId)return!1;try{const n=Ve(Ge,`lobbies/${this.currentLobby.id}/players/${this.currentPlayerId}/isReady`);return await Cs(n,e),!0}catch(n){return console.error("Error setting player ready:",n),!1}}async startGame(){if(!this.currentLobby||this.currentLobby.hostId!==this.currentPlayerId)return!1;try{const e={};e[`lobbies/${this.currentLobby.id}/status`]="playing";const n={currentRound:1,currentTrack:null,currentAttempt:0,maxAttempts:6,clipDurations:[1,2,4,7,11,16],currentClipDuration:1,isRoundActive:!1,roundStartTime:0,roundEndTime:null,usedTracks:[],playersReady:{},playerGuesses:{}};return Object.keys(this.currentLobby.players).forEach(s=>{n.playerGuesses[s]={attempts:[],hasWon:!1,hasLost:!1,roundScore:0,totalScore:0,roundsWon:0}}),e[`lobbies/${this.currentLobby.id}/gameState`]=n,await ys(Ve(Ge),e),!0}catch(e){return console.error("Error starting game:",e),!1}}async updateGameState(e){if(!this.currentLobby||this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can update game state"};try{const n=Ve(Ge,`lobbies/${this.currentLobby.id}/gameState`);return await ys(n,e),{success:!0}}catch(n){return console.error("Error updating game state:",n),{success:!1,error:"Failed to update game state"}}}async submitGuess(e,n){if(!this.currentLobby||!this.currentPlayerId)return{success:!1,error:"No active lobby or player ID"};try{const s=Date.now(),r={guess:e,isCorrect:n,timestamp:s},i=Ve(Ge,`lobbies/${this.currentLobby.id}/gameState`),o=await vs(i);if(!o.exists())return{success:!1,error:"Game state not found"};const l=o.val();l.playerGuesses||(l.playerGuesses={}),l.playerGuesses[this.currentPlayerId]||(l.playerGuesses[this.currentPlayerId]={attempts:[],hasWon:!1,hasLost:!1,roundScore:0,totalScore:0,roundsWon:0});let a=l.playerGuesses[this.currentPlayerId];a||(console.error("CRITICAL: playerGuesses is undefined after initialization! Player ID:",this.currentPlayerId),console.log("Available player IDs in gameState:",Object.keys(l.playerGuesses||{})),l.playerGuesses[this.currentPlayerId]={attempts:[],hasWon:!1,hasLost:!1,roundScore:0,totalScore:0,roundsWon:0},a=l.playerGuesses[this.currentPlayerId]),a.attempts||(console.warn("Attempts array is missing, recreating it"),a.attempts=[]),a.attempts.push(r),n?(a.hasWon=!0,a.roundScore=this.calculateRoundScore(a.attempts.length),a.totalScore+=a.roundScore,a.roundsWon+=1):a.attempts.length>=l.maxAttempts&&(a.hasLost=!0,a.roundScore=0);const c={};return c[`lobbies/${this.currentLobby.id}/gameState/playerGuesses/${this.currentPlayerId}`]=a,await ys(Ve(Ge),c),{success:!0}}catch(s){return console.error("Error submitting guess:",s),{success:!1,error:"Failed to submit guess"}}}calculateRoundScore(e){const s=Math.floor(166.66666666666666);return Math.max(100,1e3-(e-1)*s)}async finishTournament(){if(!this.currentLobby||this.currentLobby.hostId!==this.currentPlayerId)return{success:!1,error:"Only host can finish tournament"};try{const e=Ve(Ge,`lobbies/${this.currentLobby.id}/status`);return await Cs(e,"finished"),{success:!0}}catch(e){return console.error("Error finishing tournament:",e),{success:!1,error:"Failed to finish tournament"}}}listenToGameState(e,n){const s=Ve(Ge,`lobbies/${e}/gameState`),r=su(s,i=>{if(i.exists()){const o=i.val();n(o)}else n(null)},i=>{console.error("Error listening to game state:",i),n(null)});this.lobbyListeners[`gameState_${e}`]=r}getCurrentLobby(){return this.currentLobby}getCurrentPlayerId(){return this.currentPlayerId}removeAllListeners(){Object.values(this.lobbyListeners).forEach(e=>{typeof e=="function"&&e()}),this.lobbyListeners={}}cleanup(){this.removeAllListeners()}}const ge=new DS;window.addEventListener("beforeunload",()=>{ge.cleanup()});const FS={class:"multiplayer-menu"},$S={class:"menu-container"},US={class:"menu-sections"},HS={class:"menu-section create-section"},WS={class:"section-content"},BS=["disabled"],VS={class:"button-icon"},GS={class:"menu-section join-section"},jS={class:"section-content"},qS={class:"join-form"},KS=["disabled"],zS={class:"button-icon"},YS={class:"message-content"},QS={class:"message-icon"},JS={class:"message-text"},XS={class:"modal-actions"},ZS=["disabled"],e0=ut({__name:"MultiplayerMenu",setup(t){const e=Zt(),n=V(""),s=V(""),r=V(!1),i=V(!1),o=V(!1),l=V(""),a=V("info"),c=V("create"),d=ee(()=>n.value.length===6&&/^[A-Z0-9]+$/.test(n.value)),u=()=>{e.push("/")},h=(T,U="info")=>{l.value=T,a.value=U,setTimeout(()=>{l.value=""},5e3)},f=()=>{c.value="create",o.value=!0},_=()=>{d.value&&(c.value="join",o.value=!0)},C=()=>{o.value=!1,s.value="",r.value=!1,i.value=!1},S=async()=>{s.value.trim()&&(o.value=!1,c.value==="create"?await b():await E())},b=async()=>{r.value=!0,h("Creating lobby...","info");try{if(!uc()){h("Firebase is not configured. Please check your environment variables.","error");return}const T=await ge.createLobby(s.value.trim());T.success&&T.lobbyCode?(h(`Lobby created! Code: ${T.lobbyCode}`,"success"),setTimeout(()=>{e.push(`/lobby/${T.lobbyCode}`)},2e3)):h(T.error||"Failed to create lobby","error")}catch(T){h(`Network error: ${T instanceof Error?T.message:"Please check your connection."}`,"error")}finally{r.value=!1,s.value=""}},E=async()=>{i.value=!0,h("Joining lobby...","info");try{if(!uc()){h("Firebase is not configured. Please check your environment variables.","error");return}const T=await ge.joinLobby(n.value,s.value.trim());T.success?(h("Successfully joined lobby!","success"),setTimeout(()=>{e.push(`/lobby/${n.value}`)},1500)):h(T.error||"Failed to join lobby","error")}catch(T){h(`Network error: ${T instanceof Error?T.message:"Please check your connection."}`,"error")}finally{i.value=!1,s.value=""}},I=T=>{let Z=T.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");Z.length>6&&(Z=Z.substring(0,6)),n.value=Z};return(T,U)=>(N(),O("div",FS,[p("div",{class:"menu-header"},[p("button",{class:"back-button",onClick:u}," ← Back to Menu "),U[3]||(U[3]=p("h1",null,"Multiplayer",-1)),U[4]||(U[4]=p("p",null,"Connect with friends and compete in real-time!",-1))]),p("div",$S,[p("div",US,[p("div",HS,[U[6]||(U[6]=p("div",{class:"section-header"},[p("div",{class:"section-icon"},"🎯"),p("h2",null,"Create Lobby")],-1)),p("div",WS,[U[5]||(U[5]=ma('<p data-v-68284b18>Host a new game and invite friends to join your lobby</p><div class="features-list" data-v-68284b18><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>⚙️</span><span data-v-68284b18>Customize game settings</span></div><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>👑</span><span data-v-68284b18>Host controls</span></div><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>🔗</span><span data-v-68284b18>Share lobby code</span></div></div>',2)),p("button",{class:"action-button create-button",onClick:f,disabled:r.value},[p("span",VS,P(r.value?"⏳":"🚀"),1),pt(" "+P(r.value?"Creating...":"Create New Lobby"),1)],8,BS)])]),p("div",GS,[U[8]||(U[8]=p("div",{class:"section-header"},[p("div",{class:"section-icon"},"🎮"),p("h2",null,"Join Lobby")],-1)),p("div",jS,[U[7]||(U[7]=ma('<p data-v-68284b18>Enter a lobby code to join an existing game</p><div class="features-list" data-v-68284b18><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>🔍</span><span data-v-68284b18>Quick join with code</span></div><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>⚡</span><span data-v-68284b18>Instant connection</span></div><div class="feature-item" data-v-68284b18><span class="feature-icon" data-v-68284b18>🏆</span><span data-v-68284b18>Compete with others</span></div></div>',2)),p("div",qS,[yt(p("input",{type:"text","onUpdate:modelValue":U[0]||(U[0]=Z=>n.value=Z),placeholder:"Enter lobby code...",class:"lobby-input",maxlength:"6",onInput:I},null,544),[[vt,n.value]]),p("button",{class:"action-button join-button",onClick:_,disabled:!d.value||i.value},[p("span",zS,P(i.value?"⏳":"🎯"),1),pt(" "+P(i.value?"Joining...":"Join Lobby"),1)],8,KS)])])])])]),l.value?(N(),O("div",{key:0,class:Qe(["status-message",a.value])},[p("div",YS,[p("span",QS,P(a.value==="success"?"✅":a.value==="error"?"❌":"ℹ️"),1),p("span",JS,P(l.value),1)])],2)):pe("",!0),o.value?(N(),O("div",{key:1,class:"modal-overlay",onClick:C},[p("div",{class:"modal-content",onClick:U[2]||(U[2]=pd(()=>{},["stop"]))},[p("h3",null,P(r.value?"Create Lobby":"Join Lobby"),1),U[9]||(U[9]=p("p",null,"Enter your player name:",-1)),yt(p("input",{type:"text","onUpdate:modelValue":U[1]||(U[1]=Z=>s.value=Z),placeholder:"Your name...",class:"name-input",maxlength:"20",onKeyup:Im(S,["enter"])},null,544),[[vt,s.value]]),p("div",XS,[p("button",{class:"modal-btn cancel",onClick:C},"Cancel"),p("button",{class:"modal-btn confirm",onClick:S,disabled:!s.value.trim()},P(r.value?"Create":"Join"),9,ZS)])])])):pe("",!0)]))}}),t0=kt(e0,[["__scopeId","data-v-68284b18"]]),n0={class:"lobby-view"},s0={class:"lobby-header"},r0={class:"lobby-content"},i0={class:"players-section"},o0={class:"players-list"},l0={class:"player-name"},a0={key:0,class:"host-badge"},c0={class:"lobby-info"},u0={class:"settings-header"},d0={key:1,class:"settings-form"},h0={class:"form-group"},f0={class:"form-group"},p0={class:"form-group"},m0={class:"predefined-playlists"},g0={key:0,class:"predefined-menu"},_0=["onClick"],y0={class:"playlist-info"},v0={class:"playlist-meta"},b0={class:"form-group"},C0={class:"lobby-actions"},w0=["disabled"],E0={key:0,class:"connection-error"},S0=ut({__name:"FirebaseLobbyView",setup(t){const e=Zt(),n=Si(),s=V(null),r=V(""),i=V(!1),o=V({tournamentName:"",totalRounds:5,playlistUrl:""}),l=V(""),a=V("success"),c=V(!1),d=V([{id:"xenoblade",name:"Xenoblade Chronicles",description:"Epic orchestral soundtrack from the Xenoblade Chronicles series",url:Gr(),songCount:"99+ songs",genre:"RPG/Orchestral"}]),u=ee(()=>n.params.lobbyCode),h=ee(()=>s.value?Object.values(s.value.players):[]),f=ee(()=>h.value.length),_=ee(()=>s.value?.maxPlayers||8),C=ee(()=>s.value?.gameSettings),S=ee(()=>{const q=ge.getCurrentPlayerId();return s.value?.hostId===q}),b=ee(()=>{const q=ge.getCurrentPlayerId();return!q||!s.value?!1:s.value.players[q]?.isReady||!1}),E=ee(()=>{if(!s.value||!S.value||!o.value.playlistUrl||o.value.playlistUrl.trim()==="")return!1;const q=Object.values(s.value.players).filter(j=>!j.isHost);return q.length===0?!0:q.every(j=>j.isReady)});qt(C,q=>{q&&S.value?o.value={tournamentName:q.tournamentName||"",totalRounds:q.totalRounds||5,playlistUrl:q.playlistUrl||""}:q&&!S.value&&(i.value=!0,setTimeout(()=>{i.value=!1},2e3))},{immediate:!0,deep:!0});const I=(q,j="success")=>{l.value=q,a.value=j,setTimeout(()=>{l.value=""},3e3)},T=async()=>{if(S.value)try{await ge.updateLobbySettings({tournamentName:o.value.tournamentName,totalRounds:Number(o.value.totalRounds),playlistUrl:o.value.playlistUrl})?I("Settings updated successfully!","success"):I("Failed to update settings","error")}catch(q){I("Error updating settings","error"),console.error("Settings update error:",q)}},U=async()=>{const q=!b.value;await ge.setPlayerReady(q)||console.error("Failed to update ready status")},Z=async()=>{if(!(!S.value||!E.value))try{await ge.startGame()?e.push(`/lobby/${u.value}/game`):I("Failed to start game","error")}catch(q){I("Error starting game","error"),console.error("Start game error:",q)}},te=async()=>{try{await ge.leaveLobby(),e.push("/multiplayer")}catch(q){console.error("Error leaving lobby:",q),e.push("/multiplayer")}},X=q=>{const j=Gr();return q===j?"Xenoblade Chronicles":q&&q.startsWith("http")?"Custom Playlist":"Default Playlist"},K=()=>{r.value="",ve()},he=q=>{o.value.playlistUrl=q,c.value=!1},ve=()=>{ge.listenToLobby(u.value,q=>{q?(s.value=q,r.value="",q.status==="playing"?e.push(`/lobby/${u.value}/game`):q.status==="finished"&&e.push(`/lobby/${u.value}/results`)):r.value="Lobby was closed or connection lost"})};return wn(async()=>{const q=ge.getCurrentLobby();if(q&&q.id===u.value)s.value=q,ve();else{const j=ge.getCurrentPlayerId();e.push("/multiplayer")}}),ir(()=>{ge.removeAllListeners()}),Ld(()=>{ge.removeAllListeners()}),(q,j)=>(N(),O("div",n0,[p("div",s0,[p("button",{class:"back-button",onClick:te}," ← Leave Lobby "),p("h1",null,"Lobby: "+P(u.value),1),j[4]||(j[4]=p("p",null,"Waiting for players...",-1))]),p("div",r0,[p("div",i0,[p("h3",null,"Players ("+P(f.value)+"/"+P(_.value)+")",1),p("div",o0,[(N(!0),O(Fe,null,It(h.value,ae=>(N(),O("div",{key:ae.id,class:"player-item"},[p("span",l0,P(ae.name),1),ae.isHost?(N(),O("span",a0,"Host")):pe("",!0),p("span",{class:Qe(["ready-status",{ready:ae.isReady}])},P(ae.isReady?"✅ Ready":"⏳ Not Ready"),3)]))),128))])]),p("div",c0,[j[15]||(j[15]=p("h3",null,"Game Settings",-1)),S.value?(N(),O("div",d0,[p("div",h0,[j[10]||(j[10]=p("label",{for:"tournamentName"},"Tournament Name",-1)),yt(p("input",{id:"tournamentName",type:"text","onUpdate:modelValue":j[0]||(j[0]=ae=>o.value.tournamentName=ae),onBlur:T,placeholder:"Name your tournament",class:"form-input",maxlength:"50"},null,544),[[vt,o.value.tournamentName]])]),p("div",f0,[j[11]||(j[11]=p("label",{for:"playlistUrl"},"YouTube Playlist URL",-1)),yt(p("input",{type:"url",id:"playlistUrl","onUpdate:modelValue":j[1]||(j[1]=ae=>o.value.playlistUrl=ae),onBlur:T,placeholder:"https://www.youtube.com/playlist?list=...",class:"form-input"},null,544),[[vt,o.value.playlistUrl]]),j[12]||(j[12]=p("p",{class:"form-hint"},[pt(" ⚠️ Make sure your playlist is set to "),p("strong",null,"Public"),pt(" or "),p("strong",null,"Unlisted"),pt(" (not Private) ")],-1))]),p("div",p0,[p("div",m0,[p("button",{type:"button",class:"predefined-toggle",onClick:j[2]||(j[2]=ae=>c.value=!c.value)},P(c.value?"▼":"▶")+" Or choose from predefined playlists ",1),c.value?(N(),O("div",g0,[(N(!0),O(Fe,null,It(d.value,ae=>(N(),O("div",{class:"predefined-item",key:ae.id},[p("button",{type:"button",class:Qe(["predefined-btn",{selected:o.value.playlistUrl===ae.url}]),onClick:Be=>he(ae.url)},[p("div",y0,[p("h4",null,P(ae.name),1),p("p",null,P(ae.description),1),p("span",v0,P(ae.songCount)+" • "+P(ae.genre),1)])],10,_0)]))),128))])):pe("",!0)])]),p("div",b0,[j[13]||(j[13]=p("label",{for:"songCount"},"Number of Songs",-1)),yt(p("input",{type:"number",id:"songCount","onUpdate:modelValue":j[3]||(j[3]=ae=>o.value.totalRounds=ae),onBlur:T,min:1,max:50,placeholder:"Enter number of songs",class:"form-input"},null,544),[[vt,o.value.totalRounds,void 0,{number:!0}]]),j[14]||(j[14]=p("p",{class:"form-hint"}," How many songs will be played in this tournament ",-1))]),l.value?(N(),O("div",{key:0,class:Qe(["settings-message",a.value])},P(l.value),3)):pe("",!0)])):(N(),O("div",{key:0,class:Qe(["settings-info",{"settings-updated":i.value}])},[p("div",u0,[p("p",null,[j[5]||(j[5]=p("strong",null,"Tournament:",-1)),pt(" "+P(C.value?.tournamentName||"Multiplayer Game"),1)]),p("p",null,[j[6]||(j[6]=p("strong",null,"Rounds:",-1)),pt(" "+P(C.value?.totalRounds||5),1)]),p("p",null,[j[7]||(j[7]=p("strong",null,"Playlist:",-1)),pt(" "+P(X(C.value?.playlistUrl||"")),1)]),j[8]||(j[8]=p("p",null,[p("strong",null,"Status:"),pt(" Waiting for players")],-1))]),j[9]||(j[9]=p("div",{class:"player-notice"},[p("small",null,"⚡ Settings update automatically when the host makes changes")],-1))],2))]),p("div",C0,[S.value?(N(),O("button",{key:0,class:"action-btn primary",onClick:Z,disabled:!E.value}," 🚀 Start Game ",8,w0)):(N(),O("button",{key:1,class:Qe(["action-btn secondary",{ready:b.value}]),onClick:U},P(b.value?"✅ Ready":"⏳ Ready Up"),3))])]),r.value?(N(),O("div",E0,[p("p",null,"⚠️ Connection Error: "+P(r.value),1),p("button",{onClick:K,class:"reconnect-btn"},"Reconnect")])):pe("",!0)]))}}),T0=kt(S0,[["__scopeId","data-v-39a5ca3d"]]),I0={class:"multiplayer-game-view"},R0={key:0,class:"loading-screen"},P0={key:1,class:"game-container"},k0={class:"game-header"},x0={class:"round-info"},A0={class:"round-counter"},N0={class:"lobby-code"},L0={class:"players-status"},O0={class:"players-grid"},M0={class:"player-info"},D0={class:"player-name"},F0={key:0,class:"host-badge"},$0={class:"player-progress"},U0={class:"attempts"},H0={class:"score"},W0={key:0,class:"won"},B0={key:1,class:"completed"},V0={key:0,class:"waiting-for-round"},G0={class:"waiting-content"},j0={key:0},q0={key:1},K0=["disabled"],z0={key:1,class:"active-round"},Y0={key:0,class:"track-reveal"},Q0={class:"track-info"},J0={key:0},X0={key:1,class:"clip-controls"},Z0={class:"clip-info"},eT={class:"clip-duration"},tT={class:"duration-value"},nT={class:"attempts-display"},sT={class:"play-controls"},rT=["disabled"],iT={class:"hidden-audio-player"},oT={key:2,class:"guess-section"},lT={class:"guess-actions"},aT=["disabled"],cT={key:3,class:"round-completed-section"},uT={class:"completed-message"},dT={key:4,class:"round-results"},hT={class:"round-scores"},fT={class:"results-list"},pT={class:"player-name"},mT={class:"attempts"},gT={class:"round-score"},_T={class:"total-score"},yT={key:0,class:"round-actions"},vT={key:1,class:"waiting-host"},bT={key:0},CT={key:1},wT=2e3,ET=ut({__name:"MultiplayerGameView",setup(t){const e=Zt(),n=Si(),s=rs(),r=V(0),i=k=>{const y=Date.now();return y-r.value<wT?(console.log("Navigation throttled, ignoring call to:",k),!1):(r.value=y,e.push(k),!0)},o=V(null),l=V(""),a=V(!1),c=V(!1),d=V(!1),u=V(!1),h=ee(()=>n.params.lobbyCode),f=ee(()=>o.value?.gameState),_=ee(()=>o.value?.gameSettings),C=ee(()=>o.value?Object.values(o.value.players):[]),S=ee(()=>{const k=ge.getCurrentPlayerId();return o.value?.hostId===k}),b=()=>{const k=ge.getCurrentPlayerId();return!k||!f.value?0:f.value.playerGuesses[k]?.attempts?.length||0},E=()=>{const k=b();return f.value?f.value.clipDurations[k]||f.value.clipDurations[f.value.clipDurations.length-1]||16:1},I=()=>{const k=ge.getCurrentPlayerId();return!k||!f.value?!1:f.value.playerGuesses[k]?.hasWon||!1},T=()=>{const k=ge.getCurrentPlayerId();return!k||!f.value?!1:f.value.playerGuesses[k]?.hasLost||!1},U=k=>{const y=ge.getCurrentPlayerId();return!y||!f.value?!1:(f.value.playerGuesses[y]?.attempts||[])[k]?.isCorrect||!1},Z=k=>f.value&&f.value.playerGuesses[k]?.attempts?.length||0,te=k=>f.value&&f.value.playerGuesses[k]?.hasWon||!1,X=k=>f.value&&f.value.playerGuesses[k]?.hasLost||!1,K=k=>f.value&&f.value.playerGuesses[k]?.totalScore||0,he=k=>f.value&&f.value.playerGuesses[k]?.roundScore||0,ve=()=>{if(!f.value||!o.value||!f.value.isRoundActive)return!1;const k=Date.now()-f.value.roundStartTime;return k<2e3?!1:Object.keys(o.value.players).every(D=>{const x=f.value.playerGuesses[D];return!x||k<5e3&&x.attempts.length===0?!1:(x.hasWon||x.hasLost)&&(x.attempts.length>0||x.hasLost)})},q=()=>{if(!f.value)return"16";const k=b();return f.value.clipDurations[k+1]||"reveal"},j=async()=>{if(!(!S.value||d.value)){d.value=!0;try{const k=_.value?.playlistUrl;if(!k){console.error("No playlist URL configured");return}const y=Lr(k);if(!y){console.error("Invalid playlist URL");return}const w=Ao(),D=await Or(y,w);if(D.length===0){console.error("Playlist is empty or could not be loaded");return}const x=f.value?.usedTracks||[],Y=D.filter(B=>!x.includes(B.videoId)),m=Y.length>0?Y:D,g=Math.floor(Math.random()*m.length),v=m[g],R={id:v.videoId,title:v.title,artist:ae(v.title),youtubeId:v.videoId},M=Y.length>0?[...x,v.videoId]:[v.videoId],A=await ge.updateGameState({currentTrack:R,isRoundActive:!0,roundStartTime:Date.now(),roundEndTime:null,usedTracks:M});A.success?(Le(),u.value=!1):console.error("Failed to start round:",A.error)}catch(k){console.error("Failed to start round:",k)}finally{d.value=!1}}},ae=k=>{const y=[/^([^-]+)\s*-\s*(.+)$/,/^(.+)\s*by\s*([^(]+)/i,/^([^|]+)\s*\|\s*(.+)$/];for(const w of y){const D=k.match(w);if(D)return D[1].trim()}return""},Be=async()=>{if(!f.value?.currentTrack||a.value)return;const k=f.value.currentTrack,y=E();a.value=!0;try{await s.loadTrack({id:k.id,videoId:k.youtubeId,title:k.title,artist:k.artist}),s.play(),setTimeout(()=>{s.pause(),a.value=!1},y*1e3)}catch(w){console.error("Failed to play clip:",w),a.value=!1}},we=()=>{s.pause(),a.value=!1},se=async(k,y=!1)=>{if(!(!k.trim()&&!y||c.value||I())){c.value=!0;try{const w=y?!1:fe(k,f.value?.currentTrack),D=await ge.submitGuess(k||"[SKIPPED]",w);D.success?(l.value="",Le(),(w||ve())&&(u.value=!0)):console.error("Failed to submit guess:",D.error)}catch(w){console.error("Failed to submit guess:",w)}finally{c.value=!1}}},fe=(k,y)=>{if(!y||!k.trim())return!1;const w=k.toLowerCase().trim(),D=y.title.toLowerCase().trim(),x=y.artist?.toLowerCase().trim()||"";return w===D||w===x||D.includes(w)&&w.length>3||x.includes(w)&&w.length>3},ot=async()=>{await se("",!0)},dt=async()=>{if(S.value)try{const k=(f.value?.currentRound||1)+1,y={...f.value?.playerGuesses};Object.keys(y).forEach(D=>{y[D].hasWon&&(y[D].roundsWon=(y[D].roundsWon||0)+1),y[D]={...y[D],attempts:[],hasWon:!1,hasLost:!1,roundScore:0}});const w=await ge.updateGameState({currentRound:k,currentTrack:null,isRoundActive:!1,roundStartTime:0,roundEndTime:null,playerGuesses:y});w.success?(u.value=!1,Le()):console.error("Failed to start next round:",w.error)}catch(k){console.error("Failed to start next round:",k)}},Ke=async()=>{if(S.value)try{const k={...f.value?.playerGuesses};Object.keys(k).forEach(w=>{k[w].hasWon&&(k[w].roundsWon=(k[w].roundsWon||0)+1)});const y=await ge.updateGameState({isRoundActive:!1,currentTrack:null,roundStartTime:0,roundEndTime:null,playerGuesses:k});if(y.success){const w=await ge.finishTournament();w.success?i(`/lobby/${h.value}/results`):(console.error("Failed to finish tournament:",w.error),i(`/lobby/${h.value}/results`))}else console.error("Failed to update final game state:",y.error),await ge.finishTournament(),i(`/lobby/${h.value}/results`)}catch(k){console.error("Failed to end tournament:",k)}},Le=()=>{const k=ge.getCurrentLobby();k&&(o.value=k)},z=()=>{ge.listenToLobby(h.value,k=>{if(k){if(o.value=k,k.status==="finished"){i(`/lobby/${h.value}/results`);return}}else console.log("Lobby connection lost, redirecting to multiplayer menu"),i("/multiplayer")}),ge.listenToGameState(h.value,k=>{if(k){const y=f.value?.currentTrack;o.value&&(o.value={...o.value,gameState:k}),le(k,y)}})},le=(k,y)=>{const w=k.currentTrack,D=ve(),x=k.isRoundActive&&k.roundStartTime>0;!u.value&&w&&x&&D&&(u.value=!0),y&&!w&&(u.value=!1,l.value="",a.value=!1,c.value=!1),!y&&w&&(u.value=!1,l.value="",a.value=!1,c.value=!1)};wn(async()=>{if(Le(),!o.value||o.value.status!=="playing"){i(`/lobby/${h.value}`);return}await Te(),z()});const Te=async()=>{const k=_.value?.playlistUrl;if(k)try{await s.loadCustomPlaylistFromYouTube(k)}catch(y){console.warn("Failed to load playlist for autocompletion:",y)}};return ir(()=>{ge.removeAllListeners()}),Ld(()=>{ge.removeAllListeners(),console.log("Cleaned up Firebase listeners on route leave")}),(k,y)=>(N(),O("div",I0,[f.value?(N(),O("div",P0,[p("div",k0,[p("h1",null,"🏆 "+P(_.value?.tournamentName||"Multiplayer Tournament"),1),p("div",x0,[p("span",A0,"Round "+P(f.value.currentRound)+" of "+P(_.value?.totalRounds||5),1),p("span",N0,"Lobby: "+P(h.value),1)])]),p("div",L0,[y[2]||(y[2]=p("h3",null,"Players Status",-1)),p("div",O0,[(N(!0),O(Fe,null,It(C.value,w=>(N(),O("div",{key:w.id,class:"player-status"},[p("div",M0,[p("span",D0,P(w.name),1),w.isHost?(N(),O("span",F0,"Host")):pe("",!0)]),p("div",$0,[p("span",U0,P(Z(w.id))+"/"+P(f.value.maxAttempts),1),p("span",H0,P(K(w.id))+" pts",1),te(w.id)?(N(),O("span",W0,"🎉 Won!")):X(w.id)?(N(),O("span",B0,"✅ Complete")):pe("",!0)])]))),128))])]),!f.value.isRoundActive&&!f.value.currentTrack?(N(),O("div",V0,[p("div",G0,[y[3]||(y[3]=p("h2",null,"🎵 Get Ready!",-1)),S.value?(N(),O("p",j0,"As the host, you'll control when each round starts.")):(N(),O("p",q0,"Waiting for the host to start the next round...")),S.value?(N(),O("button",{key:2,onClick:j,class:"start-round-btn",disabled:d.value},P(d.value?"Starting...":`🚀 Start Round ${f.value.currentRound}`),9,K0)):pe("",!0)])])):f.value.currentTrack?(N(),O("div",z0,[u.value?(N(),O("div",Y0,[y[4]||(y[4]=p("h3",null,"🎵 The song was:",-1)),p("div",Q0,[p("h4",null,P(f.value.currentTrack.title),1),f.value.currentTrack.artist?(N(),O("p",J0,"by "+P(f.value.currentTrack.artist),1)):pe("",!0)])])):(N(),O("div",X0,[p("div",Z0,[p("div",eT,[y[5]||(y[5]=p("span",{class:"duration-label"},"Current clip:",-1)),p("span",tT,P(E())+"s",1)]),p("div",nT,[(N(!0),O(Fe,null,It(f.value.clipDurations,(w,D)=>(N(),O("div",{key:D,class:Qe(["attempt-dot",{completed:D<b(),current:D===b()&&!I()&&!T(),correct:D<b()&&U(D),finished:T()&&D===b()-1}])},P(w)+"s ",3))),128))])]),p("div",sT,[p("button",{onClick:Be,disabled:a.value,class:"play-btn"},P(a.value?"🔄 Playing...":`▶️ Play ${E()}s`),9,rT),a.value?(N(),O("button",{key:0,onClick:we,class:"stop-btn"}," ⏹️ Stop ")):pe("",!0)])])),p("div",iT,[We(Fd)]),!I()&&!T()&&!u.value?(N(),O("div",oT,[We(Dd,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=w=>l.value=w),onSubmit:se,disabled:c.value||I()||T(),placeholder:"Type song title or artist...","submit-text":"Submit Guess"},null,8,["modelValue","disabled"]),p("div",lT,[p("button",{onClick:ot,disabled:c.value||T(),class:"skip-btn"}," Skip (+"+P(q())+"s) ",9,aT)])])):pe("",!0),T()&&!I()&&!u.value?(N(),O("div",cT,[p("div",uT,[y[6]||(y[6]=p("h3",null,"🎵 Round Completed",-1)),p("p",null,"You used all "+P(f.value.maxAttempts)+" attempts. Better luck next round!",1),y[7]||(y[7]=p("p",null,"Wait for other players to finish or for the host to reveal the answer.",-1))])])):pe("",!0),u.value?(N(),O("div",dT,[p("div",hT,[p("h4",null,"Round "+P(f.value.currentRound)+" Results:",1),p("div",fT,[(N(!0),O(Fe,null,It(C.value,w=>(N(),O("div",{key:w.id,class:"result-item"},[p("span",pT,P(w.name),1),p("span",mT,P(Z(w.id))+" attempts",1),p("span",gT,"+"+P(he(w.id))+" pts",1),p("span",_T,P(K(w.id))+" total",1)]))),128))])]),S.value?(N(),O("div",yT,[f.value.currentRound<(_.value?.totalRounds||5)?(N(),O("button",{key:0,onClick:dt,class:"next-round-btn"}," ⏭️ Next Round ("+P(f.value.currentRound+1)+"/"+P(_.value?.totalRounds||5)+") ",1)):(N(),O("button",{key:1,onClick:Ke,class:"end-tournament-btn"}," 🏆 End Tournament "))])):(N(),O("div",vT,[f.value.currentRound<(_.value?.totalRounds||5)?(N(),O("p",bT," Waiting for host to start next round... ")):(N(),O("p",CT,"Waiting for host to end the tournament..."))]))])):pe("",!0)])):pe("",!0)])):(N(),O("div",R0,y[1]||(y[1]=[p("div",{class:"loading-content"},[p("h2",null,"Loading Game..."),p("p",null,"Initializing multiplayer session...")],-1)])))]))}}),ST=kt(ET,[["__scopeId","data-v-be5aea6b"]]),TT={class:"multiplayer-results-view"},IT={class:"results-container"},RT={class:"results-header"},PT={class:"tournament-summary"},kT={class:"final-standings"},xT={class:"standings-list"},AT={class:"position"},NT={class:"rank"},LT={class:"medal"},OT={class:"player-details"},MT={class:"player-name"},DT={key:0,class:"host-badge"},FT={class:"player-stats"},$T={class:"stat"},UT={class:"stat-value"},HT={class:"stat"},WT={class:"stat-value"},BT=ut({__name:"MultiplayerResultsView",setup(t){const e=Zt(),n=Si(),s=V(null),r=ee(()=>n.params.lobbyCode),i=ee(()=>s.value?.gameState),o=ee(()=>s.value?.gameSettings),l=ee(()=>s.value?Object.values(s.value.players):[]),a=ee(()=>[...l.value].sort((_,C)=>{const S=c(_.id);return c(C.id)-S})),c=_=>i.value&&i.value.playerGuesses[_]?.totalScore||0,d=_=>i.value&&i.value.playerGuesses[_]?.roundsWon||0,u=_=>{switch(_){case 0:return"🥇";case 1:return"🥈";case 2:return"🥉";default:return""}},h=async()=>{const _=ge.getCurrentPlayerId();s.value?.hostId===_?(console.log("Host is resetting lobby for new tournament"),console.log("Navigating back to lobby"),e.push(`/lobby/${r.value}`)):e.push(`/lobby/${r.value}`)},f=()=>{e.push("/multiplayer")};return wn(()=>{const _=ge.getCurrentLobby();if(_&&_.id===r.value){if(s.value=_,_.status!=="finished"){console.log("Tournament not finished, redirecting based on status:",_.status),_.status==="playing"?e.push(`/lobby/${r.value}/game`):e.push(`/lobby/${r.value}`);return}}else e.push("/multiplayer")}),(_,C)=>(N(),O("div",TT,[p("div",IT,[p("div",RT,[C[0]||(C[0]=p("h1",null,"🏆 Tournament Complete!",-1)),p("h2",null,P(o.value?.tournamentName||"Multiplayer Tournament"),1),p("p",PT,P(o.value?.totalRounds||5)+" rounds completed",1)]),p("div",kT,[C[3]||(C[3]=p("h3",null,"🥇 Final Standings",-1)),p("div",xT,[(N(!0),O(Fe,null,It(a.value,(S,b)=>(N(),O("div",{key:S.id,class:Qe(["standing-item",{"first-place":b===0,"second-place":b===1,"third-place":b===2}])},[p("div",AT,[p("span",NT,P(b+1),1),p("span",LT,P(u(b)),1)]),p("div",OT,[p("span",MT,P(S.name),1),S.isHost?(N(),O("span",DT,"Host")):pe("",!0)]),p("div",FT,[p("div",$T,[C[1]||(C[1]=p("span",{class:"stat-label"},"Total Score:",-1)),p("span",UT,P(c(S.id)),1)]),p("div",HT,[C[2]||(C[2]=p("span",{class:"stat-label"},"Rounds Won:",-1)),p("span",WT,P(d(S.id))+"/"+P(o.value?.totalRounds||5),1)])])],2))),128))])]),p("div",{class:"actions"},[p("button",{onClick:h,class:"action-btn secondary"}," ← Back to Lobby "),p("button",{onClick:f,class:"action-btn primary"}," 🏠 Main Menu ")])])]))}}),VT=kt(BT,[["__scopeId","data-v-ff759a94"]]),hf=$g({history:pg("/HeardleTournament"),routes:[{path:"/",name:"home",component:zg},{path:"/config",name:"config",component:Fv},{path:"/game",name:"game",component:vv},{path:"/results",name:"results",component:Nb},{path:"/multiplayer",name:"multiplayer",component:t0},{path:"/lobby/:lobbyCode",name:"lobby",component:T0},{path:"/lobby/:lobbyCode/game",name:"multiplayer-game",component:ST},{path:"/lobby/:lobbyCode/results",name:"multiplayer-results",component:VT}]});hf.beforeEach((t,e)=>{(e.path.includes("/multiplayer")||e.path.includes("/lobby/"))&&!t.path.includes("/multiplayer")&&!t.path.includes("/lobby/")&&Vg(async()=>{const{lobbyService:s}=await Promise.resolve().then(()=>jg);return{lobbyService:s}},void 0).then(({lobbyService:s})=>{console.log("Leaving multiplayer routes - cleaning up lobby state"),s.leaveLobby()})});const Zl=km(Hg);Zl.use(Nm());Zl.use(hf);Zl.mount("#app");
